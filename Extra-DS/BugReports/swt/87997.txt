TableEditor.dispose( ) causes NPE if linked Table is being disposed
Found in 3.1 I20050308-0835. TableEdtior.dispose( ) calls methods on it's owning Table to remove some listeners from the table's columns. If the table is in the process of being disposed, the columns will have already been disposed and this will result in a NPE. Specifically this prevents one from adding a dispose listener on the Table or a TableItem and trying to dispose of the associated editor, as in the code below. Further if the dispose listener is set on the parent of the Table, a &quot;Widget is disposed&quot; exception will be thrown instead of the NPE. This leaves no place to hook to trigger the disposal of the TableEditor. import org.eclipse.swt.custom.TableEditor; import org.eclipse.swt.events.*; import org.eclipse.swt.widgets.*; public class Test { public static void main( String[ ] args ) { Shell shell = new Shell( ); Table table = new Table( shell, 0 ); new TableColumn( table, 0 ); TableItem item = new TableItem( table, 0 ); final TableEditor editor = new TableEditor( table ); final Text text = new Text( table, 0 ); editor.setEditor( text, item, 0 ); item.addDisposeListener( new DisposeListener( ) { public void widgetDisposed( DisposeEvent e ) { text.dispose( ); editor.dispose( ); // Triggers a NPE } } ); shell.dispose( ); } }