StyledText: Caret location not updated when line style is used
SWT-win32, v3124 In the snippet below, there is a StyledText with a line style listener. In the line style listener, a bold font style is set, changing the width of the rendered text. I would have expected the on-screen caret location (not the offset) to be adjusted to the change. However, this does not happen. For an italic style, it does not look right either. Might be a bug? --- import org.eclipse.swt.*; import org.eclipse.swt.custom.*; import org.eclipse.swt.graphics.*; import org.eclipse.swt.layout.*; import org.eclipse.swt.widgets.*; public class LineStyleCaretTest { public static void main(String[] args) { Display display = new Display(); Shell shell = new Shell(display); shell.setLayout(new FillLayout()); Font font = new Font(display, &quot;Arial&quot;, 12, SWT.NORMAL); final StyledText text = new StyledText(shell, SWT.MULTI); text.setFont(font); text.setText(&quot;Standard Widget Toolkit&quot;); text.setCaretOffset(text.getText().length()); text.addLineStyleListener(new LineStyleListener() { public void lineGetStyle(LineStyleEvent event) { StyleRange[] styles = new StyleRange[1]; styles[0] = new StyleRange(); styles[0].start = 0; styles[0].length = text.getText().length(); styles[0].fontStyle = SWT.BOLD; event.styles = styles; } }); shell.setSize(300, 100); shell.open(); while (!shell.isDisposed()) { if (!display.readAndDispatch()) { display.sleep(); } } font.dispose(); display.dispose(); } }