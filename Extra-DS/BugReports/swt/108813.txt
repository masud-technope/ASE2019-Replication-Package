LineStyles in Very Long Lines Takes Forever
Well, not literally forever, but way way too long -- users will have to &quot;end process&quot; and start over. <span class="bz_closed"><a href="show_bug.cgi?id=108806" title="CLOSED FIXED - Very-long-line XML file appears to hang Eclipse">Bug 108806</a></span> is the most recent one opened against us in WTP, but have seen before for less extreme examples. I'm opening this bug to determine what improvements can be made at SWT level. I've marked as major since <span class="bz_closed"><a href="show_bug.cgi?id=108806" title="CLOSED FIXED - Very-long-line XML file appears to hang Eclipse">bug 108806</a></span> was marked as major by user-client. For the case described in <span class="bz_closed"><a href="show_bug.cgi?id=108806" title="CLOSED FIXED - Very-long-line XML file appears to hang Eclipse">bug 108806</a></span>, I've noticed that for the 500K character line, we produce about 100K &quot;styles&quot; passed back to StyledText via LineStyleEvent. One thing I noticed, for example, is that a loop in DisplayRenderer goes through each style, eventually calling TextLayout.setStyle. There, is some code in there which is creating a (new) array of TextStyles, and it grows the array one item at a time, ending up using 100K System.arraycopies to grow the array &quot;as they come in one by one&quot;. I did not test, but seems there might be ways to anticipate the size of this array and avoid all those array copies? So, first question ... why is it even requested of us to provide &quot;all StyleRanges&quot; for the line, when they are not all visible, obviously. Could some short cut be made there? Second question, do you think these &quot;DisplayRendering&quot; methods could be made more efficient, to at least allow user to limp along, or would problems just be encountered further along, such as is they try to type. Third question, any advice on how to proceed?