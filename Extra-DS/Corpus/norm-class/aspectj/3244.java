copyright palo alto center incorporated parc rights reserved program accompanying materials terms common license accompanies distribution http eclipse org legal cpl html contributors parc initial implementation org aspectj ajdt internal compiler ast org aspectj weaver advice org aspectj bridge context compilation and weaving context compilationandweavingcontext org aspectj bridge context context token contexttoken org aspectj org eclipse jdt internal compiler astvisitor org aspectj org eclipse jdt internal compiler ast abstract method declaration abstractmethoddeclaration org aspectj org eclipse jdt internal compiler ast expression org aspectj org eclipse jdt internal compiler ast message send messagesend org aspectj org eclipse jdt internal compiler ast name reference namereference org aspectj org eclipse jdt internal compiler ast single name reference singlenamereference org aspectj org eclipse jdt internal compiler lookup binding org aspectj org eclipse jdt internal compiler lookup block scope blockscope org aspectj org eclipse jdt internal compiler lookup class scope classscope org aspectj org eclipse jdt internal compiler lookup local variable binding localvariablebinding org aspectj org eclipse jdt internal compiler lookup method binding methodbinding org aspectj org eclipse jdt internal compiler lookup reference binding referencebinding org aspectj org eclipse jdt internal compiler lookup type binding typebinding this join point visitor thisjoinpointvisitor astvisitor needs dynamic needsdynamic needs static needsstatic needs static enclosing needsstaticenclosing has effectively static ref haseffectivelystaticref local variable binding localvariablebinding this join point dec thisjoinpointdec local variable binding localvariablebinding this join point static part dec thisjoinpointstaticpartdec local variable binding localvariablebinding this enclosing join point static part dec thisenclosingjoinpointstaticpartdec local variable binding localvariablebinding this join point dec local thisjoinpointdeclocal local variable binding localvariablebinding this join point static part dec local thisjoinpointstaticpartdeclocal local variable binding localvariablebinding this enclosing join point static part dec local thisenclosingjoinpointstaticpartdeclocal replace effectively static refs replaceeffectivelystaticrefs abstract method declaration abstractmethoddeclaration method this join point visitor thisjoinpointvisitor abstract method declaration abstractmethoddeclaration method method method method arguments length this join point static part dec local thisjoinpointstaticpartdeclocal method scope locals this join point static part dec thisjoinpointstaticpartdec method arguments binding this join point dec local thisjoinpointdeclocal method scope locals this join point dec thisjoinpointdec method arguments binding this enclosing join point static part dec local thisenclosingjoinpointstaticpartdeclocal method scope locals this enclosing join point static part dec thisenclosingjoinpointstaticpartdec method arguments binding compute join point params computejoinpointparams walk body needed method traverse class scope classscope system err println check has effectively static ref haseffectivelystaticref needs dynamic needsdynamic has effectively static ref haseffectivelystaticref needs dynamic needsdynamic replace effectively this join point static part thisjoinpointstaticpart replace effectively static refs replaceeffectivelystaticrefs needs static needsstatic method traverse class scope classscope system err println method is ref isref name reference namereference binding binding system err println check system identity hash code identityhashcode binding binding is ref isref expression expr binding binding expr expr name reference namereference is ref isref name reference namereference expr binding end visit endvisit single name reference singlenamereference block scope blockscope scope is ref isref this join point dec thisjoinpointdec needs dynamic needsdynamic is ref isref this join point static part dec thisjoinpointstaticpartdec needs static needsstatic is ref isref this enclosing join point static part dec thisenclosingjoinpointstaticpartdec needs static enclosing needsstaticenclosing can treat as static cantreatasstatic string equals to string tostring equals to short string toshortstring equals to long string tolongstring equals get kind getkind equals get signature getsignature equals get source location getsourcelocation todo good optimization requires work replace call direct reference call equals get static part getstaticpart can treat as static cantreatasstatic var expr varexpr var expr varexpr astobject parent var expr varexpr get parent getparent parent call expr callexpr method called method calledmethod call expr callexpr parent get method getmethod can treat as static cantreatasstatic called method calledmethod add tjp get enclosing execution join point getenclosingexecutionjoinpoint method parent binop expr binopexpr binop expr binopexpr binop binop expr binopexpr parent binop get type gettype is equivalent isequivalent get type manager gettypemanager get string type getstringtype in block that cant run inblockthatcantrun visit message send messagesend call block scope blockscope scope context token contexttoken tok compilation and weaving context compilationandweavingcontext entering phase enteringphase compilation and weaving context compilationandweavingcontext optimizing join point calls call selector expression receiver call receiver is ref isref receiver this join point dec thisjoinpointdec can treat as static cantreatasstatic string call selector replace effectively static refs replaceeffectivelystaticrefs replace effectively static ref replaceeffectivelystaticref call system err println reg has effectively static ref haseffectivelystaticref call arguments arguments length argumentslength call arguments length arguments length argumentslength call arguments traverse scope compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok ret visit call scope compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok ret replace effectively static ref replaceeffectivelystaticref message send messagesend call name reference namereference receiver name reference namereference call receiver don call binding report error code call binding system err println replace receiver system identity hash code identityhashcode receiver this join point static part dec thisjoinpointstaticpartdec receiver binding this join point static part dec local thisjoinpointstaticpartdeclocal receiver codegen binding codegenbinding this join point static part dec local thisjoinpointstaticpartdeclocal reference binding referencebinding this join point static part type thisjoinpointstaticparttype reference binding referencebinding this join point static part dec thisjoinpointstaticpartdec type receiver actual receiver type actualreceivertype receiver resolved type resolvedtype this join point static part type thisjoinpointstaticparttype call set actual receiver type setactualreceivertype this join point static part type thisjoinpointstaticparttype ast util astutil replace method binding replacemethodbinding call get equivalent static binding getequivalentstaticbinding call binding method binding methodbinding get equivalent static binding getequivalentstaticbinding method binding methodbinding template reference binding referencebinding reference binding referencebinding this join point static part dec thisjoinpointstaticpartdec type get exact method getexactmethod template selector template parameters remove unused extra arguments removeunusedextraarguments extra argument flags extraargumentflags compute join point params computejoinpointparams method binding methodbinding binding method binding binding parameters length needs static enclosing needsstaticenclosing extra argument flags extraargumentflags advice this enclosing join point static part thisenclosingjoinpointstaticpart remove parameter removeparameter needs dynamic needsdynamic extra argument flags extraargumentflags advice this join point thisjoinpoint remove parameter removeparameter needs static needsstatic extra argument flags extraargumentflags advice this join point static part thisjoinpointstaticpart remove parameter removeparameter extra argument flags extraargumentflags remove parameter removeparameter index to remove indextoremove type binding typebinding parameters method binding parameters method scope locals remove local binding removelocalbinding index to remove indextoremove method scope locals method scope local index localindex method binding parameters remove parameter removeparameter index to remove indextoremove method binding parameters type binding typebinding remove parameter removeparameter type binding typebinding bindings len bindings length type binding typebinding ret type binding typebinding len system arraycopy bindings ret system arraycopy bindings ret len ret local variable binding localvariablebinding remove local binding removelocalbinding local variable binding localvariablebinding bindings len bindings length performance place local variable binding localvariablebinding ret local variable binding localvariablebinding len system arraycopy bindings ret system arraycopy bindings ret len ret