org aspectj apache bcel verifier statics java util hash map hashmap java util hash set hashset org aspectj apache bcel constants org aspectj apache bcel repository org aspectj apache bcel classfile attribute org aspectj apache bcel classfile code org aspectj apache bcel classfile code exception codeexception org aspectj apache bcel classfile constant org aspectj apache bcel classfile constant class constantclass org aspectj apache bcel classfile constant double constantdouble org aspectj apache bcel classfile constant fieldref constantfieldref org aspectj apache bcel classfile constant float constantfloat org aspectj apache bcel classfile constant integer constantinteger org aspectj apache bcel classfile constant interface methodref constantinterfacemethodref org aspectj apache bcel classfile constant long constantlong org aspectj apache bcel classfile constant methodref constantmethodref org aspectj apache bcel classfile constant name and type constantnameandtype org aspectj apache bcel classfile constant pool constantpool org aspectj apache bcel classfile constant string constantstring org aspectj apache bcel classfile constant utf constantutf org aspectj apache bcel classfile constant value constantvalue org aspectj apache bcel classfile deprecated org aspectj apache bcel classfile descending visitor descendingvisitor org aspectj apache bcel classfile empty visitor emptyvisitor org aspectj apache bcel classfile exception table exceptiontable org aspectj apache bcel classfile field org aspectj apache bcel classfile inner class innerclass org aspectj apache bcel classfile inner classes innerclasses org aspectj apache bcel classfile java class javaclass org aspectj apache bcel classfile line number linenumber org aspectj apache bcel classfile line number table linenumbertable org aspectj apache bcel classfile local variable localvariable org aspectj apache bcel classfile local variable table localvariabletable org aspectj apache bcel classfile method org aspectj apache bcel classfile node org aspectj apache bcel classfile source file sourcefile org aspectj apache bcel classfile synthetic org aspectj apache bcel classfile unknown org aspectj apache bcel classfile visitor org aspectj apache bcel array type arraytype org aspectj apache bcel object type objecttype org aspectj apache bcel type org aspectj apache bcel verifier pass verifier passverifier org aspectj apache bcel verifier verification result verificationresult org aspectj apache bcel verifier verifier org aspectj apache bcel verifier verifier factory verifierfactory org aspectj apache bcel verifier exc assertion violated exception assertionviolatedexception org aspectj apache bcel verifier exc class constraint exception classconstraintexception org aspectj apache bcel verifier exc local variable info inconsistent exception localvariableinfoinconsistentexception pass verifier passverifier verifies file pass java virtual machine specification edition detailed verify method documentation version pass verifier java aclement exp author href http inf berlin ehaase enver haase verify pass verifier pass verifier passverifier constants local variable info localvariableinfo instances pass b verifier bverifier local variables infos localvariablesinfos denotes local variables method number java class javaclass verifier operates local variables info localvariablesinfo local variables infos localvariablesinfos verifier created verifier my owner myowner instantiated verifier verifier pass verifier verifier owner my owner myowner owner returns local variables info localvariablesinfo object usage local variables code attribute method file pass verifier operates pass verified correctly method number method method repository lookup class lookupclass my owner myowner get classname getclassname get methods getmethods method add leave just ice justice local variables info localvariablesinfo get local variables info getlocalvariablesinfo method cached don worry verify verification result verificationresult method method local variables infos localvariablesinfos length assertion violated exception assertionviolatedexception method number range local variables infos localvariablesinfos method pass pass properties file checked code arrays methods verification pass invoked resolved verification pass load classes superclasses implemented interfaces pass note referenced classes loaded verification existance check pass syntactical correctness names descriptors signatures checked checks conceptually belong delayed pass just ice justice just ice justice check syntactical correctness semantical sanity access code array methods cases pass documentation org aspectj apache bcel verifier statics pass a verifier averifier verification result verificationresult verify verification result verificationresult my owner myowner do pass dopass equals verification result verificationresult method local variables local variable table localvariabletable attributes code attributes local variables infos localvariablesinfos local variables info localvariablesinfo repository lookup class lookupclass my owner myowner get class name getclassname get methods getmethods length verification result verificationresult verification result verificationresult constant pool entries satisfy constraints field method valid accessible superclass methods overridden class constraint exception classconstraintexception cce verification result verificationresult verification result verificationresult verified rejected cce get message getmessage verification result verificationresult notyet ensures classes subclassed pass verifier operates proper classes transitively java lang object reason loading pass verifying classes pass verify methods overridden declared ancestor hierarchy class constraint exception classconstraintexception accessible superclass save names detect circular inheritance hash set hashset hash set hashset java class javaclass repository lookup class lookupclass my owner myowner get class name getclassname supidx supidx supidx get superclass name index getsuperclassnameindex supidx repository lookup class lookupclass type object get class name getclassname class constraint exception classconstraintexception superclass get class name getclassname missing type object get class name getclassname string supername get superclass name getsuperclassname supername list add supername class constraint exception classconstraintexception circular superclass hierarchy detected verifier verifier factory verifierfactory get verifier getverifier supername verification result verificationresult do pass dopass verification result verificationresult class constraint exception classconstraintexception load ancestor supername repository lookup class lookupclass supername is final isfinal class constraint exception classconstraintexception ancestor supername access modifier subclassed ensures methods overridden precondition method constant pool entries satisfy constraints accessible superclass invoked order class constraint exception classconstraintexception constant pool entries satisfy constraints accessible superclass methods overridden hash map hashmap hashmap hash map hashmap java class javaclass repository lookup class lookupclass my owner myowner get class name getclassname supidx supidx supidx get superclass name index getsuperclassnameindex method methods get methods getmethods methods length string sig methods get name getname methods get signature getsignature hashmap contains key containskey sig methods is final isfinal class constraint exception classconstraintexception method sig hashmap sig overrides overridable definition get class name getclassname methods don inherit methods is static isstatic hashmap sig get class name getclassname methods don inherit methods is static isstatic hashmap sig get class name getclassname object returns object works exception repository lookup class lookupclass get superclass name getsuperclassname ensures constant pool entries satisfy constraints java virtual machine specification edition class constraint exception classconstraintexception constant pool entries satisfy constraints consistency handled internally bcel verify indices constants point constants type java class javaclass repository lookup class lookupclass my owner myowner get class name getclassname constructor implicitely traverses cpessc visitor visitor ensures constant pool satisfies constraints visit xxx visitxxx methods class constraint exception classconstraintexception instances constant pool entries satisfy constraints cpessc visitor org aspectj apache bcel classfile empty visitor emptyvisitor visitor fieldref methodref interface methodref interfacemethodref string integer name and type nameandtype utf java class javaclass get constant pool getconstantpool save typing work computing power constant pool constantpool get length getlength save computing power cplen descending visitor descendingvisitor carrier hash set hashset field names hash set hashset hash set hashset field names desc hash set hashset hash set hashset method names desc hash set hashset cpessc visitor java class javaclass get constant pool getconstantpool cplen get length getlength org aspectj apache bcel classfile constant class constantclass fieldref org aspectj apache bcel classfile constant fieldref constantfieldref methodref org aspectj apache bcel classfile constant methodref constantmethodref interface methodref interfacemethodref org aspectj apache bcel classfile constant interface methodref constantinterfacemethodref string org aspectj apache bcel classfile constant string constantstring integer org aspectj apache bcel classfile constant integer constantinteger org aspectj apache bcel classfile constant float constantfloat org aspectj apache bcel classfile constant long constantlong org aspectj apache bcel classfile constant double constantdouble name and type nameandtype org aspectj apache bcel classfile constant name and type constantnameandtype utf org aspectj apache bcel classfile constant utf constantutf carrier descending visitor descendingvisitor carrier visit check index checkindex node referrer shouldbe cplen class constraint exception classconstraintexception invalid tostring referrer constant get constant getconstant shouldbe is instance isinstance string isnot shouldbe to string tostring substring shouldbe to string tostring last index of lastindexof cut class cast exception classcastexception illegal constant tostring tostring referrer expects shouldbe class file classfile structure vmspec visit java class visitjavaclass java class javaclass obj attribute atts obj get attributes getattributes found source file foundsourcefile found inner classes foundinnerclasses inner class innerclass referenced costly check existing verifiers don has inner class hasinnerclass inner class detector innerclassdetector inner class referenced innerclassreferenced atts length atts source file sourcefile atts deprecated atts inner classes innerclasses atts synthetic add message addmessage attribute tostring atts attribute class file classfile structure tostring obj unknown atts source file sourcefile found source file foundsourcefile found source file foundsourcefile class constraint exception classconstraintexception class file classfile structure tostring obj source file sourcefile attribute atts inner classes innerclasses found inner classes foundinnerclasses found inner classes foundinnerclasses has inner class hasinnerclass class constraint exception classconstraintexception classfile structure tostring obj inner classes innerclasses attribute referenced inner classes innerclasses attribute has inner class hasinnerclass add message addmessage referenced inner classes innerclasses attribute tostring atts removal attribute has inner class hasinnerclass found inner classes foundinnerclasses class constraint exception classconstraintexception classfile structure tostring obj inner classes innerclasses attribute referenced inner classes innerclasses attribute vmspec constraint existing verifiers don check javac doesn satisfy anonymous classes add message addmessage classfile structure tostring obj inner classes innerclasses attribute referenced inner classes innerclasses attribute constants vmspec visit constant class visitconstantclass constant class constantclass obj obj get tag gettag constants constant class constraint exception classconstraintexception wrong constant tag tostring obj check index checkindex obj obj get name index getnameindex utf visit constant fieldref visitconstantfieldref constant fieldref constantfieldref obj obj get tag gettag constants constant fieldref class constraint exception classconstraintexception wrong constant tag tostring obj check index checkindex obj obj get class index getclassindex check index checkindex obj obj get name and type index getnameandtypeindex name and type nameandtype visit constant methodref visitconstantmethodref constant methodref constantmethodref obj obj get tag gettag constants constant methodref class constraint exception classconstraintexception wrong constant tag tostring obj check index checkindex obj obj get class index getclassindex check index checkindex obj obj get name and type index getnameandtypeindex name and type nameandtype visit constant interface methodref visitconstantinterfacemethodref constant interface methodref constantinterfacemethodref obj obj get tag gettag constants constant interface methodref interfacemethodref class constraint exception classconstraintexception wrong constant tag tostring obj check index checkindex obj obj get class index getclassindex check index checkindex obj obj get name and type index getnameandtypeindex name and type nameandtype visit constant string visitconstantstring constant string constantstring obj obj get tag gettag constants constant string class constraint exception classconstraintexception wrong constant tag tostring obj check index checkindex obj obj get string index getstringindex utf visit constant integer visitconstantinteger constant integer constantinteger obj obj get tag gettag constants constant integer class constraint exception classconstraintexception wrong constant tag tostring obj indices check visit constant float visitconstantfloat constant float constantfloat obj obj get tag gettag constants constant class constraint exception classconstraintexception wrong constant tag tostring obj indices check visit constant long visitconstantlong constant long constantlong obj obj get tag gettag constants constant class constraint exception classconstraintexception wrong constant tag tostring obj indices check visit constant double visitconstantdouble constant double constantdouble obj obj get tag gettag constants constant class constraint exception classconstraintexception wrong constant tag tostring obj indices check visit constant name and type visitconstantnameandtype constant name and type constantnameandtype obj obj get tag gettag constants constant name and type nameandtype class constraint exception classconstraintexception wrong constant tag tostring obj check index checkindex obj obj get name index getnameindex utf check index checkindex obj obj get descriptor index getdescriptorindex utf inconsistently named bcel check index checkindex obj obj get signature index getsignatureindex utf visit constant utf visitconstantutf constant utf constantutf obj obj get tag gettag constants constant utf class constraint exception classconstraintexception wrong constant tag tostring obj indices check fields vmspec visit field visitfield field obj is class isclass maxone obj is private isprivate maxone obj is protected isprotected maxone obj is public ispublic maxone maxone class constraint exception classconstraintexception field tostring obj acc acc acc modifiers obj is final isfinal obj is volatile isvolatile class constraint exception classconstraintexception field tostring obj acc acc modifiers is interface isinterface obj is public ispublic class constraint exception classconstraintexception field tostring obj acc modifier hasn obj is static isstatic class constraint exception classconstraintexception field tostring obj acc modifier hasn obj is final isfinal class constraint exception classconstraintexception field tostring obj acc modifier hasn obj get access flags getaccessflags acc acc acc acc acc acc acc add message addmessage field tostring obj access flag acc acc acc acc acc acc acc check index checkindex obj obj get name index getnameindex utf string obj get name getname valid field name validfieldname class constraint exception classconstraintexception field tostring obj illegal obj get name getname descriptor named signature bcel check index checkindex obj obj get signature index getsignatureindex utf field method signature descriptor string sig constant utf constantutf get constant getconstant obj get signature index getsignatureindex get bytes getbytes type get type gettype sig don class format error classformaterror bcel harsh describing exceptional situations cfe class constraint exception classconstraintexception illegal descriptor signature sig tostring obj string nameanddesc sig field names desc nameanddesc class constraint exception classconstraintexception fields tostring obj allowed names descriptors field names add message addmessage field detected type descriptors unusual field names desc add nameanddesc field names add attribute atts obj get attributes getattributes atts length atts constant value constantvalue atts synthetic atts deprecated add message addmessage attribute tostring atts attribute field tostring obj unknown atts constant value constantvalue add message addmessage attribute tostring atts attribute field tostring obj constant value constantvalue debuggers methods vmspec visit method visitmethod method obj check index checkindex obj obj get name index getnameindex utf string obj get name getname valid method name validmethodname class constraint exception classconstraintexception method tostring obj illegal descriptor named signature bcel check index checkindex obj obj get signature index getsignatureindex utf method signature descriptor string sig constant utf constantutf get constant getconstant obj get signature index getsignatureindex get bytes getbytes type needed block type type get return type getreturntype sig type get argument types getargumenttypes sig class format error classformaterror cfe class constraint exception classconstraintexception illegal descriptor signature sig method tostring obj check referenced objects exist type array type arraytype array type arraytype get basic type getbasictype object type objecttype verifier verifier factory verifierfactory get verifier getverifier object type objecttype get class name getclassname verification result verificationresult do pass dopass verification result verificationresult class constraint exception classconstraintexception method tostring obj type pass verification pass length array type arraytype array type arraytype get basic type getbasictype object type objecttype verifier verifier factory verifierfactory get verifier getverifier object type objecttype get class name getclassname verification result verificationresult do pass dopass verification result verificationresult class constraint exception classconstraintexception method tostring obj argument type pass verification pass forgot funny values allowed empty arguments list method equals initializer length class constraint exception classconstraintexception method tostring obj illegal resembles initialization method isn arguments descriptor is class isclass maxone obj is private isprivate maxone obj is protected isprotected maxone obj is public ispublic maxone maxone class constraint exception classconstraintexception method tostring obj acc acc acc modifiers obj is abstract isabstract obj is final isfinal class constraint exception classconstraintexception method tostring obj acc modifier obj is native isnative class constraint exception classconstraintexception method tostring obj acc modifier obj is private isprivate class constraint exception classconstraintexception method tostring obj acc modifier obj is static isstatic class constraint exception classconstraintexception method tostring obj acc modifier obj is strictfp isstrictfp class constraint exception classconstraintexception method tostring obj acc strict modifier obj is synchronized issynchronized class constraint exception classconstraintexception method tostring obj acc modifier is interface isinterface vmspec paragraph equals initializer obj is public ispublic class constraint exception classconstraintexception method tostring obj acc modifier hasn obj is abstract isabstract class constraint exception classconstraintexception method tostring obj acc modifier hasn obj is private isprivate obj is protected isprotected obj is static isstatic obj is final isfinal obj is synchronized issynchronized obj is native isnative obj is strictfp isstrictfp class constraint exception classconstraintexception method tostring obj acc acc acc acc acc acc acc acc strict modifiers specific instance initialization method vmspec equals constructor acc strict flags table vmspec obj is static isstatic obj is final isfinal obj is synchronized issynchronized obj is native isnative obj is abstract isabstract class constraint exception classconstraintexception instance initialization method tostring obj acc acc acc acc acc modifiers initialization methods equals initializer obj get access flags getaccessflags acc strict add message addmessage initialization method tostring obj superfluous access modifier acc strict obj is abstract isabstract class constraint exception classconstraintexception initialization method tostring obj contradicts java language specification edition omits constraint common practice existing verifiers obj get access flags getaccessflags acc acc acc acc acc acc acc acc acc strict add message addmessage method tostring obj access flag acc acc acc acc acc acc acc acc acc strict string nameanddesc sig method names desc nameanddesc class constraint exception classconstraintexception methods tostring obj allowed names desciptors method names desc add nameanddesc attribute atts obj get attributes getattributes num code atts atts length atts code atts exception table exceptiontable atts synthetic atts deprecated add message addmessage attribute tostring atts attribute method tostring obj unknown atts code atts exception table exceptiontable add message addmessage attribute tostring atts attribute method tostring obj code exceptions debuggers atts code obj is native isnative obj is abstract isabstract vmspec class constraint exception classconstraintexception methods tostring obj code attribute tostring atts atts code num code atts obj is native isnative obj is abstract isabstract num code atts class constraint exception classconstraintexception methods tostring obj code attribute num code atts class file classfile structure attributes vmspec vmspec visit source file visitsourcefile vmspec source file sourcefile obj source file sourcefile attr class file classfile visit java class visitjavaclass check index checkindex obj obj get name index getnameindex utf string constant utf constantutf get constant getconstant obj get name index getnameindex get bytes getbytes equals source file sourcefile class constraint exception classconstraintexception source file sourcefile attribute tostring obj correctly named source file sourcefile check index checkindex obj obj get source file index getsourcefileindex utf obj get source file name getsourcefilename string sourcefilename constant utf constantutf get constant getconstant obj get source file index getsourcefileindex get bytes getbytes string sourcefilenamelc sourcefilename to lower case tolowercase sourcefilename index of indexof sourcefilename index of indexof sourcefilename index of indexof sourcefilenamelc last index of lastindexof java add message addmessage source file sourcefile attribute tostring obj funny remember confuse parsers working javap output sourcefilename considered unqualified simple file visit deprecated visitdeprecated deprecated obj check index checkindex obj obj get name index getnameindex utf string constant utf constantutf get constant getconstant obj get name index getnameindex get bytes getbytes equals deprecated class constraint exception classconstraintexception deprecated attribute tostring obj correctly named deprecated visit synthetic visitsynthetic synthetic obj check index checkindex obj obj get name index getnameindex utf string constant utf constantutf get constant getconstant obj get name index getnameindex get bytes getbytes equals synthetic class constraint exception classconstraintexception synthetic attribute tostring obj correctly named synthetic visit inner classes visitinnerclasses inner classes innerclasses obj check index checkindex obj obj get name index getnameindex utf string constant utf constantutf get constant getconstant obj get name index getnameindex get bytes getbytes equals inner classes innerclasses class constraint exception classconstraintexception inner classes innerclasses attribute tostring obj correctly named inner classes innerclasses inner class innerclass ics obj get inner classes getinnerclasses ics length check index checkindex obj ics get inner class index getinnerclassindex idx ics get outer class index getouterclassindex idx check index checkindex obj idx innername idx ics get inner name index getinnernameindex innername idx check index checkindex obj innername idx utf acc ics get inner access flags getinneraccessflags acc acc acc acc acc acc acc acc acc acc add message addmessage unknown access flag tostring ics inner classes innerclasses attribute tostring obj visit constant value visitconstantvalue constant value constantvalue obj check index checkindex obj obj get name index getnameindex utf string constant utf constantutf get constant getconstant obj get name index getnameindex get bytes getbytes equals constant value constantvalue class constraint exception classconstraintexception constant value constantvalue attribute tostring obj correctly named constant value constantvalue object pred carrier predecessor pred field field field pred type field type type get type gettype constant utf constantutf get constant getconstant get signature index getsignatureindex get bytes getbytes obj get constant value index getconstantvalueindex cplen class constraint exception classconstraintexception invalid tostring obj constant get constant getconstant is instance isinstance field type equals type is instance isinstance field type equals type is instance isinstance field type equals type integer is instance isinstance field type equals type field type equals type field type equals type field type equals type field type equals type string is instance isinstance field type equals type string class constraint exception classconstraintexception illegal type constant value constantvalue obj embedding constant referenced field tostring expecting type field type visit code visitcode code obj check index checkindex obj obj get name index getnameindex utf string constant utf constantutf get constant getconstant obj get name index getnameindex get bytes getbytes equals code class constraint exception classconstraintexception code attribute tostring obj correctly named code method carrier predecessor method add message addmessage code attribute tostring obj declared method info structure carrier predecessor method carrier predecessor obj get code getcode length class constraint exception classconstraintexception code array code attribute tostring obj method empty code exception codeexception exc table obj get exception table getexceptiontable exc table length exc exc table get catch type getcatchtype exc check index checkindex obj exc constant class constantclass constant class constantclass get constant getconstant exc check index checkindex get name index getnameindex utf string cname constant utf constantutf get constant getconstant get name index getnameindex get bytes getbytes replace verifier verifier factory verifierfactory get verifier getverifier cname verification result verificationresult do pass dopass verification result verificationresult class constraint exception classconstraintexception code attribute tostring obj method exception table entry tostring exc table references cname exception pass verification pass java class javaclass repository lookup class lookupclass cname java class javaclass repository lookup class lookupclass type throwable get class name getclassname java class javaclass repository lookup class lookupclass type object get class name getclassname verifier factory verifierfactory get verifier getverifier get superclass name getsuperclassname do pass dopass verification result verificationresult class constraint exception classconstraintexception code attribute tostring obj method exception table entry tostring exc table references cname exception get superclass name getsuperclassname ancestor hierachy pass verification pass repository lookup class lookupclass get superclass name getsuperclassname class constraint exception classconstraintexception code attribute tostring obj method exception table entry tostring exc table references cname exception subclass get class name getclassname method number method repository lookup class lookupclass my owner myowner get class name getclassname get methods getmethods length method number method number assertion violated exception assertionviolatedexception find bcel method object bcel java class javaclass object local variables infos localvariablesinfos method number local variables info localvariablesinfo obj get max locals getmaxlocals num lvt attribs attribute atts obj get attributes getattributes atts length atts line number table linenumbertable atts local variable table localvariabletable add message addmessage attribute tostring atts attribute code attribute tostring obj method unknown add message addmessage attribute tostring atts attribute code attribute tostring obj method effectively debuggers atts local variable table localvariabletable local variable table localvariabletable lvt local variable table localvariabletable atts check index checkindex lvt lvt get name index getnameindex utf string lvtname constant utf constantutf get constant getconstant lvt get name index getnameindex get bytes getbytes lvtname equals local variable table localvariabletable class constraint exception classconstraintexception local variable table localvariabletable attribute tostring lvt correctly named local variable table localvariabletable lvtname code code obj local variable localvariable localvariables lvt get local variable table getlocalvariabletable localvariables length check index checkindex lvt localvariables get name index getnameindex utf string localname constant utf constantutf get constant getconstant localvariables get name index getnameindex get bytes getbytes valid java identifier validjavaidentifier localname class constraint exception classconstraintexception local variable table localvariabletable tostring lvt references local variable localname legal java simple check index checkindex lvt localvariables get signature index getsignatureindex utf string localsig constant utf constantutf get constant getconstant localvariables get signature index getsignatureindex get bytes getbytes type type get type gettype localsig class format error classformaterror cfe class constraint exception classconstraintexception illegal descriptor signature localsig local variable localvariable tostring localvariables referenced tostring lvt localindex localvariables get index getindex type type localindex localindex code get max locals getmaxlocals class constraint exception classconstraintexception local variable table localvariabletable attribute tostring lvt references local variable localvariable tostring localvariables exceeds surrounding code attribute max locals code get max locals getmaxlocals local variables infos localvariablesinfos method number add localindex localname localvariables get start pc getstartpc localvariables get length getlength local variable info inconsistent exception localvariableinfoinconsistentexception lviie class constraint exception classconstraintexception conflicting local variable table localvariabletable tostring lvt code attribute tostring obj method tostring lviie get message getmessage num lvt attribs num lvt attribs obj get max locals getmaxlocals class constraint exception classconstraintexception number local variable table localvariabletable attributes code attribute tostring obj method tostring exceeds number local variable slots obj get max locals getmaxlocals local variable table localvariabletable attribute local variable code attribute visit exception table visitexceptiontable exception table exceptiontable obj check index checkindex obj obj get name index getnameindex utf string constant utf constantutf get constant getconstant obj get name index getnameindex get bytes getbytes equals exceptions class constraint exception classconstraintexception exceptions attribute tostring obj correctly named exceptions exc indices obj get exception index table getexceptionindextable exc indices length check index checkindex obj exc indices constant class constantclass constant class constantclass get constant getconstant exc indices constant class constantclass visited checked check index checkindex get name index getnameindex utf convert internal notation fly external notation string cname constant utf constantutf get constant getconstant get name index getnameindex get bytes getbytes replace verifier verifier factory verifierfactory get verifier getverifier cname verification result verificationresult do pass dopass verification result verificationresult class constraint exception classconstraintexception exceptions attribute tostring obj references cname exception pass verification pass safely trust mechanism transitively verify ancestor hierarchy java class javaclass repository lookup class lookupclass cname java class javaclass repository lookup class lookupclass type throwable get class name getclassname java class javaclass repository lookup class lookupclass type object get class name getclassname subclass throwable leave verifier factory verifierfactory get verifier getverifier get superclass name getsuperclassname do pass dopass verification result verificationresult class constraint exception classconstraintexception exceptions attribute tostring obj references cname exception get superclass name getsuperclassname ancestor hierachy pass verification pass repository lookup class lookupclass get superclass name getsuperclassname class constraint exception classconstraintexception exceptions attribute tostring obj references cname exception subclass get class name getclassname synthetic deprecated code attribute structure attributes vmspec vmspec visit line number table visitlinenumbertable vmspec line number table linenumbertable obj check index checkindex obj obj get name index getnameindex utf string constant utf constantutf get constant getconstant obj get name index getnameindex get bytes getbytes equals line number table linenumbertable class constraint exception classconstraintexception line number table linenumbertable attribute tostring obj correctly named line number table linenumbertable just ice justice check delayed pass line number linenumber linenumbers obj get line number table getlinenumbertable validity check vmspec visit local variable table visitlocalvariabletable vmspec local variable table localvariabletable obj just ice justice check partially delayed pass visit code visitcode code method misc structure attributes vmspec vmspec visit unknown visitunknown vmspec unknown obj represents unknown attribute check index checkindex obj obj get name index getnameindex utf misnamed warning message add message addmessage unknown attribute tostring obj attribute context bcel visit local variable visitlocalvariable local variable localvariable obj represent attribute internal bcel data representation visit local variable table visitlocalvariabletable local variable table localvariabletable visit code exception visitcodeexception code exception codeexception obj code constraints checked pass represent attribute internal bcel data representation visit code visitcode code visit constant pool visitconstantpool constant pool constantpool obj piggybacked descending visitor descendingvisitor represent attribute internal bcel data representation visit inner class visitinnerclass inner class innerclass obj represent attribute internal bcel data representation visit line number visitlinenumber line number linenumber obj represent attribute internal bcel data representation visit line number table visitlinenumbertable line number table linenumbertable ensures constant cp constantcp subclassed entries constant pool valid yellin level security java method verify existence referenced entities classes formal correctness formed signatures visit xxx visitxxx methods class constraint exception classconstraintexception instances precondition style cross referencing constant pool valid simply invoke constant pool entries satisfy constraints class constraint exception classconstraintexception constant pool entries satisfy constraints field method valid java class javaclass repository lookup class lookupclass my owner myowner get class name getclassname descending visitor descendingvisitor descending visitor descendingvisitor famrav visitor visit visitor ensures constant cp constantcp subclassed entries constant pool valid precondition style cross referencing constant pool valid constant pool entries satisfy constraints org aspectj apache bcel classfile constant cp constantcp famrav visitor empty visitor emptyvisitor visitor get constant pool getconstantpool save typing work constant pool constantpool famrav visitor java class javaclass get constant pool getconstantpool visit constant fieldref visitconstantfieldref constant fieldref constantfieldref obj obj get tag gettag constants constant fieldref class constraint exception classconstraintexception constant fieldref constantfieldref tostring obj wrong tag type obj get name and type index getnameandtypeindex constant name and type constantnameandtype cnat constant name and type constantnameandtype get constant getconstant type field method string constant utf constantutf get constant getconstant cnat get name index getnameindex get bytes getbytes valid field name validfieldname class constraint exception classconstraintexception invalid field referenced tostring obj obj get class index getclassindex constant class constantclass constant class constantclass get constant getconstant internal form string class name classname constant utf constantutf get constant getconstant get name index getnameindex get bytes getbytes valid class name validclassname class name classname class constraint exception classconstraintexception illegal class name classname tostring obj field method signature descriptor string sig constant utf constantutf get constant getconstant cnat get signature index getsignatureindex get bytes getbytes type get type gettype sig don class format error classformaterror cfe class constraint exception classconstraintexception illegal descriptor signature sig tostring obj visit constant methodref visitconstantmethodref constant methodref constantmethodref obj obj get tag gettag constants constant methodref class constraint exception classconstraintexception constant methodref constantmethodref tostring obj wrong tag type obj get name and type index getnameandtypeindex constant name and type constantnameandtype cnat constant name and type constantnameandtype get constant getconstant type field method string constant utf constantutf get constant getconstant cnat get name index getnameindex get bytes getbytes valid class method name validclassmethodname class constraint exception classconstraintexception invalid method referenced tostring obj obj get class index getclassindex constant class constantclass constant class constantclass get constant getconstant internal form string class name classname constant utf constantutf get constant getconstant get name index getnameindex get bytes getbytes valid class name validclassname class name classname class constraint exception classconstraintexception illegal class name classname tostring obj field method signature descriptor string sig constant utf constantutf get constant getconstant cnat get signature index getsignatureindex get bytes getbytes type type get return type getreturntype sig equals constructor type class constraint exception classconstraintexception instance initialization method type class format error classformaterror cfe class constraint exception classconstraintexception illegal descriptor signature sig tostring obj visit constant interface methodref visitconstantinterfacemethodref constant interface methodref constantinterfacemethodref obj obj get tag gettag constants constant interface methodref interfacemethodref class constraint exception classconstraintexception constant interface methodref constantinterfacemethodref tostring obj wrong tag type obj get name and type index getnameandtypeindex constant name and type constantnameandtype cnat constant name and type constantnameandtype get constant getconstant type field method string constant utf constantutf get constant getconstant cnat get name index getnameindex get bytes getbytes valid interface method name validinterfacemethodname class constraint exception classconstraintexception invalid method referenced tostring obj obj get class index getclassindex constant class constantclass constant class constantclass get constant getconstant internal form string class name classname constant utf constantutf get constant getconstant get name index getnameindex get bytes getbytes valid class name validclassname class name classname class constraint exception classconstraintexception illegal class name classname tostring obj field method signature descriptor string sig constant utf constantutf get constant getconstant cnat get signature index getsignatureindex get bytes getbytes type type get return type getreturntype sig equals initializer type add message addmessage initialization method initializer type note requirement java virtual machine specification edition class format error classformaterror cfe class constraint exception classconstraintexception illegal descriptor signature sig tostring obj method returns supplied string represents valid java valid class name validclassname string todo implement restrictions method returns supplied string represents valid method basically valid identifier java programming language special instance initialization method allowed special initialization method allowed valid method name validmethodname string allow static init allowstaticinit valid java lang method name validjavalangmethodname allow static init allowstaticinit equals constructor equals initializer equals constructor method returns supplied string represents valid method referenced constant methodref constantmethodref objects valid class method name validclassmethodname string valid method name validmethodname method returns supplied string represents valid java programming language method stored simple qualified conforming java virtual machine specification edition valid java lang method name validjavalangmethodname string character is java identifier start isjavaidentifierstart char at charat length character is java identifier part isjavaidentifierpart char at charat method returns supplied string represents valid java method referenced constant interface methodref constantinterfacemethodref objects valid interface method name validinterfacemethodname string guess assume special names forbidden starts with startswith valid java lang method name validjavalangmethodname method returns supplied string represents valid java identifier called simple valid java identifier validjavaidentifier string vmspec vmspec character is java identifier start isjavaidentifierstart char at charat length character is java identifier part isjavaidentifierpart char at charat method returns supplied string represents valid java field valid field name validfieldname string vmspec vmspec valid java identifier validjavaidentifier serves finding java class javaclass constant pool constantpool references java virtual machine specification edition precise inner classes innerclasses attribute inner classes innerclasses attribute class file classfile structure constant pool refers member sun member classes specification point bytecode derived deduce member character code legal java language equal assumption wrong delimiter character is java identifier part isjavaidentifierpart trouble toplevel called xxx toplevel called called xxx just ice justice repair note existing verifiers time fail detect missing inner classes innerclasses attributes pass inner class detector innerclassdetector empty visitor emptyvisitor has inner class hasinnerclass java class javaclass constant pool constantpool don inner class detector innerclassdetector constructs inner class detector innerclassdetector working java class javaclass inner class detector innerclassdetector java class javaclass get constant pool getconstantpool descending visitor descendingvisitor visit returns java class javaclass inner class detector innerclassdetector working reference constant pool inner class referenced innerclassreferenced has inner class hasinnerclass method casually visits constant class constantclass references visit constant class visitconstantclass constant class constantclass obj constant get constant getconstant obj get name index getnameindex ignore constant utf constantutf find constant utf constantutf string classname constant utf constantutf get bytes getbytes classname starts with startswith get class name getclassname replace has inner class hasinnerclass method save typing work improve code readability string tostring node string representation stringrepresentation to string tostring