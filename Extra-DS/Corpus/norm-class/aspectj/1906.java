copyright palo alto center incorporated parc rights reserved program accompanying materials terms common license accompanies distribution http eclipse org legal cpl html contributors parc initial implementation alexandre vasseur implementation style org aspectj weaver patterns java data output stream dataoutputstream java ioexception java util array list arraylist java util iterator java util list java util map org aspectj bridge imessage org aspectj lang join point joinpoint org aspectj util fuzzy boolean fuzzyboolean org aspectj weaver advice org aspectj weaver ajc member maker ajcmembermaker org aspectj weaver isource context isourcecontext org aspectj weaver int map intmap org aspectj weaver resolved member resolvedmember org aspectj weaver resolved member impl resolvedmemberimpl org aspectj weaver resolved pointcut definition resolvedpointcutdefinition org aspectj weaver resolved type resolvedtype org aspectj weaver shadow org aspectj weaver shadow munger shadowmunger org aspectj weaver unresolved type unresolvedtype org aspectj weaver versioned data input stream versioneddatainputstream org aspectj weaver weaver messages weavermessages org aspectj weaver ast expr org aspectj weaver ast literal org aspectj weaver ast test org aspectj weaver ast if pointcut ifpointcut pointcut resolved member resolvedmember test method testmethod extra parameter flags extraparameterflags token source dump pointcut parseable debugging string enclosing pointcut hint enclosingpointcuthint pointcut residue source residuesource base args count baseargscount if pointcut ifpointcut resolved member resolvedmember test method testmethod extra parameter flags extraparameterflags test method testmethod test method testmethod extra parameter flags extraparameterflags extra parameter flags extraparameterflags pointcut kind pointcutkind enclosing pointcut hint enclosingpointcuthint arg constructor style body pointcut annotated method if pointcut ifpointcut string enclosing pointcut hint enclosingpointcuthint pointcut kind pointcutkind enclosing pointcut hint enclosingpointcuthint enclosing pointcut hint enclosingpointcuthint resolved concretize test method testmethod track style extra parameter flags extraparameterflags could match kinds couldmatchkinds shadow shadow kinds bits fuzzy boolean fuzzyboolean fast match fastmatch fast match info fastmatchinfo type fuzzy boolean fuzzyboolean fuzzy boolean fuzzyboolean match internal matchinternal shadow shadow maximally efficient fuzzy boolean fuzzyboolean always false alwaysfalse always true alwaystrue enh pointcut get residue source getresiduesource residue source residuesource write data output stream dataoutputstream ioexception write byte writebyte pointcut test method write boolean writeboolean test method testmethod test method testmethod test method testmethod write write byte writebyte extra parameter flags extraparameterflags write location writelocation pointcut read versioned data input stream versioneddatainputstream isource context isourcecontext context ioexception has test method hastestmethod read boolean readboolean resolved member resolvedmember resolved test method resolvedtestmethod test method style has test method hastestmethod resolved test method resolvedtestmethod resolved member impl resolvedmemberimpl read resolved member readresolvedmember context if pointcut ifpointcut ret if pointcut ifpointcut resolved test method resolvedtestmethod read byte readbyte ret read location readlocation context ret resolve bindings resolvebindings iscope scope bindings bindings good error messages cflow contexts equals object if pointcut ifpointcut if pointcut ifpointcut if pointcut ifpointcut test method testmethod test method testmethod test method testmethod equals test method testmethod hash code hashcode result result result test method testmethod hash code hashcode result string to string tostring extra parameter flags extraparameterflags style fixme bad unparsable code style scene test method testmethod implementation binding type checking pcds convoluted finding residue findingresidue last matched shadow id lastmatchedshadowid pcds if last matched shadow id iflastmatchedshadowid test if last matched shadow residue iflastmatchedshadowresidue shadow matched residue test find residue internal findresidueinternal shadow shadow exposed state exposedstate finding residue findingresidue literal finding residue findingresidue asked question shadow shadow id shadowid if last matched shadow id iflastmatchedshadowid if last matched shadow residue iflastmatchedshadowresidue test ret literal list args array list arraylist code style extra parameter flags extraparameterflags args sort don bother recursive call base args count baseargscount exposed state exposedstate my state mystate exposed state exposedstate base args count baseargscount test walk bindings arguments residue source residuesource find residue findresidue shadow my state mystate simply test base args count baseargscount my state mystate args add ret test make and makeand ret test make instanceof makeinstanceof test method testmethod get parameter types getparametertypes resolve shadow get iworld getiworld handle this join point thisjoinpoint parameters extra parameter flags extraparameterflags advice this join point thisjoinpoint args add shadow get this join point var getthisjoinpointvar extra parameter flags extraparameterflags advice this join point static part thisjoinpointstaticpart args add shadow get this join point static part var getthisjoinpointstaticpartvar extra parameter flags extraparameterflags advice this enclosing join point static part thisenclosingjoinpointstaticpart args add shadow get this enclosing join point static part var getthisenclosingjoinpointstaticpartvar style current state index currentstateindex fixme args test thejp fail test method testmethod get parameter types getparametertypes length string arg signature argsignature test method testmethod get parameter types getparametertypes get signature getsignature ajc member maker ajcmembermaker typex joinpoint get signature getsignature equals arg signature argsignature args add shadow get this join point var getthisjoinpointvar ajc member maker ajcmembermaker typex proceedingjoinpoint get signature getsignature equals arg signature argsignature args add shadow get this join point var getthisjoinpointvar ajc member maker ajcmembermaker typex staticjoinpoint get signature getsignature equals arg signature argsignature args add shadow get this join point static part var getthisjoinpointstaticpartvar ajc member maker ajcmembermaker typex enclosingstaticjoinpoint get signature getsignature equals arg signature argsignature args add shadow get this enclosing join point static part var getthisenclosingjoinpointstaticpartvar don join point joinpoint signature style current state index currentstateindex args add ret test make and makeand ret test make instanceof makeinstanceof test method testmethod get parameter types getparametertypes resolve shadow get iworld getiworld ret test make and makeand ret test make call makecall test method testmethod expr args to array toarray expr args size remember if last matched shadow id iflastmatchedshadowid shadow shadow id shadowid if last matched shadow residue iflastmatchedshadowresidue ret ret finding residue findingresidue amc reason override copy prevented overriding should copy location for concretization shouldcopylocationforconcretization allowing method pointcut pointcut concretize resolved type resolvedtype in aspect inaspect int map intmap bindings concretize in aspect inaspect bindings should copy location for concretize shouldcopylocationforconcretize if pointcut ifpointcut partially concretized partiallyconcretized pointcut concretize resolved type resolvedtype in aspect inaspect resolved type resolvedtype declaring type declaringtype int map intmap bindings is declare isdeclare bindings get enclosing advice getenclosingadvice enforce rule designators supported declare in aspect inaspect get world getworld show message showmessage imessage error weaver messages weavermessages format weaver messages weavermessages declare bindings get enclosing advice getenclosingadvice get source location getsourcelocation pointcut make matches nothing makematchesnothing pointcut concrete partially concretized partiallyconcretized partially concretized partiallyconcretized if pointcut ifpointcut ret extra parameter flags extraparameterflags test method testmethod style find test method testmethod aspect defining enclosing pointcut resolved pointcut definition resolvedpointcutdefinition def bindings peek enclosing definition peekenclosingdefinition def resolved type resolvedtype aspect in aspect inaspect get world getworld resolve def get declaring type getdeclaringtype iterator member iter memberiter aspect get methods getmethods member iter memberiter has next hasnext resolved member resolvedmember method resolved member resolvedmember member iter memberiter def get name getname equals method get name getname def get parameter types getparametertypes length method get parameter types getparametertypes length same sig samesig method get parameter types getparametertypes length unresolved type unresolvedtype arg j argj method get parameter types getparametertypes arg j argj equals def get parameter types getparametertypes same sig samesig same sig samesig test method testmethod method test method testmethod in aspect inaspect get world getworld show message showmessage imessage error find body def to string tostring enclosing pointcut hint enclosingpointcuthint get source location getsourcelocation pointcut make matches nothing makematchesnothing pointcut concrete test method testmethod in aspect inaspect get world getworld resolve bindings get advice signature getadvicesignature ret if pointcut ifpointcut enclosing pointcut hint enclosingpointcuthint ret test method testmethod test method testmethod ret if pointcut ifpointcut test method testmethod extra parameter flags extraparameterflags ret copy location from copylocationfrom partially concretized partiallyconcretized ret compiler error bindings directly in advice directlyinadvice bindings get enclosing advice getenclosingadvice assumption clause advice enclosing advice in aspect inaspect get world getworld show message showmessage imessage error weaver messages weavermessages format weaver messages weavermessages perclause get source location getsourcelocation pointcut make matches nothing makematchesnothing pointcut concrete bindings directly in advice directlyinadvice shadow munger shadowmunger advice bindings get enclosing advice getenclosingadvice advice advice ret base args count baseargscount advice advice get base parameter count getbaseparametercount ret base args count baseargscount ret residue source residuesource advice get pointcut getpointcut concretize in aspect inaspect in aspect inaspect ret base args count baseargscount advice resolved pointcut definition resolvedpointcutdefinition def bindings peek enclosing definition peekenclosingdefinition def cflow pointcut cflowpointcut cflow marker in aspect inaspect get world getworld show message showmessage imessage error weaver messages weavermessages format weaver messages weavermessages lexically cflow get source location getsourcelocation pointcut make matches nothing makematchesnothing pointcut concrete ret base args count baseargscount def get parameter types getparametertypes length fixme lead failure args test thejp args implementation ret extra parameter flags extraparameterflags ret base args count baseargscount test method testmethod get parameter types getparametertypes length string arg signature argsignature test method testmethod get parameter types getparametertypes get signature getsignature ajc member maker ajcmembermaker typex joinpoint get signature getsignature equals arg signature argsignature ajc member maker ajcmembermaker typex proceedingjoinpoint get signature getsignature equals arg signature argsignature ajc member maker ajcmembermaker typex staticjoinpoint get signature getsignature equals arg signature argsignature ajc member maker ajcmembermaker typex enclosingstaticjoinpoint get signature getsignature equals arg signature argsignature ret base args count baseargscount int map intmap new bindings newbindings int map intmap id map idmap ret base args count baseargscount new bindings newbindings copy context copycontext bindings ret residue source residuesource def get pointcut getpointcut concretize in aspect inaspect declaring type declaringtype new bindings newbindings ret touch methods pointcut parameterize with parameterizewith map type variable map typevariablemap pointcut matches nothing matchesnothing matches nothing pointcut matchesnothingpointcut good optimizations point if pointcut ifpointcut make if false pointcut makeiffalsepointcut if pointcut ifpointcut ret if false pointcut iffalsepointcut ret ret object accept pattern node visitor patternnodevisitor visitor object data visitor visit data if false pointcut iffalsepointcut if pointcut ifpointcut if false pointcut iffalsepointcut pointcut kind pointcutkind pointcut could match kinds couldmatchkinds shadow shadow kinds bits always false alwaysfalse test find residue internal findresidueinternal shadow shadow exposed state exposedstate earlier error occurred literal fuzzy boolean fuzzyboolean fast match fastmatch fast match info fastmatchinfo type fuzzy boolean fuzzyboolean fuzzy boolean fuzzyboolean match internal matchinternal shadow shadow fuzzy boolean fuzzyboolean fuzzy boolean fuzzyboolean match join point joinpoint static part staticpart jpsp fuzzy boolean fuzzyboolean resolve bindings resolvebindings iscope scope bindings bindings post read postread resolved type resolvedtype enclosing type enclosingtype pointcut concretize resolved type resolvedtype in aspect inaspect resolved type resolvedtype declaring type declaringtype int map intmap bindings is declare isdeclare bindings get enclosing advice getenclosingadvice enforce rule designators supported declare in aspect inaspect get world getworld show message showmessage imessage error weaver messages weavermessages format weaver messages weavermessages declare bindings get enclosing advice getenclosingadvice get source location getsourcelocation pointcut make matches nothing makematchesnothing pointcut concrete make if false pointcut makeiffalsepointcut write data output stream dataoutputstream ioexception write byte writebyte pointcut hash code hashcode result result string to string tostring if pointcut ifpointcut make if true pointcut makeiftruepointcut if pointcut ifpointcut ret if true pointcut iftruepointcut ret ret if true pointcut iftruepointcut if pointcut ifpointcut if true pointcut iftruepointcut pointcut kind pointcutkind pointcut always true alwaystrue test find residue internal findresidueinternal shadow shadow exposed state exposedstate earlier error occurred literal fuzzy boolean fuzzyboolean fast match fastmatch fast match info fastmatchinfo type fuzzy boolean fuzzyboolean fuzzy boolean fuzzyboolean match internal matchinternal shadow shadow fuzzy boolean fuzzyboolean fuzzy boolean fuzzyboolean match join point joinpoint static part staticpart jpsp fuzzy boolean fuzzyboolean resolve bindings resolvebindings iscope scope bindings bindings post read postread resolved type resolvedtype enclosing type enclosingtype pointcut concretize resolved type resolvedtype in aspect inaspect resolved type resolvedtype declaring type declaringtype int map intmap bindings is declare isdeclare bindings get enclosing advice getenclosingadvice enforce rule designators supported declare in aspect inaspect get world getworld show message showmessage imessage error weaver messages weavermessages format weaver messages weavermessages declare bindings get enclosing advice getenclosingadvice get source location getsourcelocation pointcut make matches nothing makematchesnothing pointcut concrete make if true pointcut makeiftruepointcut write data output stream dataoutputstream ioexception write byte writebyte hash code hashcode result result string to string tostring