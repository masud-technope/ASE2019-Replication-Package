copyright xerox corporation palo alto center incorporated parc rights reserved program accompanying materials terms common license accompanies distribution http eclipse org legal cpl html contributors xerox parc initial implementation org aspectj testing harness bridge java file java file filter filefilter java ioexception java util java util array list arraylist java util arrays java util list org aspectj ajde structure model util structuremodelutil org aspectj ajde structure model util structuremodelutil model incorrect exception modelincorrectexception org aspectj bridge icommand org aspectj bridge imessage org aspectj bridge message util messageutil org aspectj testing ajde compile command compilecommand org aspectj testing irun iterator iruniterator org aspectj testing irun status irunstatus org aspectj testing wrapped run iterator wrappedruniterator org aspectj testing xml soft message softmessage org aspectj testing xml xmlwriter org aspectj util file util fileutil org aspectj util lang util langutil incremental compiler takes existing compiler commmand sandbox updates staging directory recompiles staging directory updated prefix suffix rules applied files sandbox test base src dir testbasesrcdir files suffix tag java owned copied staging directory prefixed delete file deleted owned file passed compiler list changed files files entry expected files recompiled xxx underinclusive xxx prefer messages expected files xxx support paths inc compiler run inccompilerrun iajc run iajcrun nonfinal runnable spec spec sandbox sandbox param handler reused thread inc compiler run inccompilerrun spec spec lang util langutil throw iax if null throwiaxifnull spec spec spec spec initialize sandbox compiler changed files changedfiles param sandbox sandbox setup test including copying changed files org aspectj testing harness bridge ajc test ajctest iajc run iajcrun setup file file abort exception abortexception ioexception illegal argument exception illegalargumentexception staging operations fail setup ajc run setupajcrun sandbox sandbox validator validator lang util langutil throw iax if null throwiaxifnull validator validator validator nullcheck sandbox sandbox validator nullcheck spec spec validator nullcheck spec tag file suffix filesuffix file src dir srcdir sandbox get test base src dir gettestbasesrcdir file dest dir destdir sandbox staging dir stagingdir validator can read dir canreaddir src dir srcdir test base src dir testbasesrcdir validator can read dir canreaddir dest dir destdir staging dir stagingdir sandbox sandbox do staging dostaging validator handle copying deleting files tag returns tag file copied deleted failures copying deleting files staging completed do staging dostaging validator validator equals spec tag result string to suffix tosuffix java string from suffix fromsuffix spec tag to suffix tosuffix copy tagged generation files staging directory deleting changed files collector changedfilescollector delete suffix sigh delay mod time int holder intholder holder int holder intholder list copied array list arraylist do staging dostaging validator java holder copied do staging dostaging validator jar holder copied do staging dostaging validator holder copied arbitrary resource extension do staging dostaging validator properties holder copied arbitrary resource extension do staging dostaging validator xml holder copied holder num copies numcopies holder num deletes numdeletes validator fail files changed result holder num fails numfails copied size file files file copied to array toarray file file util fileutil sleep past final modified time sleeppastfinalmodifiedtime files null pointer exception nullpointerexception npe validator fail staging input npe ioexception validator fail staging operations result do staging dostaging validator validator string to suffix tosuffix int holder intholder holder list copied ioexception string from suffix fromsuffix spec tag to suffix tosuffix string clip delete to suffix tosuffix file filter filefilter delete or count deleteorcount file filter filefilter copy file deleted accept file file do copy docopy string path file get absolute path getabsolutepath path ends with endswith clip holder num copies numcopies validator info copying file path copied add file do copy docopy path path substring path length clip length to suffix tosuffix file to delete todelete file path to delete todelete delete validator info deleted file path holder num deletes numdeletes validator fail unable delete file path holder num fails numfails do copy docopy file src dir srcdir sandbox get test base src dir gettestbasesrcdir file dest dir destdir sandbox staging dir stagingdir file util fileutil copy dir copydir src dir srcdir dest dir destdir from suffix fromsuffix to suffix tosuffix delete or count deleteorcount int holder intholder num copies numcopies num deletes numdeletes num fails numfails org aspectj testing irun irun status irunstatus irun status irunstatus status icommand compiler sandbox get command getcommand compiler message util messageutil abort status compiler list expected classes file normal form relative base src dir suffix org aspectj tools ajc main preliminary list generated do staging dostaging array list arraylist expected classes expectedclasses do staging dostaging status expected classes expectedclasses add additional expected entries listed spec normalize file path info messages redundancies list also changed alsochanged spec get paths as file getpathsasfile sandbox staging dir stagingdir iterator iter also changed alsochanged iterator iter has next hasnext file file iter expected classes expectedclasses xxx remove comment changed works get paths as file getpathsasfile producing file normalizes paths file equals compares lexically string specification changed file redundant tagged file message util messageutil info status expected classes expectedclasses add create handler reporting list errors spec get messages getmessages imessage error list warnings spec get messages getmessages imessage warning ajc message handler ajcmessagehandler handler ajc message handler ajcmessagehandler errors warnings expected classes expectedclasses dir changes dirchanges handling java run javarun compiler run compilerrun inc compiler run inccompilerrun xxx advice template method dir changes dirchanges dir changes dirchanges lang util langutil is empty isempty spec dir changes dirchanges lang util langutil throw iax if false throwiaxiffalse spec dir changes dirchanges size expecting dir changes dirchanges dir changes dirchanges dir changes dirchanges dir changes dirchanges spec spec dir changes dirchanges dir changes dirchanges start status sandbox classes dir classesdir setup failed ajc message handler ajcmessagehandler handler ajc message handler ajcmessagehandler spec get messages getmessages handler result handlerresult command result commandresult result report handler init spec fresh compiler compile command compilecommand urk compile command compilecommand compiler build next fresh buildnextfresh message util messageutil info handler fresh supported compiler compiler start time starttime system current time millis currenttimemillis command result commandresult compiler repeat command repeatcommand handler spec check model checkmodel equals structure model util structuremodelutil check model checkmodel spec check model checkmodel xxx disabled lang util langutil throw iax if not all assignable throwiaxifnotallassignable actual recompiled actualrecompiled file recompiled report handler verify sandbox handler result handlerresult handler passed handler result handlerresult result result command result commandresult handler expecting command true expectingcommandtrue result string command result commandresult incremental compile command expected incremental compile command returned unexpectedly message util messageutil fail status dir changes dirchanges result dir changes dirchanges status sandbox test base dir testbasedir model incorrect exception modelincorrectexception message util messageutil fail status get message getmessage result spec runtime is verbose isverbose debugging context failure message util messageutil info handler spec spec to long string tolongstring message util messageutil info handler sandbox sandbox string classes file util fileutil list files listfiles sandbox classes dir classesdir message util messageutil info handler sandbox classes arrays as list aslist classes xxx weak actual messages reported real time fast fail report handler report status result has file hasfile array list arraylist changed file changed string to string tostring spec inc compiler run inccompilerrun spec xxx initializer factory inc compiler run inccompilerrun spec abstract run spec abstractrunspec string xmlname compile fresh array list arraylist classes added classesadded array list arraylist classes removed classesremoved array list arraylist classes updated classesupdated string check model checkmodel skip description skip source location sourcelocation keywords skip options paths classes comment skip staging skip bad input badinput irrelevant dir changes dirchanges messages skip children xmlnames names xmlnames xmlnames classes identifies files owns tag java maps java string tag spec xmlname set staging setstaging classes added classesadded array list arraylist classes removed classesremoved array list arraylist classes updated classesupdated array list arraylist check model checkmodel init clone initclone spec spec clone not supported exception clonenotsupportedexception init clone initclone spec spec fresh fresh spec tag tag spec classes added classesadded clear spec classes added classesadded add all addall classes added classesadded spec classes removed classesremoved clear spec classes removed classesremoved add all addall classes removed classesremoved spec classes updated classesupdated clear spec classes updated classesupdated add all addall classes updated classesupdated object clone clone not supported exception clonenotsupportedexception spec result spec init clone initclone result result set fresh setfresh fresh fresh fresh set tag settag string input tag input set check model setcheckmodel string things to check thingstocheck check model checkmodel things to check thingstocheck string to string tostring inc compile inccompile spec tag to string tostring check model checkmodel override dir token dirtoken sandbox classes suffix add dir changes adddirchanges dir changes dirchanges spec spec xxx copy paste compiler run compilerrun spec spec spec set dir token setdirtoken sandbox classes dir spec set default suffix setdefaultsuffix add dir changes adddirchanges spec inc compiler run inccompilerrun spec setup completes irun iterator iruniterator make run iterator makeruniterator sandbox sandbox validator validator inc compiler run inccompilerrun inc compiler run inccompilerrun setup ajc run setupajcrun sandbox validator xxx wrapped run iterator wrappedruniterator write compile element defined ajc spec xml reader ajcspecxmlreader doctype ajc spec xml reader ajcspecxmlreader doctype ixml writable ixmlwritable write xml writexml xmlwriter write xml writexml xmlwriter string attr xmlwriter make attribute makeattribute tag tag start element startelement xml element name xmlelementname attr fresh print attribute printattribute fresh write attributes writeattributes end attributes endattributes lang util langutil is empty isempty dir changes dirchanges dir changes dirchanges spec write xml writexml dir changes dirchanges soft message softmessage write xml writexml get messages getmessages end element endelement xml element name xmlelementname set classes added setclassesadded string items add items additems classes added classesadded items set classes updated setclassesupdated string items add items additems classes updated classesupdated items set classes removed setclassesremoved string items add items additems classes removed classesremoved items add items additems array list arraylist list string items items string classes xmlwriter unflatten list unflattenlist items lang util langutil is empty isempty classes classes length lang util langutil is empty isempty classes list add classes inc compiler run inccompilerrun spec xxx replaced method local revisit collects list changed files deletes file prefixed delete changed files collector changedfilescollector file filter filefilter string delete suffix delete java string replace suffix java array list arraylist changed validator validator generate paths clipping file dest dir destdir param changed sink files changed full paths changed files collector changedfilescollector array list arraylist changed file dest dir destdir validator validator lang util langutil throw iax if null throwiaxifnull validator changed files collector changedfilescollector handler changed changed validator validator dest dir destdir dest dir destdir converts input file normal string path form source suffix adds list changed file suffixed delete delete file copy copy file java file filter filefilter accept file accept file file string aname file get absolute path getabsolutepath string file get name getname do copy docopy failed ends with endswith delete suffix substring length delete suffix length file file get parent file getparentfile file file file replace suffix file can write canwrite validator fail file delete writable file failed file delete validator fail unable delete file file failed do copy docopy failed do copy docopy clip file util fileutil source suffix length sourcesuffixlength file clip substring length clip dest dir destdir string path dest dir destdir get path getpath lang util langutil is empty isempty path xxx incomplete starts with startswith path loc last index of lastindexof path loc sigh file util fileutil weak normalize weaknormalize changed add file do copy docopy