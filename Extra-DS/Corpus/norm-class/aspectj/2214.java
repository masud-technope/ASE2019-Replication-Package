org aspectj apache bcel verifier structurals org aspectj apache bcel org aspectj apache bcel verifier exc java awt color java util array list arraylist java util enumeration java util hash set hashset java util hashtable java util iterator instances subroutines code array method implementation considers top level instructions reachable jsr jsr starting instruction code array method special subroutine get top level gettoplevel note definition subroutines java virtual machine specification edition incomplete just ice justice rigid notion basically subroutine piece code starts target jsr jsr instruction ends ret instruction note control flow subroutine complex linear subroutines nested just ice justice mandates subroutines exception handling code sake control flow predictability understand just ice justice notion subroutines read todo refer paper version subroutines java aclement exp author href http inf berlin ehaase enver haase get top level gettoplevel subroutines subroutine subroutine impl subroutineimpl subroutine unset symbol uninitialized local variable localvariable field top level subroutine subroutine unset local variable slot instruction subroutine astore stores jsr instruction jsrinstruction return address returnaddress ret subroutine operates local variable localvariable unset instructions belong subroutine elements instruction handle instructionhandle hash set hashset instructions hash set hashset refer subroutine documentation instruction handle instructionhandle inst instructions inst jsr jsr instructions define subroutine targeting hash set hashset the jsrs thejsrs hash set hashset ret instruction leaves subroutine instruction handle instructionhandle the ret theret returns string representation object debugging purposes internal warning verbosity problematic subroutine stack overflow errors recursive sub subs subsubs calls don string to string tostring string ret subroutine local variable local variable localvariable jsrs the jsrs thejsrs ret the ret theret instructions instructions to string tostring ret accessed local variable slots alv get accessed locals indices getaccessedlocalsindices alv length ret alv ret ret recursively subsub routines accessed local variable slots alv get recursively accessed locals indices getrecursivelyaccessedlocalsindices alv length ret alv ret ret sets leaving ret instruction invoked instructions invoked top level subroutine set leaving ret setleavingret local variable localvariable unset assertion violated exception assertionviolatedexception set leaving ret setleavingret called top level subroutine forgot local variable iterator iter instructions iterator instruction handle instructionhandle ret iter has next hasnext instruction handle instructionhandle actual instruction handle instructionhandle iter actual get instruction getinstruction ret ret structural code constraint exception structuralcodeconstraintexception subroutine ret detected ret actual ret actual ret structural code constraint exception structuralcodeconstraintexception subroutine ret detected ret ret get instruction getinstruction get index getindex local variable localvariable structural code constraint exception structuralcodeconstraintexception subroutine ret match correct local variable local variable localvariable the ret theret ret refer subroutine documentation instruction handle instructionhandle get entering jsr instructions getenteringjsrinstructions toplevel assertion violated exception assertionviolatedexception get leaving ret getleavingret called top level pseudo subroutine instruction handle instructionhandle jsrs instruction handle instructionhandle the jsrs thejsrs size instruction handle instructionhandle the jsrs thejsrs to array toarray jsrs adds jsr jsr subroutine target add entering jsr instruction addenteringjsrinstruction instruction handle instructionhandle jsr inst jsrinst jsr inst jsrinst jsr inst jsrinst get instruction getinstruction jsr instruction jsrinstruction assertion violated exception assertionviolatedexception expecting jsr instruction jsrinstruction instruction handle instructionhandle local variable localvariable unset assertion violated exception assertionviolatedexception local variable localvariable don leader check targeted local variable localvariable astore jsr instruction jsrinstruction jsr inst jsrinst get instruction getinstruction get target gettarget get instruction getinstruction get index getindex assertion violated exception assertionviolatedexception setting wrong jsr instruction jsrinstruction the jsrs thejsrs add jsr inst jsrinst refer subroutine documentation instruction handle instructionhandle get leaving ret getleavingret toplevel assertion violated exception assertionviolatedexception get leaving ret getleavingret called top level pseudo subroutine the ret theret refer subroutine documentation instruction handle instructionhandle get instructions getinstructions instruction handle instructionhandle ret instruction handle instructionhandle instructions size instruction handle instructionhandle instructions to array toarray ret adds instruction subroutine instructions invoking set leaving ret setleavingret set leaving ret setleavingret add instruction addinstruction instruction handle instructionhandle the ret theret assertion violated exception assertionviolatedexception instructions invoking set leaving ret setleavingret instructions add satisfies subroutine get recursively accessed locals indices getrecursivelyaccessedlocalsindices get recursively accessed locals indices getrecursivelyaccessedlocalsindices hash set hashset hash set hashset lvs get accessed locals indices getaccessedlocalsindices lvs length add integer lvs get recursively accessed locals indices helper getrecursivelyaccessedlocalsindiceshelper sub subs subsubs ret size iterator iterator has next hasnext ret integer int value intvalue ret recursive helper method get recursively accessed locals indices getrecursivelyaccessedlocalsindices get recursively accessed locals indices getrecursivelyaccessedlocalsindices get recursively accessed locals indices helper getrecursivelyaccessedlocalsindiceshelper hash set hashset subroutine subs subs length lvs subs get accessed locals indices getaccessedlocalsindices lvs length add integer lvs subs sub subs subsubs length get recursively accessed locals indices helper getrecursivelyaccessedlocalsindiceshelper subs sub subs subsubs satisfies subroutine get accessed local indices getaccessedlocalindices get accessed locals indices getaccessedlocalsindices todo implement caching hash set hashset acc hash set hashset the ret theret toplevel assertion violated exception assertionviolatedexception subroutine object built completely calculating accessed locals iterator instructions iterator has next hasnext instruction handle instructionhandle instruction handle instructionhandle ret local variable instruction localvariableinstruction current version bcel get instruction getinstruction local variable instruction localvariableinstruction get instruction getinstruction ret idx indexed instruction indexedinstruction get instruction getinstruction get index getindex acc add integer idx constant pool get instruction getinstruction local variable instruction localvariableinstruction local variable instruction localvariableinstruction get instruction getinstruction get type gettype get size getsize acc add integer idx runtime exception runtimeexception assertion violated exception assertionviolatedexception oops bcel constant pool gen constantpoolgen object ret acc size acc iterator has next hasnext ret integer int value intvalue ret satisfies subroutine sub subs subsubs subroutine sub subs subsubs hash set hashset hash set hashset iterator instructions iterator has next hasnext instruction inst instruction handle instructionhandle get instruction getinstruction inst jsr instruction jsrinstruction instruction handle instructionhandle targ jsr instruction jsrinstruction inst get target gettarget add get subroutine getsubroutine targ subroutine ret subroutine size subroutine to array toarray ret sets local variable slot astore targeted jsr instructions jsrinstructions subroutine operates subroutine ret operates local variable slot set local variable setlocalvariable local variable localvariable unset assertion violated exception assertionviolatedexception local variable localvariable local variable localvariable constructor subroutine impl subroutineimpl subroute impl subrouteimpl hashtable subroutines key instruction handle instructionhandle leader subroutine elements subroutine impl subroutineimpl objects hashtable subroutines hashtable referring special subroutine top level subroutine distinguish top level instructions unreachable instructions subroutine toplevel constructor param method gen methodgen object representing method create subroutine objects subroutines method gen methodgen instruction handle instructionhandle get instruction list getinstructionlist get instruction handles getinstructionhandles code exception gen codeexceptiongen handlers get exception handlers getexceptionhandlers define toplevel fake subroutine toplevel subroutine impl subroutineimpl calculate real subroutines elements instruction handle instructionhandle hash set hashset leaders hash set hashset instruction handle instructionhandle length instruction inst get instruction getinstruction inst jsr instruction jsrinstruction leaders add jsr instruction jsrinstruction inst get target gettarget build database iterator iter leaders iterator iter has next hasnext subroutine impl subroutineimpl subroutine impl subroutineimpl instruction handle instructionhandle astore instruction handle instructionhandle iter set local variable setlocalvariable astore astore get instruction getinstruction get index getindex subroutines astore fake bit virtual top level toplevel subroutine subroutines toplevel leaders add disallowed checked bfs length instruction inst get instruction getinstruction inst jsr instruction jsrinstruction instruction handle instructionhandle leader jsr instruction jsrinstruction inst get target gettarget subroutine impl subroutineimpl get subroutine getsubroutine leader add entering jsr instruction addenteringjsrinstruction bfs subroutine leader find instructions belong subroutine don assign instruction subroutine objects hash set hashset instructions assigned hash set hashset graph colouring key instruction handle instructionhandle java awt color hashtable colors hashtable iter leaders iterator iter has next hasnext bfs actual root graph instruction handle instructionhandle actual instruction handle instructionhandle iter init colors length colors color white colors actual color gray init queue array list arraylist array list arraylist add obj adds remove removes start add actual bfs algorithm modification start multiple root nodes exception handlers starting points top level code top level todo refer special just ice justice notion subroutines actual handlers length colors handlers get handler pc gethandlerpc color gray add handlers get handler pc gethandlerpc loop queue empty size instruction handle instructionhandle instruction handle instructionhandle remove instruction handle instructionhandle successors get successors getsuccessors successors length color colors successors color white colors successors color gray add successors colors color black bfs ended length colors color black subroutine impl subroutineimpl actual get top level gettoplevel get subroutine getsubroutine actual add instruction addinstruction instructions assigned structural code constraint exception structuralcodeconstraintexception instruction subroutine top level subroutine instructions assigned add don deal top level subroutine actual subroutine impl subroutineimpl get subroutine getsubroutine actual set leaving ret setleavingret mandated just ices justices notion subroutines handlers length instruction handle instructionhandle handlers get start pc getstartpc note inclusive inclusive notation api exception handlers handlers get end pc getendpc get next getnext enumeration subs subroutines elements subs has more elements hasmoreelements subroutine subroutine subs next element nextelement don forbid top level exception handlers subroutines structural code constraint exception structuralcodeconstraintexception subroutine instruction exception handler handlers forbidden just ice justice verifier clear definition subroutines get next getnext subroutine calling subroutine local variable ret recursively includes subroutines call recursively intermediate calls subroutines no recursive calls norecursivecalls get top level gettoplevel hash set hashset recursive utility method subroutine calling subroutine local variable ret recursively includes subroutines call recursively intermediate calls subroutines structural code constraint exception structuralcodeconstraintexception constraint satisfied no recursive calls norecursivecalls subroutine hash set hashset subroutine subs sub subs subsubs subs length ret subs get leaving ret getleavingret get instruction getinstruction get index getindex add integer don to string tostring infinite recursive sub subs subsubs calls subroutine impl subroutineimpl subroutine impl subroutineimpl subs structural code constraint exception structuralcodeconstraintexception subroutine local variable local variable localvariable jsrs the jsrs thejsrs ret the ret theret called subroutine local variable recursive call just ice justice clean definition subroutine forbids no recursive calls norecursivecalls subs remove integer returns subroutine object leader instruction subroutine top level instructions modeled subroutine object get top level gettoplevel subroutine get subroutine getsubroutine instruction handle instructionhandle leader subroutine ret subroutine subroutines leader ret assertion violated exception assertionviolatedexception subroutine requested instruction handle instructionhandle leader subroutine ret toplevel assertion violated exception assertionviolatedexception toplevel special subroutine requested get top level gettoplevel ret returns subroutine object instruction costly operation get subroutine getsubroutine instruction handle instructionhandle returns instruction handle instructionhandle lies called dead code code executed get subroutine getsubroutine instruction handle instructionhandle get top level gettoplevel subroutine subroutine of subroutineof instruction handle instructionhandle iterator subroutines values iterator has next hasnext subroutine subroutine system err println debug verify lies dead code assertion violated exception assertionviolatedexception subroutine instruction handle instructionhandle dead code easy handling piece code subroutine top level modeled subroutine object special subroutine object invoke get entering jsr instructions getenteringjsrinstructions get leaving ret getleavingret subroutine get entering jsr instructions getenteringjsrinstructions subroutine get leaving ret getleavingret subroutine get top level gettoplevel toplevel utility method calculates successors instruction handle instructionhandle subroutine ret successors defined jsr instruction jsrinstruction physical successor successor opposed target defined instruction handle instructionhandle get successors getsuccessors instruction handle instructionhandle instruction instruction handle instructionhandle empty instruction handle instructionhandle instruction handle instructionhandle single instruction handle instructionhandle instruction handle instructionhandle pair instruction handle instructionhandle instruction inst instruction get instruction getinstruction inst ret empty terminates method inst return instruction returninstruction empty subroutines exception handlers inst athrow empty method comment inst jsr instruction jsrinstruction single instruction get next getnext single inst goto instruction gotoinstruction single goto instruction gotoinstruction inst get target gettarget single inst branch instruction branchinstruction inst select bcel get targets gettargets returns targets eli tilevich reporting instruction handle instructionhandle match targets matchtargets select inst get targets gettargets instruction handle instructionhandle ret instruction handle instructionhandle match targets matchtargets length ret select inst get target gettarget system arraycopy match targets matchtargets ret match targets matchtargets length ret pair instruction get next getnext pair branch instruction branchinstruction inst get target gettarget pair fall single instruction get next getnext single returns string representation object debugging puposes string to string tostring subroutines to string tostring