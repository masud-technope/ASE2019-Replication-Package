copyright palo alto center incorporated parc rights reserved program accompanying materials terms common license accompanies distribution http eclipse org legal cpl html contributors parc initial implementation org aspectj weaver patterns java data output stream dataoutputstream java ioexception java lang reflect field java util array list arraylist java util collection java util hash map hashmap java util iterator java util list java util map java util org aspectj bridge isource location isourcelocation org aspectj lang signature org aspectj lang reflect field signature fieldsignature org aspectj lang reflect method signature methodsignature org aspectj util fuzzy boolean fuzzyboolean org aspectj weaver aj attribute ajattribute org aspectj weaver ajc member maker ajcmembermaker org aspectj weaver annotation target kind annotationtargetkind org aspectj weaver constants org aspectj weaver isource context isourcecontext org aspectj weaver join point signature joinpointsignature org aspectj weaver member org aspectj weaver name mangler namemangler org aspectj weaver new field type munger newfieldtypemunger org aspectj weaver resolved member resolvedmember org aspectj weaver resolved type resolvedtype org aspectj weaver unresolved type unresolvedtype org aspectj weaver versioned data input stream versioneddatainputstream org aspectj weaver org aspectj weaver bcel bcel type munger bceltypemunger signature pattern signaturepattern pattern node patternnode member kind kind modifiers pattern modifierspattern modifiers type pattern typepattern return type returntype type pattern typepattern declaring type declaringtype name pattern namepattern type pattern list typepatternlist parameter types parametertypes throws pattern throwspattern throws pattern throwspattern annotation type pattern annotationtypepattern annotation pattern annotationpattern hashcode signature pattern signaturepattern member kind kind modifiers pattern modifierspattern modifiers type pattern typepattern return type returntype type pattern typepattern declaring type declaringtype name pattern namepattern type pattern list typepatternlist parameter types parametertypes throws pattern throwspattern throws pattern throwspattern annotation type pattern annotationtypepattern annotation pattern annotationpattern kind kind modifiers modifiers return type returntype return type returntype declaring type declaringtype declaring type declaringtype parameter types parametertypes parameter types parametertypes throws pattern throwspattern throws pattern throwspattern annotation pattern annotationpattern annotation pattern annotationpattern signature pattern signaturepattern resolve bindings resolvebindings iscope scope bindings bindings return type returntype return type returntype return type returntype resolve bindings resolvebindings scope bindings check for incorrect target kind checkforincorrecttargetkind return type returntype scope declaring type declaringtype declaring type declaringtype declaring type declaringtype resolve bindings resolvebindings scope bindings check for incorrect target kind checkforincorrecttargetkind declaring type declaringtype scope parameter types parametertypes parameter types parametertypes parameter types parametertypes resolve bindings resolvebindings scope bindings check for incorrect target kind checkforincorrecttargetkind parameter types parametertypes scope throws pattern throwspattern throws pattern throwspattern throws pattern throwspattern resolve bindings resolvebindings scope bindings throws pattern throwspattern get forbidden getforbidden get type patterns gettypepatterns length throws pattern throwspattern get required getrequired get type patterns gettypepatterns length check for incorrect target kind checkforincorrecttargetkind throws pattern throwspattern scope annotation pattern annotationpattern annotation pattern annotationpattern annotation pattern annotationpattern resolve bindings resolvebindings scope bindings check for incorrect target kind checkforincorrecttargetkind annotation pattern annotationpattern scope hashcode bug adding xlint warning annnotation target type wrong logic applied pointcuts don signature pattern signaturepattern resolve bindings resolvebindings check for incorrect target kind checkforincorrecttargetkind pattern node patternnode pattern node patternnode iscope scope targets other than type allowed targetsotherthantypeallowed warning turned pattern node patternnode scope get world getworld is in java isinjava mode scope get world getworld get lint getlint unmatched target kind unmatchedtargetkind pattern node patternnode any type pattern anytypepattern pattern node patternnode exact annotation type pattern exactannotationtypepattern resolved type resolvedtype resolved type resolvedtype exact annotation type pattern exactannotationtypepattern pattern node patternnode get annotation type getannotationtype resolve scope get world getworld targets other than type allowed targetsotherthantypeallowed annotation target kind annotationtargetkind target kinds targetkinds resolved type resolvedtype get annotation target kinds getannotationtargetkinds target kinds targetkinds report unmatched target kind message reportunmatchedtargetkindmessage target kinds targetkinds pattern node patternnode scope targets other than type allowed targetsotherthantypeallowed resolved type resolvedtype can annotation target type canannotationtargettype incorrect checked type target annotation annotation target kind annotationtargetkind target kinds targetkinds resolved type resolvedtype get annotation target kinds getannotationtargetkinds target kinds targetkinds report unmatched target kind message reportunmatchedtargetkindmessage target kinds targetkinds pattern node patternnode scope type pattern visitor typepatternvisitor visitor type pattern visitor typepatternvisitor scope targets other than type allowed targetsotherthantypeallowed pattern node patternnode traverse visitor visitor contained incorrect target kind containedincorrecttargetkind visitor get incorrect target kinds getincorrecttargetkinds key set keyset iterator iter iterator iter has next hasnext pattern node patternnode node pattern node patternnode iter annotation target kind annotationtargetkind target kinds targetkinds annotation target kind annotationtargetkind visitor get incorrect target kinds getincorrecttargetkinds node report unmatched target kind message reportunmatchedtargetkindmessage target kinds targetkinds node scope report unmatched target kind message reportunmatchedtargetkindmessage annotation target kind annotationtargetkind annotation target kinds annotationtargetkinds pattern node patternnode node iscope scope check matches member kind name checkmatchesmemberkindname string buffer stringbuffer target names targetnames string buffer stringbuffer annotation target kinds annotationtargetkinds length annotation target kind annotationtargetkind target kind targetkind annotation target kinds annotationtargetkinds check matches member kind name checkmatchesmemberkindname kind get name getname equals target kind targetkind get name getname annotation target kinds annotationtargetkinds length target names targetnames append element type elementtype target kind targetkind get name getname target names targetnames append element type elementtype target kind targetkind get name getname scope get world getworld get lint getlint unmatched target kind unmatchedtargetkind signal string node to string tostring target names targetnames to string tostring get source location getsourcelocation isource location isourcelocation visits nodes type pattern typepattern tree exact type pattern exacttypepattern creates exact annotation type pattern exactannotationtypepattern checks target kind targetkind created target annotation matches element type elementtype type target kind allowed matches signature pattern kind restriction type pattern visitor typepatternvisitor abstract pattern node visitor abstractpatternnodevisitor iscope scope map incorrect target kinds incorrecttargetkinds pattern node patternnode annotation target kind annotationtargetkind hash map hashmap targets other than type allowed targetsotherthantypeallowed param required target requiredtarget signature pattern kind param scope type pattern visitor typepatternvisitor iscope scope targets other than type allowed targetsotherthantypeallowed scope scope targets other than type allowed targetsotherthantypeallowed targets other than type allowed targetsotherthantypeallowed object visit wild annotation type pattern wildannotationtypepattern node object data node get type pattern gettypepattern accept data node exact annotation type patterns exactannotationtypepatterns incorrect target object visit exact annotation type pattern exactannotationtypepattern node object data resolved type resolvedtype resolved type resolvedtype node get annotation type getannotationtype resolve scope get world getworld targets other than type allowed targetsotherthantypeallowed annotation target kind annotationtargetkind target kinds targetkinds resolved type resolvedtype get annotation target kinds getannotationtargetkinds target kinds targetkinds data list incorrect targets incorrecttargets array list arraylist target kinds targetkinds length target kinds targetkinds get name getname equals kind get name getname data incorrect targets incorrecttargets add target kinds targetkinds incorrect targets incorrecttargets is empty isempty data annotation target kind annotationtargetkind kinds annotation target kind annotationtargetkind incorrect targets incorrecttargets size incorrect target kinds incorrecttargetkinds node annotation target kind annotationtargetkind incorrect targets incorrecttargets to array toarray kinds targets other than type allowed targetsotherthantypeallowed resolved type resolvedtype can annotation target type canannotationtargettype annotation target kind annotationtargetkind target kinds targetkinds resolved type resolvedtype get annotation target kinds getannotationtargetkinds target kinds targetkinds data incorrect target kinds incorrecttargetkinds node target kinds targetkinds data object visit exact type pattern exacttypepattern node object data exact annotation type pattern exactannotationtypepattern eatp exact annotation type pattern exactannotationtypepattern node get exact type getexacttype resolve scope get world getworld eatp accept data data object visit and type pattern andtypepattern node object data node get left getleft accept data node get right getright accept data node object visit or type pattern ortypepattern node object data node get left getleft accept data node get right getright accept data node object visit any with annotation type pattern anywithannotationtypepattern node object data node get annotation pattern getannotationpattern accept data node contained incorrect target kind containedincorrecttargetkind incorrect target kinds incorrecttargetkinds size map get incorrect target kinds getincorrecttargetkinds incorrect target kinds incorrecttargetkinds post read postread resolved type resolvedtype enclosing type enclosingtype return type returntype return type returntype post read postread enclosing type enclosingtype declaring type declaringtype declaring type declaringtype post read postread enclosing type enclosingtype parameter types parametertypes parameter types parametertypes post read postread enclosing type enclosingtype copy signature pattern type variable reference replaced entry map signature pattern signaturepattern parameterize with parameterizewith map type variable map typevariablemap signature pattern signaturepattern ret signature pattern signaturepattern kind modifiers return type returntype parameterize with parameterizewith type variable map typevariablemap declaring type declaringtype parameterize with parameterizewith type variable map typevariablemap parameter types parametertypes parameterize with parameterizewith type variable map typevariablemap throws pattern throwspattern parameterize with parameterizewith type variable map typevariablemap annotation pattern annotationpattern parameterize with parameterizewith type variable map typevariablemap ret copy location from copylocationfrom ret matches member join point signature joinpointsignature allow bridge methods allowbridgemethods fail succeed fast tests join point signature joinpointsignature kind join point signature joinpointsignature get kind getkind kind member advice hard work subject match subjectmatch iterator candidate matches candidatematches join point signature joinpointsignature get join point signatures getjoinpointsignatures candidate matches candidatematches has next hasnext join point signature joinpointsignature a sig asig join point signature joinpointsignature candidate matches candidatematches fuzzy boolean fuzzyboolean match result matchresult matches exactly matchesexactly a sig asig allow bridge methods allowbridgemethods subject match subjectmatch match result matchresult always true alwaystrue match result matchresult always false alwaysfalse worth signatures subject match subjectmatch pattern match exact signature declaring type mucking chasing hierarchy doesn ancester member match doesn ancester member fuzzy boolean fuzzyboolean matches exactly matchesexactly join point signature joinpointsignature a member amember in aworld inaworld allow bridge methods allowbridgemethods subject match subjectmatch java introduces bridge methods match call a member amember is bridge method isbridgemethod allow bridge methods allowbridgemethods fuzzy boolean fuzzyboolean modifiers match subject subject match subjectmatch modifiers matches a member amember get modifiers getmodifiers fuzzy boolean fuzzyboolean a member amember is private isprivate fuzzy boolean fuzzyboolean fuzzy boolean fuzzyboolean fuzzy boolean fuzzyboolean matches ignoring annotations matchesignoringannotations fuzzy boolean fuzzyboolean kind member initialization matches ignoring annotations matchesignoringannotations matches exactly static initialization matchesexactlystaticinitialization a member amember in aworld inaworld kind member field matches ignoring annotations matchesignoringannotations matches exactly field matchesexactlyfield a member amember in aworld inaworld kind member method matches ignoring annotations matchesignoringannotations matches exactly method matchesexactlymethod a member amember in aworld inaworld subject match subjectmatch kind member constructor matches ignoring annotations matchesignoringannotations matches exactly constructor matchesexactlyconstructor a member amember in aworld inaworld matches ignoring annotations matchesignoringannotations always false alwaysfalse fuzzy boolean fuzzyboolean annotations match subject subject match subjectmatch matches annotations matchesannotations a member amember in aworld inaworld always true alwaystrue fuzzy boolean fuzzyboolean matches ignoring annotations matchesignoringannotations matches declaring type fuzzy boolean fuzzyboolean matches exactly static initialization matchesexactlystaticinitialization join point signature joinpointsignature a member amember fuzzy boolean fuzzyboolean from boolean fromboolean declaring type declaringtype matches statically matchesstatically a member amember get declaring type getdeclaringtype resolve matches declaring type field type fuzzy boolean fuzzyboolean matches exactly field matchesexactlyfield join point signature joinpointsignature a field afield matches a field afield get name getname fuzzy boolean fuzzyboolean resolved type resolvedtype field declaring type fielddeclaringtype a field afield get declaring type getdeclaringtype resolve declaring type declaringtype matches statically matchesstatically field declaring type fielddeclaringtype fuzzy boolean fuzzyboolean return type returntype matches statically matchesstatically a field afield get return type getreturntype resolve bad parameterization return type returntype matches statically matchesstatically a field afield get generic return type getgenericreturntype resolve bad fuzzy boolean fuzzyboolean passed guards fuzzy boolean fuzzyboolean matches declaring type type parameter types types fuzzy boolean fuzzyboolean matches exactly method matchesexactlymethod join point signature joinpointsignature a method amethod subject match subjectmatch matches a method amethod get name getname fuzzy boolean fuzzyboolean check pattern subject match subjectmatch throws pattern throwspattern matches a method amethod get exceptions getexceptions fuzzy boolean fuzzyboolean declaring type declaringtype matches statically matchesstatically a method amethod get declaring type getdeclaringtype resolve fuzzy boolean fuzzyboolean return type returntype matches statically matchesstatically a method amethod get return type getreturntype resolve bad parameterization return type returntype matches statically matchesstatically a method amethod get generic return type getgenericreturntype resolve bad fuzzy boolean fuzzyboolean parameter types parametertypes can match signature with nparameters canmatchsignaturewithnparameters a method amethod get parameter types getparametertypes length fuzzy boolean fuzzyboolean resolved type resolvedtype resolved parameters resolvedparameters resolve a method amethod get parameter types getparametertypes parameter types parametertypes matches resolved parameters resolvedparameters type pattern typepattern always true alwaystrue match based sig parameter types parameterized type parameter types parametertypes matches resolve a method amethod get generic parameter types getgenericparametertypes type pattern typepattern always true alwaystrue fuzzy boolean fuzzyboolean match based erasure parameter types determined test cases check varargs specifications match matches var args matchesvarargs a method amethod fuzzy boolean fuzzyboolean passed guards fuzzy boolean fuzzyboolean match declaring type parameter types types fuzzy boolean fuzzyboolean matches exactly constructor matchesexactlyconstructor join point signature joinpointsignature a constructor aconstructor declaring type declaringtype matches statically matchesstatically a constructor aconstructor get declaring type getdeclaringtype resolve fuzzy boolean fuzzyboolean parameter types parametertypes can match signature with nparameters canmatchsignaturewithnparameters a constructor aconstructor get parameter types getparametertypes length fuzzy boolean fuzzyboolean resolved type resolvedtype resolved parameters resolvedparameters resolve a constructor aconstructor get parameter types getparametertypes parameter types parametertypes matches resolved parameters resolvedparameters type pattern typepattern always true alwaystrue match based sig parameter types parameterized type parameter types parametertypes matches resolve a constructor aconstructor get generic parameter types getgenericparametertypes type pattern typepattern always true alwaystrue fuzzy boolean fuzzyboolean match based erasure parameter types determined test cases check varargs specifications match matches var args matchesvarargs a constructor aconstructor fuzzy boolean fuzzyboolean check pattern throws pattern throwspattern matches a constructor aconstructor get exceptions getexceptions fuzzy boolean fuzzyboolean passed guards fuzzy boolean fuzzyboolean matched method constructor varargs matched simple array additional checks parties agree parameter varargs straight array matches var args matchesvarargs join point signature joinpointsignature a method or constructor amethodorconstructor in aworld inaworld parameter types parametertypes size type pattern typepattern last pattern lastpattern parameter types parametertypes parameter types parametertypes size can match var args signature canmatchvarargssignature last pattern lastpattern is star isstar last pattern lastpattern is var args isvarargs last pattern lastpattern type pattern typepattern ellipsis a method or constructor amethodorconstructor is varargs method isvarargsmethod parameter pattern list method varargs signature can match var args signature canmatchvarargssignature xxx ideally shadow included msg don in aworld inaworld get lint getlint cant match array type on varargs cantmatcharraytypeonvarargs signal a method or constructor amethodorconstructor to string tostring get source location getsourcelocation method ends array type check don require varargs last pattern lastpattern is var args isvarargs fuzzy boolean fuzzyboolean matches annotations matchesannotations resolved member resolvedmember member member member get name getname starts with startswith name mangler namemangler prefix fuzzy boolean fuzzyboolean get lint getlint unresolvable member unresolvablemember signal member to string tostring get source location getsourcelocation fuzzy boolean fuzzyboolean annotation pattern annotationpattern resolve optimization digging annotations itds annotation pattern annotationpattern any annotation type pattern anyannotationtypepattern fuzzy boolean fuzzyboolean relevant member original aspect member is annotated elsewhere isannotatedelsewhere member get kind getkind member field fixme asc duplicate code annotation pattern annotationpattern match internal matchinternal fixmes apply fixme asc include supers get inter type mungers including supers getintertypemungersincludingsupers resolved member resolvedmember mems member get declaring type getdeclaringtype resolve get declared fields getdeclaredfields list mungers member get declaring type getdeclaringtype resolve get inter type mungers getintertypemungers iterator iter mungers iterator iter has next hasnext bcel type munger bceltypemunger type munger typemunger bcel type munger bceltypemunger iter type munger typemunger get munger getmunger new field type munger newfieldtypemunger resolved member resolvedmember fakerm type munger typemunger get signature getsignature resolved member resolvedmember ajc method ajcmethod ajc member maker ajcmembermaker inter field initializer interfieldinitializer fakerm type munger typemunger get aspect type getaspecttype resolved member resolvedmember rmm find method findmethod type munger typemunger get aspect type getaspecttype ajc method ajcmethod fakerm equals member member rmm annotation pattern annotationpattern matches member always true alwaystrue fuzzy boolean fuzzyboolean ancestor members fuzzy boolean fuzzyboolean resolved member resolvedmember find method findmethod resolved type resolvedtype aspect type aspecttype resolved member resolvedmember ajc method ajcmethod resolved member resolvedmember dec methods decmethods aspect type aspecttype get declared methods getdeclaredmethods dec methods decmethods length resolved member resolvedmember member dec methods decmethods member equals ajc method ajcmethod member declaring type match allowing for covariance declaringtypematchallowingforcovariance member member unresolved type unresolvedtype shadow declaring type shadowdeclaringtype type pattern typepattern return type pattern returntypepattern resolved type resolvedtype sig return sigreturn resolved type resolvedtype on type ontype shadow declaring type shadowdeclaringtype resolve fastmatch declaring type declaringtype matches statically matchesstatically on type ontype return type pattern returntypepattern matches statically matchesstatically sig return sigreturn collection declaring types declaringtypes member get declaring types getdeclaringtypes check return type checkreturntype lookup method lookupmethod lookup member no supers lookupmembernosupers iterator declaring types declaringtypes iterator has next hasnext resolved type resolvedtype type resolved type resolvedtype declaring type declaringtype matches statically matchesstatically type check return type checkreturntype resolved member resolvedmember type lookup method lookupmethod member real problems type lookup method in itds lookupmethodinitds member type searching hit parameterized version type unresolved type unresolvedtype return type x returntypex get return type getreturntype resolved type resolvedtype return type returntype return type x returntypex resolve return type pattern returntypepattern matches statically matchesstatically return type returntype collection get declaring types getdeclaringtypes signature sig list array list arraylist on type ontype sig get declaring type getdeclaringtype string member name membername sig get name getname sig field signature fieldsignature field type fieldtype field signature fieldsignature sig get field type getfieldtype super type supertype on type ontype super type supertype field super type supertype get declared field getdeclaredfield member name membername get type gettype field type fieldtype add super type supertype no such field exception nosuchfieldexception nsf super type supertype super type supertype get superclass getsuperclass sig method signature methodsignature param types paramtypes method signature methodsignature sig get parameter types getparametertypes super type supertype on type ontype super type supertype super type supertype get declared method getdeclaredmethod member name membername param types paramtypes add super type supertype no such method exception nosuchmethodexception nsm super type supertype super type supertype get superclass getsuperclass name pattern namepattern get name getname type pattern typepattern get declaring type getdeclaringtype declaring type declaringtype member kind get kind getkind kind string to string tostring string buffer stringbuffer buf string buffer stringbuffer annotation pattern annotationpattern annotation type pattern annotationtypepattern buf append annotation pattern annotationpattern to string tostring buf append modifiers modifiers pattern modifierspattern buf append modifiers to string tostring buf append kind member initialization buf append declaring type declaringtype to string tostring fixme bad parsed buf append clinit kind member handler buf append handler buf append parameter types parametertypes buf append kind member constructor buf append return type returntype to string tostring buf append declaring type declaringtype type pattern typepattern buf append declaring type declaringtype to string tostring buf append kind member constructor buf append buf append to string tostring kind member method kind member constructor buf append parameter types parametertypes to string tostring fixme printed weird buf to string tostring equals object signature pattern signaturepattern signature pattern signaturepattern signature pattern signaturepattern kind equals kind modifiers equals modifiers return type returntype equals return type returntype declaring type declaringtype equals declaring type declaringtype equals parameter types parametertypes equals parameter types parametertypes throws pattern throwspattern equals throws pattern throwspattern annotation pattern annotationpattern equals annotation pattern annotationpattern hash code hashcode hashcode hashcode hashcode hashcode kind hash code hashcode hashcode hashcode modifiers hash code hashcode hashcode hashcode return type returntype hash code hashcode hashcode hashcode declaring type declaringtype hash code hashcode hashcode hashcode hash code hashcode hashcode hashcode parameter types parametertypes hash code hashcode hashcode hashcode throws pattern throwspattern hash code hashcode hashcode hashcode annotation pattern annotationpattern hash code hashcode hashcode write data output stream dataoutputstream ioexception kind write modifiers write return type returntype write declaring type declaringtype write write parameter types parametertypes write throws pattern throwspattern write annotation pattern annotationpattern write write location writelocation signature pattern signaturepattern read versioned data input stream versioneddatainputstream isource context isourcecontext context ioexception member kind kind member kind read modifiers pattern modifierspattern modifiers modifiers pattern modifierspattern read type pattern typepattern return type returntype type pattern typepattern read context type pattern typepattern declaring type declaringtype type pattern typepattern read context name pattern namepattern name pattern namepattern read type pattern list typepatternlist parameter types parametertypes type pattern list typepatternlist read context throws pattern throwspattern throws pattern throwspattern throws pattern throwspattern read context annotation type pattern annotationtypepattern annotation pattern annotationpattern annotation type pattern annotationtypepattern get major version getmajorversion aj attribute ajattribute weaver version info weaverversioninfo weaver version major annotation pattern annotationpattern annotation type pattern annotationtypepattern read context signature pattern signaturepattern ret signature pattern signaturepattern kind modifiers return type returntype declaring type declaringtype parameter types parametertypes throws pattern throwspattern annotation pattern annotationpattern ret read location readlocation context ret modifiers pattern modifierspattern get modifiers getmodifiers modifiers type pattern list typepatternlist get parameter types getparametertypes parameter types parametertypes type pattern typepattern get return type getreturntype return type returntype throws pattern throwspattern get throws pattern getthrowspattern throws pattern throwspattern argument params object modifiers method declared varargs object shouldn matching matched array against var args matchedarrayagainstvarargs type pattern list typepatternlist params modifiers params size modifiers constants acc varargs parameter pattern list method varargs signature type pattern typepattern last pattern lastpattern params params size last pattern lastpattern is array isarray last pattern lastpattern is var args isvarargs annotation type pattern annotationtypepattern get annotation pattern getannotationpattern annotation pattern annotationpattern is star annotation isstarannotation annotation pattern annotationpattern annotation type pattern annotationtypepattern object accept pattern node visitor patternnodevisitor visitor object data visitor visit data