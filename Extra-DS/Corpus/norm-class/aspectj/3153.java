nwalsh saxon java util stack java util string tokenizer stringtokenizer org xml sax org dom javax xml transform transformer exception transformerexception icl saxon output icl saxon icl saxon tree attribute collection attributecollection icl saxon expr fragment value fragmentvalue saxon extension decorate result tree fragment numbers number lines emitter numberlinesemitter java isberg exp copyright norman walsh guts href http users iclway mhkay saxon saxon implementation numbering verbatim environments verbatim general design stylesheets construct result tree fragment verbatim environment verbatim initializes number lines emitter numberlinesemitter lines numbered result tree fragment replayed number lines emitter numberlinesemitter number lines emitter numberlinesemitter builds result tree fragment event stream decorated numbers returned change log initial release verbatim author norman walsh href mailto ndw nwalsh ndw nwalsh version number lines emitter numberlinesemitter java isberg exp number lines emitter numberlinesemitter copy emitter copyemitter stack preserving open elements stack element stack elementstack current number line number linenumber element absolutely element fragment first element firstelement namespace string fo uri fouri http org xsl format code modulus code numbered modulus numbers code width code characters wide width numbers separated listing code separator code string separator stylesheet running stylesheet fo stylesheet fostylesheet constructor number lines emitter numberlinesemitter param name pool namepool pool constructing elements attributes param modulus modulus listing param width width numbers listing param separator separator listing param fo stylesheet fostylesheet stylesheet number lines emitter numberlinesemitter name pool namepool name pool namepool modulus width string separator fo stylesheet fostylesheet name pool namepool element stack elementstack stack first element firstelement modulus modulus width width separator separator fo stylesheet fostylesheet fo stylesheet fostylesheet process characters characters chars start len transformer exception transformerexception hit characters element first element firstelement line number linenumber numbered format line number formatlinenumber line number linenumber walk text node newlines new chars newchars len pos count start count start len count chars count pos output characters preceded newline rtf emitter rtfemitter characters new chars newchars pos pos close open elements stack temp stack tempstack stack element stack elementstack empty start element info startelementinfo elem start element info startelementinfo element stack elementstack pop rtf emitter rtfemitter end element endelement elem get name code getnamecode temp stack tempstack push elem copy newline output new chars newchars pos chars count rtf emitter rtfemitter characters new chars newchars pos pos add number format line number formatlinenumber line number linenumber reopen elements closed temp stack tempstack empty start element info startelementinfo elem start element info startelementinfo temp stack tempstack pop attribute collection attributecollection attr attribute collection attributecollection elem get attributes getattributes attribute collection attributecollection new attr newattr attribute collection attributecollection name pool namepool acount acount attr get length getlength acount string local name localname attr get local name getlocalname acount name code namecode attr get name code getnamecode acount string type attr get type gettype acount string attr get value getvalue acount string uri attr get uri geturi acount string prefix local name localname index of indexof prefix local name localname substring local name localname index of indexof local name localname local name localname substring local name localname index of indexof uri equals fo stylesheet fostylesheet local name localname equals fo stylesheet fostylesheet local name localname equals local name localname equals skip attribute new attr newattr add attribute addattribute prefix uri local name localname type rtf emitter rtfemitter start element startelement elem get name code getnamecode new attr newattr elem get namespaces getnamespaces elem get nscount getnscount element stack elementstack push elem new chars newchars pos chars count pos rtf emitter rtfemitter characters new chars newchars pos pos add formatted number result tree fragment param line number linenumber number current format line number formatlinenumber line number linenumber transformer exception transformerexception nbsp string lno line number linenumber modulus line number linenumber modulus lno line number linenumber lno length width lno lno lno separator chars lno length count count lno length count chars count lno char at charat count characters chars lno length process element events end element endelement name code namecode transformer exception transformerexception element stack elementstack empty didn push element block pre div surrounding block stack empty element element stack elementstack pop rtf emitter rtfemitter end element endelement name code namecode process start element events start element startelement name code namecode org xml sax attributes attributes namespaces nscount transformer exception transformerexception skip this element skipthiselement name code namecode start element info startelementinfo sei start element info startelementinfo name code namecode attributes namespaces nscount element stack elementstack push sei first element firstelement rtf emitter rtfemitter start element startelement name code namecode attributes namespaces nscount protect block wrapper open elements result tree fragment closed reopened callouts callouts don links environments result tree fragment single block div pre html block block treated specially method returns element question outermost block param name code namecode code element element block skip this element skipthiselement name code namecode first element firstelement this fingerprint thisfingerprint name pool namepool get fingerprint getfingerprint name code namecode fo block fingerprint foblockfingerprint name pool namepool get fingerprint getfingerprint fo uri fouri block html pre fingerprint htmlprefingerprint name pool namepool get fingerprint getfingerprint pre html div fingerprint htmldivfingerprint name pool namepool get fingerprint getfingerprint div fo stylesheet fostylesheet this fingerprint thisfingerprint fo block fingerprint foblockfingerprint fo stylesheet fostylesheet this fingerprint thisfingerprint html pre fingerprint htmlprefingerprint this fingerprint thisfingerprint html div fingerprint htmldivfingerprint don push wrapping div pre block maintaining required call start element startelement method order close reopen elements elements maintained record push stack track info start element info startelementinfo name code namecode org xml sax attributes attributes namespaces nscount start element info startelementinfo name code namecode org xml sax attributes attributes namespaces nscount name code namecode name code namecode attributes attributes namespaces namespaces nscount nscount get name code getnamecode name code namecode org xml sax attributes get attributes getattributes attributes get namespaces getnamespaces namespaces get nscount getnscount nscount