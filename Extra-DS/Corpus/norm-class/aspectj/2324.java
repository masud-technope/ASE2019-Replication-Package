copyright palo alto center incorporated parc rights reserved program accompanying materials terms common license accompanies distribution http eclipse org legal cpl html contributors parc initial implementation org aspectj ajdt internal compiler lookup java lang reflect modifier java util array list arraylist java util collection java util hash map hashmap java util hash set hashset java util iterator java util list java util map java util org aspectj ajdt internal compiler ast aspect declaration aspectdeclaration org aspectj ajdt internal compiler ast pointcut declaration pointcutdeclaration org aspectj asm asm manager asmmanager org aspectj bridge imessage org aspectj bridge message util messageutil org aspectj bridge weave message weavemessage org aspectj bridge context compilation and weaving context compilationandweavingcontext org aspectj bridge context context token contexttoken org aspectj org eclipse jdt core compiler char operation charoperation org aspectj org eclipse jdt internal compiler ast abstract method declaration abstractmethoddeclaration org aspectj org eclipse jdt internal compiler ast annotation org aspectj org eclipse jdt internal compiler ast normal annotation normalannotation org aspectj org eclipse jdt internal compiler ast qualified type reference qualifiedtypereference org aspectj org eclipse jdt internal compiler ast single type reference singletypereference org aspectj org eclipse jdt internal compiler ast type declaration typedeclaration org aspectj org eclipse jdt internal compiler ast type reference typereference org aspectj org eclipse jdt internal compiler env access restriction accessrestriction org aspectj org eclipse jdt internal compiler env ibinary type ibinarytype org aspectj org eclipse jdt internal compiler env iname environment inameenvironment org aspectj org eclipse jdt internal compiler impl compiler options compileroptions org aspectj org eclipse jdt internal compiler impl itype requestor ityperequestor org aspectj org eclipse jdt internal compiler lookup binary type binding binarytypebinding org aspectj org eclipse jdt internal compiler lookup class scope classscope org aspectj org eclipse jdt internal compiler lookup compilation unit scope compilationunitscope org aspectj org eclipse jdt internal compiler lookup local type binding localtypebinding org aspectj org eclipse jdt internal compiler lookup lookup environment lookupenvironment org aspectj org eclipse jdt internal compiler lookup method binding methodbinding org aspectj org eclipse jdt internal compiler lookup package binding packagebinding org aspectj org eclipse jdt internal compiler lookup parameterized type binding parameterizedtypebinding org aspectj org eclipse jdt internal compiler lookup reference binding referencebinding org aspectj org eclipse jdt internal compiler lookup source type binding sourcetypebinding org aspectj org eclipse jdt internal compiler lookup tag bits tagbits org aspectj org eclipse jdt internal compiler lookup type binding typebinding org aspectj org eclipse jdt internal compiler problem problem reporter problemreporter org aspectj weaver annotation x annotationx org aspectj weaver asm relationship provider asmrelationshipprovider org aspectj weaver concrete type munger concretetypemunger org aspectj weaver fake annotation fakeannotation org aspectj weaver reference type referencetype org aspectj weaver resolved member resolvedmember org aspectj weaver resolved type resolvedtype org aspectj weaver type variable typevariable org aspectj weaver unresolved type unresolvedtype org aspectj weaver weaver messages weavermessages org aspectj weaver weaver state info weaverstateinfo org aspectj weaver org aspectj weaver bcel lazy class gen lazyclassgen org aspectj weaver patterns declare annotation declareannotation org aspectj weaver patterns declare parents declareparents overrides eclipse lookup environment lookupenvironment purposes provide additional phases code complete type bindings completetypebindings code weave declare parents inter type declarations correct time intercept loading binary types ensure declare parents inter type declarations woven author jim hugunin aj lookup environment ajlookupenvironment lookup environment lookupenvironment anonymous class creation listener anonymousclasscreationlistener eclipse factory eclipsefactory factory built inter types and per clauses builtintertypesandperclauses list pending types to weave pendingtypestoweave array list arraylist dangerous interfaces dangerousinterfaces considered dangerous requires top implementors woven aspect responsible err happen type inpath processed completing type bindings point type mungers stored weaver info attribute effectively working type munger originating aspect problem aspect supplied body method targetting top implementors woven munger aspect store map process type top most implementor topmostimplementor dangerous error message interfaces targetted itds implemented accessing top most implementor topmostimplementor aspect originated map dangerous interfaces dangerousinterfaces hash map hashmap aj lookup environment ajlookupenvironment itype requestor ityperequestor type requestor typerequestor compiler options compileroptions options problem reporter problemreporter problem reporter problemreporter iname environment inameenvironment name environment nameenvironment type requestor typerequestor options problem reporter problemreporter name environment nameenvironment duplicates code complete type bindings completetypebindings asm manager asmmanager set completing type bindings setcompletingtypebindings context token contexttoken complete type bindings token completetypebindingstoken compilation and weaving context compilationandweavingcontext entering phase enteringphase compilation and weaving context compilationandweavingcontext completing type bindings built inter types and per clauses builtintertypesandperclauses pending types to weave pendingtypestoweave array list arraylist step completed stepcompleted build type hierarchy last completed unit index lastcompletedunitindex last unit index lastunitindex context token contexttoken tok compilation and weaving context compilationandweavingcontext entering phase enteringphase compilation and weaving context compilationandweavingcontext check imports units compilation result compilationresult file name filename units scope check and set imports checkandsetimports compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok step completed stepcompleted check imports last completed unit index lastcompletedunitindex last unit index lastunitindex context token contexttoken tok compilation and weaving context compilationandweavingcontext entering phase enteringphase compilation and weaving context compilationandweavingcontext connecting type hierarchy units compilation result compilationresult file name filename units scope connect type hierarchy connecttypehierarchy compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok step completed stepcompleted connect type hierarchy last completed unit index lastcompletedunitindex last unit index lastunitindex context token contexttoken tok compilation and weaving context compilationandweavingcontext entering phase enteringphase compilation and weaving context compilationandweavingcontext building fields methods units compilation result compilationresult file name filename units scope build fields and methods buildfieldsandmethods compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok gather type declarations typedeclarations point factory last completed unit index lastcompletedunitindex last unit index lastunitindex source type binding sourcetypebinding units scope top level types topleveltypes length factory add source type binding addsourcetypebinding units won find anonymous types register told turn anonymous class publisher anonymousclasspublisher aspect of aspectof set anonymous class creation listener setanonymousclasscreationlistener build inter type declarations aspect declarations aspectdeclarations point order types subtypes list types to process typestoprocess array list arraylist last completed unit index lastcompletedunitindex last unit index lastunitindex compilation unit scope compilationunitscope cus units scope source type binding sourcetypebinding stbs cus top level types topleveltypes stbs length source type binding sourcetypebinding stb stbs types to process typestoprocess add stb factory get world getworld get crosscutting members set getcrosscuttingmembersset reset types to process typestoprocess size removes types list processed collect all itds and declares collectallitdsanddeclares source type binding sourcetypebinding types to process typestoprocess types to process typestoprocess factory finish type mungers finishtypemungers weaving collection type mungers typemungers factory get type mungers gettypemungers collection declare parents declareparents factory get declare parents getdeclareparents collection declare annotation on types declareannotationontypes factory get declare annotation on types getdeclareannotationontypes do pending weaves dopendingweaves list types process apply type mungers situations order types passed compiler output compiler vary bad aspect declare parents serializable depending serializable process order ensuring type process supertypes superinterfaces algorithm problems partial hierarchies suppose types hierarchy woven weaving brings types processing pending types to weave pendingtypestoweave add calls thought full list common cases bravely decat type processing order is important typeprocessingorderisimportant declare parents declareparents size declare annotation on types declareannotationontypes size type processing order is important typeprocessingorderisimportant types to process typestoprocess array list arraylist last completed unit index lastcompletedunitindex last unit index lastunitindex compilation unit scope compilationunitscope cus units scope source type binding sourcetypebinding stbs cus top level types topleveltypes stbs length source type binding sourcetypebinding stb stbs types to process typestoprocess add stb types to process typestoprocess size side weave intertypes weaveintertypes processed type removed collection weave intertypes weaveintertypes types to process typestoprocess source type binding sourcetypebinding types to process typestoprocess type mungers typemungers declare parents declareparents declare annotation on types declareannotationontypes order isn last completed unit index lastcompletedunitindex last unit index lastunitindex system err println working string units get file name getfilename weave inter type declarations weaveintertypedeclarations units scope type mungers typemungers declare parents declareparents declare annotation on types declareannotationontypes last completed unit index lastcompletedunitindex last unit index lastunitindex source type binding sourcetypebinding units scope top level types topleveltypes length verify any type parameters meet bounds verifyanytypeparametersmeetbounds last completed unit index lastcompletedunitindex last unit index lastunitindex source type binding sourcetypebinding units scope top level types topleveltypes length context token contexttoken tok compilation and weaving context compilationandweavingcontext entering phase enteringphase compilation and weaving context compilationandweavingcontext resolving pointcut declarations source name sourcename resolve pointcut declarations resolvepointcutdeclarations scope compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok last completed unit index lastcompletedunitindex last unit index lastunitindex source type binding sourcetypebinding units scope top level types topleveltypes length context token contexttoken tok compilation and weaving context compilationandweavingcontext entering phase enteringphase compilation and weaving context compilationandweavingcontext adding declare warnings errors source name sourcename add advice like declares addadvicelikedeclares scope compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok last completed unit index lastcompletedunitindex last unit index lastunitindex release unnecessary reference parsed unit units step completed stepcompleted build fields methods last completed unit index lastcompletedunitindex last unit index lastunitindex asm manager asmmanager set completing type bindings setcompletingtypebindings factory get world getworld get crosscutting members set getcrosscuttingmembersset verify compilation and weaving context compilationandweavingcontext leaving phase leavingphase complete type bindings token completetypebindingstoken sourcetypebinding method checks parameterized aspect type parameters supertypes meet bounds type variables verify any type parameters meet bounds verifyanytypeparametersmeetbounds source type binding sourcetypebinding source type sourcetype resolved type resolvedtype on type ontype factory from eclipse fromeclipse source type sourcetype on type ontype is aspect isaspect resolved type resolvedtype super type supertype factory from eclipse fromeclipse source type sourcetype superclass don check raw form isnt super type supertype is generic type isgenerictype super type supertype is parameterized type isparameterizedtype type variable typevariable type variables typevariables super type supertype get type variables gettypevariables unresolved type unresolvedtype type params typeparams super type supertype get type parameters gettypeparameters type variables typevariables type params typeparams type variables typevariables length type variables typevariables can be bound to canbeboundto type params typeparams resolve factory get world getworld supplied parameter violates bounds type meet specification type parameter type string msg weaver messages weavermessages format weaver messages weavermessages violates type variable bounds type params typeparams integer type variables typevariables get display name getdisplayname super type supertype get generic type getgenerictype get name getname factory get world getworld get message handler getmessagehandler handle message handlemessage message util messageutil error msg on type ontype get source location getsourcelocation do supertypes first dosupertypesfirst reference binding referencebinding collection yet to process yettoprocess source type binding sourcetypebinding yet to process yettoprocess collect all itds and declares collectallitdsanddeclares source type binding sourcetypebinding yet to process yettoprocess parameterized type binding parameterizedtypebinding ptb pull source type binding sourcetypebinding parameterized type binding parameterizedtypebinding ptb parameterized type binding parameterizedtypebinding ptb type source type binding sourcetypebinding yet to process yettoprocess ptb type collect all itds and declares collectallitdsanddeclares source type binding sourcetypebinding ptb type yet to process yettoprocess find itds declares supertypes subtypes param source type sourcetype param yet to process yettoprocess collect all itds and declares collectallitdsanddeclares source type binding sourcetypebinding source type sourcetype collection yet to process yettoprocess supertype context token contexttoken tok compilation and weaving context compilationandweavingcontext entering phase enteringphase compilation and weaving context compilationandweavingcontext collecting itds declares source type sourcetype source name sourcename direct supertype do supertypes first dosupertypesfirst source type sourcetype superclass yet to process yettoprocess check membertypes reference binding referencebinding member types membertypes source type sourcetype member types membertypes length member types membertypes length length source type binding sourcetypebinding source type binding sourcetypebinding member types membertypes superclass equals source type sourcetype do supertypes first dosupertypesfirst superclass yet to process yettoprocess build inter type and per clause buildintertypeandperclause source type sourcetype scope add crosscutting structures addcrosscuttingstructures source type sourcetype scope yet to process yettoprocess remove source type sourcetype compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok weave parents intertype decls type method supertype superinterfaces type recurses weave full list types process compile stops recursing time hits type process compile problems supply pieces hierarchy bottom top middle hell weave intertypes weaveintertypes list types to process typestoprocess source type binding sourcetypebinding type to weave typetoweave collection type mungers typemungers collection declare parents declareparents collection declare annotation on types declareannotationontypes supertype reference binding referencebinding super type supertype type to weave typetoweave superclass types to process typestoprocess super type supertype super type supertype source type binding sourcetypebinding system err println recursing supertype string super type supertype get file name getfilename weave intertypes weaveintertypes types to process typestoprocess source type binding sourcetypebinding super type supertype type mungers typemungers declare parents declareparents declare annotation on types declareannotationontypes superinterface list reference binding referencebinding interface types interfacetypes type to weave typetoweave super interfaces superinterfaces interface types interfacetypes length reference binding referencebinding binding interface types interfacetypes types to process typestoprocess binding binding source type binding sourcetypebinding system err println recursing superinterface string binding get file name getfilename weave intertypes weaveintertypes types to process typestoprocess source type binding sourcetypebinding binding type mungers typemungers declare parents declareparents declare annotation on types declareannotationontypes weave inter type declarations weaveintertypedeclarations type to weave typetoweave type mungers typemungers declare parents declareparents declare annotation on types declareannotationontypes types to process typestoprocess remove type to weave typetoweave do pending weaves dopendingweaves iterator pending types to weave pendingtypestoweave iterator has next hasnext source type binding sourcetypebinding source type binding sourcetypebinding context token contexttoken tok compilation and weaving context compilationandweavingcontext entering phase enteringphase compilation and weaving context compilationandweavingcontext weaving intertype declarations source name sourcename weave inter type declarations weaveintertypedeclarations compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok pending types to weave pendingtypestoweave clear add advice like declares addadvicelikedeclares class scope classscope type declaration typedeclaration dec reference context referencecontext dec aspect declaration aspectdeclaration resolved type resolvedtype type x typex factory from eclipse fromeclipse dec binding factory get world getworld get crosscutting members set getcrosscuttingmembersset add advice like declares addadvicelikedeclares type x typex source type binding sourcetypebinding source type sourcetype reference context referencecontext binding reference binding referencebinding member types membertypes source type sourcetype member types membertypes length member types membertypes length length add advice like declares addadvicelikedeclares source type binding sourcetypebinding member types membertypes scope add crosscutting structures addcrosscuttingstructures class scope classscope type declaration typedeclaration dec reference context referencecontext dec aspect declaration aspectdeclaration resolved type resolvedtype type x typex factory from eclipse fromeclipse dec binding factory get world getworld get crosscutting members set getcrosscuttingmembersset add or replace aspect addorreplaceaspect type x typex type x typex get superclass getsuperclass is aspect isaspect type x typex get superclass getsuperclass is exposed to weaver isexposedtoweaver factory get world getworld get crosscutting members set getcrosscuttingmembersset add or replace aspect addorreplaceaspect type x typex get superclass getsuperclass source type binding sourcetypebinding source type sourcetype reference context referencecontext binding reference binding referencebinding member types membertypes source type sourcetype member types membertypes length member types membertypes length length add crosscutting structures addcrosscuttingstructures source type binding sourcetypebinding member types membertypes scope resolve pointcut declarations resolvepointcutdeclarations class scope classscope type declaration typedeclaration dec reference context referencecontext source type binding sourcetypebinding source type sourcetype reference context referencecontext binding has pointcuts haspointcuts abstract method declaration abstractmethoddeclaration methods dec methods initialized methods initializedmethods methods methods length methods pointcut declaration pointcutdeclaration has pointcuts haspointcuts initialized methods initializedmethods force initialization source type sourcetype methods initialized methods initializedmethods pointcut declaration pointcutdeclaration methods resolve pointcut resolvepointcut has pointcuts haspointcuts dec aspect declaration aspectdeclaration could be annotation style aspect declaration couldbeannotationstyleaspectdeclaration dec reference type referencetype reference type referencetype factory from eclipse fromeclipse source type sourcetype eclipse source type eclipsesourcetype eclipse source type eclipsesourcetype eclipse source type eclipsesourcetype get delegate getdelegate eclipse source type eclipsesourcetype check pointcut declarations checkpointcutdeclarations reference binding referencebinding member types membertypes source type sourcetype member types membertypes length member types membertypes length length resolve pointcut declarations resolvepointcutdeclarations source type binding sourcetypebinding member types membertypes scope declaration aspect annotation called could be couldbe defined annotation called aspect verify full including resolved expensive resolution dont cheap check tells bother could be annotation style aspect declaration couldbeannotationstyleaspectdeclaration type declaration typedeclaration dec annotation annotations dec annotations could be at aspect couldbeataspect annotations annotations length could be at aspect couldbeataspect annotations to string tostring equals aspect could be at aspect couldbeataspect could be at aspect couldbeataspect build inter type and per clause buildintertypeandperclause class scope classscope type declaration typedeclaration dec reference context referencecontext dec aspect declaration aspectdeclaration aspect declaration aspectdeclaration dec build inter type and per clause buildintertypeandperclause source type binding sourcetypebinding source type sourcetype reference context referencecontext binding test classes don extend aspects source type sourcetype superclass resolved type resolvedtype parent factory from eclipse fromeclipse source type sourcetype superclass parent is aspect isaspect is aspect isaspect dec factory show message showmessage imessage error string source type sourcetype source name sourcename extend aspect parent get name getname factory from eclipse fromeclipse source type sourcetype get source location getsourcelocation reference binding referencebinding member types membertypes source type sourcetype member types membertypes length member types membertypes length length build inter type and per clause buildintertypeandperclause source type binding sourcetypebinding member types membertypes scope is aspect isaspect type declaration typedeclaration decl decl aspect declaration aspectdeclaration decl annotations decl annotations length annotation ann decl annotations ann type single type reference singletypereference char operation charoperation equals aspect to char array tochararray single type reference singletypereference ann type token ann type qualified type reference qualifiedtypereference qualified type reference qualifiedtypereference qtr qualified type reference qualifiedtypereference ann type qtr tokens length char operation charoperation equals org to char array tochararray qtr tokens char operation charoperation equals aspectj to char array tochararray qtr tokens char operation charoperation equals lang to char array tochararray qtr tokens char operation charoperation equals annotation to char array tochararray qtr tokens char operation charoperation equals aspect to char array tochararray qtr tokens weave inter type declarations weaveintertypedeclarations compilation unit scope compilationunitscope unit collection type mungers typemungers collection declare parents declareparents collection declare annotation on types declareannotationontypes length unit top level types topleveltypes length length weave inter type declarations weaveintertypedeclarations unit top level types topleveltypes type mungers typemungers declare parents declareparents declare annotation on types declareannotationontypes weave inter type declarations weaveintertypedeclarations source type binding sourcetypebinding source type sourcetype factory are type mungers finished aretypemungersfinished pending types to weave pendingtypestoweave source type sourcetype pending types to weave pendingtypestoweave add source type sourcetype weave inter type declarations weaveintertypedeclarations source type sourcetype factory get type mungers gettypemungers factory get declare parents getdeclareparents factory get declare annotation on types getdeclareannotationontypes weave inter type declarations weaveintertypedeclarations source type binding sourcetypebinding source type sourcetype collection type mungers typemungers collection declare parents declareparents collection declare annotation on types declareannotationontypes skip inners skipinners context token contexttoken tok compilation and weaving context compilationandweavingcontext entering phase enteringphase compilation and weaving context compilationandweavingcontext weaving intertype declarations source type sourcetype source name sourcename resolved type resolvedtype on type ontype factory from eclipse fromeclipse source type sourcetype amc shouldn sigs fixed on type ontype is raw type israwtype on type ontype on type ontype get generic type getgenerictype weaver state info weaverstateinfo info on type ontype get weaver state getweaverstate matched type info info is old style isoldstyle info is reweavable isreweavable process type mungers from existing weaver state processtypemungersfromexistingweaverstate source type sourcetype on type ontype compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok report problem iterator dangerous interfaces dangerousinterfaces entry set entryset iterator has next hasnext map entry entry map entry resolved type resolvedtype interface type interfacetype resolved type resolvedtype entry get key getkey on type ontype is topmost implementor istopmostimplementor interface type interfacetype factory show message showmessage imessage error on type ontype entry get value getvalue on type ontype get source location getsourcelocation need old style warning needoldstylewarning info info is old style isoldstyle on type ontype clear inter type mungers clearintertypemungers fixme asc perf optimize processing expected types bring binary types exposed weaver attempt declare parents declare annotation report exposed weaver messages list decp to repeat decptorepeat array list arraylist list deca to repeat decatorepeat array list arraylist any new parents anynewparents any new annotations anynewannotations annotation patterns match remember iterator declare parents declareparents iterator has next hasnext declare parents declareparents decp declare parents declareparents did something didsomething do declare parents dodeclareparents decp source type sourcetype did something didsomething any new parents anynewparents decp get child getchild is star annotation isstarannotation decp to repeat decptorepeat add decp iterator declare annotation on types declareannotationontypes iterator has next hasnext declare annotation declareannotation deca declare annotation declareannotation did something didsomething do declare annotations dodeclareannotations deca source type sourcetype did something didsomething any new annotations anynewannotations deca get type pattern gettypepattern is star isstar deca to repeat decatorepeat add deca loop any new annotations anynewannotations any new parents anynewparents decp to repeat decptorepeat is empty isempty deca to repeat decatorepeat is empty isempty any new parents anynewparents any new annotations anynewannotations list for removal forremoval array list arraylist iterator decp to repeat decptorepeat iterator has next hasnext declare parents declareparents decp declare parents declareparents did something didsomething do declare parents dodeclareparents decp source type sourcetype did something didsomething any new parents anynewparents for removal forremoval add decp decp to repeat decptorepeat remove all removeall for removal forremoval for removal forremoval array list arraylist iterator declare annotation on types declareannotationontypes iterator has next hasnext declare annotation declareannotation deca declare annotation declareannotation did something didsomething do declare annotations dodeclareannotations deca source type sourcetype did something didsomething any new annotations anynewannotations for removal forremoval add deca deca to repeat decatorepeat remove all removeall for removal forremoval iterator type mungers typemungers iterator has next hasnext eclipse type munger eclipsetypemunger munger eclipse type munger eclipsetypemunger munger matches on type ontype need old style warning needoldstylewarning factory show message showmessage imessage warning on type ontype recompiled ajc on type ontype get source location getsourcelocation need old style warning needoldstylewarning on type ontype add inter type munger addintertypemunger munger on type ontype check inter type mungers checkintertypemungers iterator on type ontype get inter type mungers getintertypemungers iterator has next hasnext eclipse type munger eclipsetypemunger munger eclipse type munger eclipsetypemunger system println applying munger string source type sourcetype source name sourcename munger munge source type sourcetype on type ontype skip inners skipinners compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok reference binding referencebinding member types membertypes source type sourcetype member types membertypes length member types membertypes length length member types membertypes source type binding sourcetypebinding weave inter type declarations weaveintertypedeclarations source type binding sourcetypebinding member types membertypes type mungers typemungers declare parents declareparents declare annotation on types declareannotationontypes compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok called discover weaving intertype declarations type existing weaver state info weaverstateinfo object typically woven type passed inpath source type sourcetype on type ontype type eclipse version weaver version process type mungers from existing weaver state processtypemungersfromexistingweaverstate source type binding sourcetypebinding source type sourcetype resolved type resolvedtype on type ontype collection previously applied mungers previouslyappliedmungers on type ontype get weaver state getweaverstate get type mungers gettypemungers on type ontype iterator previously applied mungers previouslyappliedmungers iterator has next hasnext concrete type munger concretetypemunger concrete type munger concretetypemunger eclipse type munger eclipsetypemunger munger factory make eclipse type munger makeeclipsetypemunger munger munge source type sourcetype on type ontype on type ontype is interface isinterface munger get munger getmunger needs access to topmost implementor needsaccesstotopmostimplementor on type ontype get world getworld get crosscutting members set getcrosscuttingmembersset contains aspect containsaspect munger get aspect type getaspecttype dangerous interfaces dangerousinterfaces on type ontype implementors on type ontype woven munger get aspect type getaspecttype do declare parents dodeclareparents declare parents declareparents declare parents declareparents source type binding sourcetypebinding source type sourcetype context token contexttoken tok compilation and weaving context compilationandweavingcontext entering phase enteringphase compilation and weaving context compilationandweavingcontext processing declare parents source type sourcetype source name sourcename list new parents newparents declare parents declareparents find matching new parents findmatchingnewparents factory from eclipse fromeclipse source type sourcetype new parents newparents is empty isempty iterator new parents newparents iterator has next hasnext resolved type resolvedtype parent resolved type resolvedtype dangerous interfaces dangerousinterfaces contains key containskey parent resolved type resolvedtype on type ontype factory from eclipse fromeclipse source type sourcetype factory show message showmessage imessage error on type ontype dangerous interfaces dangerousinterfaces parent on type ontype get source location getsourcelocation modifier is final isfinal parent get modifiers getmodifiers factory show message showmessage imessage error extend parent get class name getclassname declare parents declareparents get source location getsourcelocation asm relationship provider asmrelationshipprovider get default getdefault add declare parents relationship adddeclareparentsrelationship declare parents declareparents get source location getsourcelocation factory from eclipse fromeclipse source type sourcetype new parents newparents add parent addparent source type sourcetype parent compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok string stringify targets stringifytargets bits bits tag bits tagbits annotation target mask annotationtargetmask hash set hashset bits tag bits tagbits annotation for annotation type annotationforannotationtype add annotation type bits tag bits tagbits annotation for constructor annotationforconstructor add constructor bits tag bits tagbits annotation for field annotationforfield add field bits tag bits tagbits annotation for local variable annotationforlocalvariable add local variable bits tag bits tagbits annotation for method annotationformethod add method bits tag bits tagbits annotation for package annotationforpackage add bits tag bits tagbits annotation for parameter annotationforparameter add parameter bits tag bits tagbits annotation for type annotationfortype add type string buffer stringbuffer string buffer stringbuffer append iterator iter iterator iter has next hasnext string element string iter append element iter has next hasnext append append to string tostring do declare annotations dodeclareannotations declare annotation declareannotation dec a deca source type binding sourcetypebinding source type sourcetype report problems reportproblems resolved type resolvedtype rtx factory from eclipse fromeclipse source type sourcetype dec a deca matches rtx rtx is exposed to weaver isexposedtoweaver context token contexttoken tok compilation and weaving context compilationandweavingcontext entering phase enteringphase compilation and weaving context compilationandweavingcontext processing declare annotations source type sourcetype source name sourcename annotation declare unresolved type unresolvedtype aspect type aspecttype dec a deca get aspect getaspect aspect type aspecttype reference type referencetype reference type referencetype reference type referencetype aspect type aspecttype is parameterized type isparameterizedtype is raw type israwtype aspect type aspecttype get generic type getgenerictype type binding typebinding factory make type binding maketypebinding aspect type aspecttype hideousness multiple situations relate combinations annotation coming annotation straight full build source annotation dec type type types real source type bindings sourcetypebindings works incremental build changing type annotation dec type binary type binding binarytypebinding accessed bcel type real source type binding sourcetypebinding works source type binding sourcetypebinding stb source type binding sourcetypebinding annotation to add toadd abits retrieve annotation bcel construct eclipse stb binary type binding binarytypebinding reference type referencetype reference type referencetype factory from eclipse fromeclipse stb resolved member resolvedmember methods get declared methods getdeclaredmethods resolved member resolvedmember deca method decamethod string name to look for nametolookfor dec a deca get annotation method getannotationmethod methods length methods get name getname equals name to look for nametolookfor deca method decamethod methods deca method decamethod annotation x annotationx axs deca method decamethod get annotations getannotations to add toadd annotation to add toadd create annotation from bcel annotation createannotationfrombcelannotation axs deca method decamethod get source location getsourcelocation get offset getoffset factory bug bug bug dont test abits correct fact lucky incremental compile annotation isn allowed type type abits to add toadd resolved type resolvedtype get annotation tag bits getannotationtagbits nicer real source type binding sourcetypebinding stay eclipse land method binding methodbinding mbs stb get methods getmethods dec a deca get annotation method getannotationmethod to char array tochararray ensure resolved abits mbs get annotation tag bits getannotationtagbits type declaration typedeclaration type decl typedecl source type binding sourcetypebinding mbs declaring class declaringclass scope reference context referencecontext abstract method declaration abstractmethoddeclaration method decl methoddecl type decl typedecl declaration of declarationof mbs add to add toadd method decl methoddecl annotations abits to add toadd resolved type resolvedtype get annotation tag bits getannotationtagbits source type sourcetype binary type binding binarytypebinding access source type binding add annotation weaver type temporarily resolved type resolvedtype the target type thetargettype factory from eclipse fromeclipse source type sourcetype type binding typebinding the annotation type theannotationtype to add toadd resolved type resolvedtype string string the annotation type theannotationtype qualified package name qualifiedpackagename string the annotation type theannotationtype source name sourcename string sig string the annotation type theannotationtype signature the target type thetargettype has annotation hasannotation unresolved type unresolvedtype for signature forsignature sig compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok fixme asc tidy code duplicates simple checks bits giveupnow abits tag bits tagbits annotation target mask annotationtargetmask is annotation targetting something other than annotation or normal isannotationtargettingsomethingotherthanannotationornormal abits error reported giveupnow source type sourcetype is annotation type isannotationtype abits tag bits tagbits annotation for annotation type annotationforannotationtype source type sourcetype is annotation type isannotationtype abits tag bits tagbits annotation for type annotationfortype report problems reportproblems dec a deca is exact pattern isexactpattern factory show message showmessage imessage error weaver messages weavermessages format weaver messages weavermessages incorrect target declare annotation rtx get name getname to add toadd type stringify targets stringifytargets abits dec a deca get source location getsourcelocation dont lint weaving process factory get world getworld get lint getlint invalid target for annotation invalidtargetforannotation is enabled isenabled factory get world getworld get lint getlint invalid target for annotation invalidtargetforannotation signal string rtx get name getname to add toadd type to string tostring stringify targets stringifytargets abits dec a deca get source location getsourcelocation giveupnow giveupnow compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok the target type thetargettype add annotation addannotation annotation x annotationx fake annotation fakeannotation sig abits tag bits tagbits annotation runtime retention annotationruntimeretention factory get world getworld compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok annotation current annotations currentannotations source type sourcetype scope reference context referencecontext annotations current annotations currentannotations current annotations currentannotations length annotation annotation current annotations currentannotations string char operation charoperation to string tostring annotation type get type name gettypename string char operation charoperation to string tostring to add toadd type get type name gettypename multiple times loop equals compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok abits tag bits tagbits annotation target mask annotationtargetmask abits tag bits tagbits annotation for annotation type annotationforannotationtype tag bits tagbits annotation for type annotationfortype specifies annotation normal type error reported resolution process compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok source type sourcetype is annotation type isannotationtype abits tag bits tagbits annotation for annotation type annotationforannotationtype source type sourcetype is annotation type isannotationtype abits tag bits tagbits annotation for type annotationfortype report problems reportproblems dec a deca is exact pattern isexactpattern factory show message showmessage imessage error weaver messages weavermessages format weaver messages weavermessages incorrect target declare annotation rtx get name getname to add toadd type stringify targets stringifytargets abits dec a deca get source location getsourcelocation dont lint weaving process factory get world getworld get lint getlint invalid target for annotation invalidtargetforannotation is enabled isenabled factory get world getworld get lint getlint invalid target for annotation invalidtargetforannotation signal string rtx get name getname to add toadd type to string tostring stringify targets stringifytargets abits dec a deca get source location getsourcelocation compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok build array annotations remember current remember annotations rememberannotations time called type source type sourcetype scope reference context referencecontext remember annotations rememberannotations asm relationship provider asmrelationshipprovider get default getdefault add declare annotation relationship adddeclareannotationrelationship dec a deca get source location getsourcelocation rtx get source location getsourcelocation annotation abefore source type sourcetype scope reference context referencecontext annotations annotation newset annotation to add toadd length abefore abefore length system arraycopy to add toadd newset to add toadd length abefore system arraycopy abefore newset to add toadd length abefore length source type sourcetype scope reference context referencecontext annotations newset compilation and weaving context compilationandweavingcontext leaving phase leavingphase tok transform annotation form eclipse form dont care values annotation stuck type type completion constructs decps decas disk wont annotation weave time copying values annotation create annotation from bcel annotation createannotationfrombcelannotation annotation x annotationx ann x annx pos eclipse factory eclipsefactory factory string ann x annx get type name gettypename type binding typebinding factory make type binding maketypebinding ann x annx get signature getsignature type name typename char operation charoperation split on spliton to char array tochararray positions pos type reference typereference ann type anntype qualified type reference qualifiedtypereference type name typename positions normal annotation normalannotation ann normal annotation normalannotation ann type anntype pos yuck cases ann resolved type resolvedtype ann member value pairs membervaluepairs mvps ann is annotation targetting something other than annotation or normal isannotationtargettingsomethingotherthanannotationornormal abits abits tag bits tagbits annotation for annotation type annotationforannotationtype tag bits tagbits annotation for type annotationfortype report declare parents message reportdeclareparentsmessage weave message weavemessage weave message kind weavemessagekind wmk source type binding sourcetypebinding source type sourcetype resolved type resolvedtype parent factory get world getworld get message handler getmessagehandler is ignoring isignoring imessage weaveinfo string filename string source type sourcetype get file name getfilename takefrom filename last index of lastindexof takefrom takefrom filename last index of lastindexof filename filename substring takefrom factory get world getworld get message handler getmessagehandler handle message handlemessage weave message weavemessage construct weaving message constructweavingmessage wmk string char operation charoperation to string tostring source type sourcetype compound name compoundname filename parent get class name getclassname get shortname getshortname parent get source location getsourcelocation get source file getsourcefile get path getpath string get shortname getshortname string path takefrom path last index of lastindexof takefrom takefrom path last index of lastindexof path substring takefrom add parent addparent source type binding sourcetypebinding source type sourcetype resolved type resolvedtype parent reference binding referencebinding parent binding parentbinding reference binding referencebinding factory make type binding maketypebinding parent parent binding parentbinding source type sourcetype remember type hierarchy remembertypehierarchy parent binding parentbinding is class isclass source type sourcetype superclass parent binding parentbinding tag weaving message weavingmessage declare parents compiler restriction weave time message source compilation report declare parents message reportdeclareparentsmessage weave message weavemessage weavemessage declareparentsextends source type sourcetype parent reference binding referencebinding old i oldi source type sourcetype super interfaces superinterfaces reference binding referencebinding new i newi old i oldi new i newi reference binding referencebinding new i newi parent binding parentbinding old i oldi length new i newi reference binding referencebinding system arraycopy old i oldi new i newi new i newi parent binding parentbinding source type sourcetype super interfaces superinterfaces new i newi warn on added interface warnonaddedinterface factory from eclipse fromeclipse source type sourcetype parent reported weave time fixed decp weave time tag weaving message weavingmessage declare parents message bcel type munger bceltypemunger munge binary weave report declare parents message reportdeclareparentsmessage weave message weavemessage weavemessage declareparentsimplements source type sourcetype parent warn on added interface warnonaddedinterface resolved type resolvedtype type resolved type resolvedtype parent factory get world getworld resolved type resolvedtype serializable get core type getcoretype unresolved type unresolvedtype serializable serializable is assignable from isassignablefrom type serializable is assignable from isassignablefrom parent lazy class gen lazyclassgen has serial version uidfield hasserialversionuidfield type get lint getlint needs serial version uidfield needsserialversionuidfield signal string type get name getname to string tostring parent get name getname to string tostring list pending types to finish pendingtypestofinish array list arraylist in binary type creation and weaving inbinarytypecreationandweaving processing the queue processingthequeue binary type binding binarytypebinding create binary type from createbinarytypefrom ibinary type ibinarytype binary type binarytype package binding packagebinding package binding packagebinding need fields and methods needfieldsandmethods access restriction accessrestriction access restriction accessrestriction in binary type creation and weaving inbinarytypecreationandweaving binary type binding binarytypebinding ret create binary type from createbinarytypefrom binary type binarytype package binding packagebinding need fields and methods needfieldsandmethods access restriction accessrestriction pending types to finish pendingtypestofinish add ret ret in binary type creation and weaving inbinarytypecreationandweaving binary type binding binarytypebinding ret create binary type from createbinarytypefrom binary type binarytype package binding packagebinding need fields and methods needfieldsandmethods access restriction accessrestriction factory get world getworld validate type validatetype factory from binding frombinding ret bytes pass validate class file reader classfilereader binary type binarytype get reference bytes getreferencebytes weave inter type declarations weaveintertypedeclarations ret ret in binary type creation and weaving inbinarytypecreationandweaving start processing list pending types to finish pendingtypestofinish size processing the queue processingthequeue pending types to finish pendingtypestofinish is empty isempty binary type binding binarytypebinding next victim nextvictim binary type binding binarytypebinding pending types to finish pendingtypestofinish remove call recurse method add entries pending types to finish pendingtypestofinish list weave inter type declarations weaveintertypedeclarations next victim nextvictim processing the queue processingthequeue callback driven compiler detects anonymous type block resolution add weaver don trip param a binding abinding anonymous type binding created anonymoustypebindingcreated local type binding localtypebinding a binding abinding factory add source type binding addsourcetypebinding a binding abinding commented supplied info manipulate annotations eclipse do declare annotation on methods dodeclareannotationonmethods declare annotation fields methods ctors collection daoms factory get declare annotation on methods getdeclareannotationonmethods daoms daoms size source type sourcetype binary type binding binarytypebinding system err println methods source type sourcetype debug name debugname deca matches iterator iter daoms iterator iter has next hasnext declare annotation declareannotation element declare annotation declareannotation iter system err println match element source type sourcetype debug name debugname get type gettype source type sourcetype compound name compoundname debug name debugname source type sourcetype binary type binding binarytypebinding reference binding referencebinding rbb get type gettype source type sourcetype compound name compoundname uncomment code iterate methods decas source type sourcetype methods method binding methodbinding source mbs sourcembs source type sourcetype methods source mbs sourcembs length method binding methodbinding source mb sourcemb source mbs sourcembs method binding methodbinding mbbbb source type binding sourcetypebinding rbb get exact method getexactmethod source mb sourcemb selector source mb sourcemb parameters is ctor isctor source mb sourcemb selector element is declare at constuctor isdeclareatconstuctor is ctor isctor system err println checking source mb sourcemb declaringclass source mb sourcemb declaring class declaringclass debug name debugname rbb rbb debug name debugname source mb sourcemb declaring class declaringclass equals rbb resolved member resolvedmember eclipse factory eclipsefactory make resolved member makeresolvedmember mbbbb element matches factory get world getworld system err println match determine annotations method reference binding referencebinding get type gettype source type sourcetype compound name compoundname type binding typebinding factory make type binding maketypebinding dec a deca get aspect getaspect method binding methodbinding source type binding sourcetypebinding get exact method getexactmethod source mb sourcemb selector source mb sourcemb parameters abits mbs get annotation tag bits getannotationtagbits ensure resolved type declaration typedeclaration type decl typedecl source type binding sourcetypebinding source mb sourcemb declaring class declaringclass scope reference context referencecontext abstract method declaration abstractmethoddeclaration method decl methoddecl type decl typedecl declaration of declarationof source mb sourcemb annotation currently has currentlyhas method decl methoddecl annotations add abits to add toadd resolved type resolvedtype get annotation tag bits getannotationtagbits determine annotations add method type binding typebinding factory make type binding maketypebinding element get aspect getaspect method binding methodbinding aspect mbs aspectmbs source type binding sourcetypebinding get methods getmethods element get annotation method getannotationmethod to char array tochararray abits aspect mbs aspectmbs get annotation tag bits getannotationtagbits ensure resolved type declaration typedeclaration type decl typedecl source type binding sourcetypebinding aspect mbs aspectmbs declaring class declaringclass scope reference context referencecontext abstract method declaration abstractmethoddeclaration method decl methoddecl type decl typedecl declaration of declarationof aspect mbs aspectmbs annotation to add toadd method decl methoddecl annotations add abits to add toadd resolved type resolvedtype get annotation tag bits getannotationtagbits system err println currently has currentlyhas to add toadd to add toadd check annotation annotation abefore source type sourcetype scope reference context referencecontext annotations annotation newset annotation currently has currentlyhas currently has currentlyhas length system arraycopy to add toadd newset to add toadd length currently has currentlyhas system arraycopy currently has currentlyhas newset currently has currentlyhas length method decl methoddecl annotations newset system err println char operation charoperation char to string chartostring source mb sourcemb selector newset system err println match commented supplied info manipulate annotations eclipse do declare annotation on fields dodeclareannotationonfields collection daofs factory get declare annotation on fields getdeclareannotationonfields daofs daofs size source type sourcetype binary type binding binarytypebinding system err println fields source type sourcetype debug name debugname deca matches iterator iter daofs iterator iter has next hasnext declare annotation declareannotation element declare annotation declareannotation iter system err println processing deca element source type sourcetype debug name debugname get type gettype source type sourcetype compound name compoundname debug name debugname source type sourcetype binary type binding binarytypebinding reference binding referencebinding rbb get type gettype source type sourcetype compound name compoundname iterate methods decas source type sourcetype fields resolve bloody field binding fieldbinding source fbs sourcefbs source type sourcetype fields source fbs sourcefbs length field binding fieldbinding source fb sourcefb source fbs sourcefbs field binding fieldbinding fbbbb source type binding sourcetypebinding rbb getget exact method getgetexactmethod source mb sourcemb selector source mb sourcemb parameters system err println checking source fb sourcefb declaringclass source fb sourcefb declaring class declaringclass debug name debugname rbb rbb debug name debugname resolved member resolvedmember eclipse factory eclipsefactory make resolved member makeresolvedmember source fb sourcefb element matches factory get world getworld system err println match determine annotations field reference binding referencebinding get type gettype source type sourcetype compound name compoundname type binding typebinding factory make type binding maketypebinding dec a deca get aspect getaspect field binding fieldbinding source type binding sourcetypebinding get field getfield source fb sourcefb abits mbs get annotation tag bits getannotationtagbits ensure resolved type declaration typedeclaration type decl typedecl source type binding sourcetypebinding source fb sourcefb declaring class declaringclass scope reference context referencecontext field declaration fielddeclaration type decl typedecl declaration of declarationof source fb sourcefb abstract method declaration abstractmethoddeclaration method decl methoddecl type decl typedecl declaration of declarationof source mb sourcemb annotation currently has currentlyhas annotations add abits to add toadd resolved type resolvedtype get annotation tag bits getannotationtagbits determine annotations add method type binding typebinding factory make type binding maketypebinding element get aspect getaspect method binding methodbinding aspect mbs aspectmbs source type binding sourcetypebinding get methods getmethods element get annotation method getannotationmethod to char array tochararray abits aspect mbs aspectmbs get annotation tag bits getannotationtagbits ensure resolved type declaration typedeclaration type decl typedecl source type binding sourcetypebinding aspect mbs aspectmbs declaring class declaringclass scope reference context referencecontext abstract method declaration abstractmethoddeclaration method decl methoddecl type decl typedecl declaration of declarationof aspect mbs aspectmbs annotation to add toadd method decl methoddecl annotations add abits to add toadd resolved type resolvedtype get annotation tag bits getannotationtagbits system err println currently has currentlyhas to add toadd to add toadd check annotation annotation abefore source type sourcetype scope reference context referencecontext annotations annotation newset annotation currently has currentlyhas currently has currentlyhas length system arraycopy to add toadd newset to add toadd length currently has currentlyhas system arraycopy currently has currentlyhas newset currently has currentlyhas length annotations newset system err println char operation charoperation char to string chartostring source fb sourcefb newset system err println match