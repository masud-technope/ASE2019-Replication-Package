verbatim java xalan extensions supporting doc book docbook verbatim environments nwalsh xalan java util hashtable org xml sax org xml sax helpers attributes impl attributesimpl org dom org dom traversal node iterator nodeiterator javax xml transform transformer exception transformerexception org apache xpath objects xobject org apache xpath xpath context xpathcontext org apache xalan extensions expression context expressioncontext org apache xml utils dombuilder javax xml parsers document builder documentbuilder javax xml parsers document builder factory documentbuilderfactory javax xml parsers parser configuration exception parserconfigurationexception org apache xml utils qname org apache xpath domhelper org apache xml utils att list attlist xalan extensions supporting tables table java isberg exp copyright norman walsh href http xml apache org xalan xalan implementation code adjust cals tables html tables column widths adjust column widths adjustcolumnwidths method takes result tree fragment assumed colgroup html table returns result tree fragment column widths adjusted html terms convert lengths convert length convertlength method takes length specification form unit returns length integral number pixels convenience percentage lengths returned unchanged recognized units inches centimeters millimeters picas points pixels number units assumed pixels change log initial release author norman walsh href mailto ndw nwalsh ndw nwalsh version table java isberg exp table number pixels inch pixels per inch pixelsperinch hash associate units length pixels hashtable unit hash unithash namespace string fo uri fouri http org xsl format constructor verbatim methods constructor table initialize internal hash table proper values initialize hash initializehash unit hash unithash hashtable unit hash unithash pixels per inch pixelsperinch unit hash unithash pixels per inch pixelsperinch unit hash unithash pixels per inch pixelsperinch unit hash unithash pixels per inch pixelsperinch unit hash unithash pixels per inch pixelsperinch unit hash unithash pixels inch positive values legal set pixels per inch setpixelsperinch pixels per inch pixelsperinch initialize hash initializehash current pixels inch get pixels per inch getpixelsperinch pixels per inch pixelsperinch convert length specification number pixels length form valid unit convert length convertlength string length format length sign string digits string units lench length to char array tochararray flength pos factor pixels unit hash unithash initialize hash initializehash lench pos lench pos lench pos sign pos pos lench length lench pos lench pos lench pos units length substring pos digits lench pos flength parse float parsefloat digits number format exception numberformatexception system println digits number flength units equals unit hash unithash units system println units unit factor factor float value floatvalue factor flength factor pixels int value intvalue sign pixels adjust column widths html table specification column widths cals relative width optional absolute width incompatible html column widths method adjusts cals column width specifiers attempt produce equivalent html specifiers order method work cals width specifications width attribute col colgroup colgroup result tree fragment passed method method parameters xsl stylesheet calls code nominal table width code code table width code code nominal table width code absolute distance code table width code absolute relative presented mixture relative absolute lengths table width calculate values code table width code relative nominal width calculation combinations values relative widths absolute widths html table absolute widths relative widths html table mixture absolute relative widths table width absolute widths absolute table width relative widths absolute relative nominal table width turn relative widths param context stylesheet context supplied automatically xalan param rtf result tree fragment colgroup result tree fragment adjusted colgroup document fragment documentfragment adjust column widths adjustcolumnwidths expression context expressioncontext context node iterator nodeiterator xalan ni xalanni nominal width nominalwidth convert length convertlength params get string getstring context nominal table width string table width tablewidth params get string getstring context table width string style type styletype params get string getstring context stylesheet result type fo stylesheet fostylesheet style type styletype equals document fragment documentfragment xalan rtf xalanrtf document fragment documentfragment xalan ni xalanni next node nextnode element colgroup element xalan rtf xalanrtf get first child getfirstchild stree element impl elementimpl doesn implement get elements by tag name getelementsbytagname node first col firstcol tree colgroup colgroup get local name getlocalname equals colgroup first col firstcol colgroup get first child getfirstchild first col firstcol colgroup count number columns node child first col firstcol num columns numcolumns child child get node type getnodetype node element node child get node name getnodename equals col child get namespace uri getnamespaceuri equals fo uri fouri child get local name getlocalname equals table column num columns numcolumns child child get next sibling getnextsibling string widths string num columns numcolumns element columns element num columns numcolumns colnum child first col firstcol child child get node type getnodetype node element node child get node name getnodename equals col child get namespace uri getnamespaceuri equals fo uri fouri child get local name getlocalname equals table column element col element child columns colnum col fo stylesheet fostylesheet col get attribute getattribute column width widths colnum widths colnum col get attribute getattribute column width col get attribute getattribute width widths colnum widths colnum col get attribute getattribute width colnum child child get next sibling getnextsibling rel total reltotal rel parts relparts num columns numcolumns abs total abstotal abs parts absparts num columns numcolumns count count num columns numcolumns count string width widths count pos width index of indexof pos string rel part relpart width substring pos string abs part abspart width substring pos rel parse float parsefloat rel part relpart rel total reltotal rel rel parts relparts count rel number format exception numberformatexception system println rel part relpart valid relative unit pixels abs part abspart abs part abspart equals pixels convert length convertlength abs part abspart abs total abstotal pixels abs parts absparts count pixels rel parts relparts count pixels width width equals pixels convert length convertlength width abs total abstotal pixels abs parts absparts count pixels rel total reltotal count count num columns numcolumns count abs parts absparts count fo stylesheet fostylesheet pixels int value intvalue inches pixels pixels per inch pixelsperinch widths count inches widths count integer to string tostring int value intvalue abs total abstotal count count num columns numcolumns count rel rel parts relparts count rel total reltotal rel widths count integer to string tostring int value intvalue pixel width pixelwidth nominal width nominalwidth table width tablewidth index of indexof pixel width pixelwidth convert length convertlength table width tablewidth pixel width pixelwidth abs total abstotal system println table wider table width pixel width pixelwidth abs total abstotal abs total abstotal count count num columns numcolumns count rel rel parts relparts count rel total reltotal pixel width pixelwidth rel parts relparts count rel abs parts absparts count abs total abstotal rel abs parts absparts count table width tablewidth index of indexof count count num columns numcolumns count rel parts relparts count fo stylesheet fostylesheet pixels int value intvalue inches pixels pixels per inch pixelsperinch widths count inches widths count integer to string tostring int value intvalue count count num columns numcolumns count rel rel parts relparts count abs total abstotal rel widths count integer to string tostring int value intvalue rebuild colgroup widths document builder factory documentbuilderfactory doc factory docfactory document builder factory documentbuilderfactory new instance newinstance document builder documentbuilder doc builder docbuilder doc builder docbuilder doc factory docfactory new document builder newdocumentbuilder parser configuration exception parserconfigurationexception system println pce xalan rtf xalanrtf document doc doc builder docbuilder new document newdocument document fragment documentfragment doc create document fragment createdocumentfragment dombuilder rtf dombuilder doc string colgroup get namespace uri getnamespaceuri string local name localname colgroup get local name getlocalname string colgroup get tag name gettagname colgroup get local name getlocalname equals colgroup rtf start element startelement local name localname copy attributes copyattributes colgroup colnum colnum num columns numcolumns colnum element col columns colnum named node map namednodemap dom attr domattr col get attributes getattributes attributes impl attributesimpl attr attributes impl attributesimpl acount acount dom attr domattr get length getlength acount node dom attr domattr item acount string get namespace uri getnamespaceuri string local name localname get local name getlocalname fo stylesheet fostylesheet local name localname equals column width local name localname equals ignore case equalsignorecase width attr add attribute addattribute get namespace uri getnamespaceuri get local name getlocalname get node name getnodename cdata get node value getnodevalue fo stylesheet fostylesheet attr add attribute addattribute column width column width cdata widths colnum attr add attribute addattribute width width cdata widths colnum rtf start element startelement col get namespace uri getnamespaceuri col get local name getlocalname col get tag name gettagname attr rtf end element endelement col get namespace uri getnamespaceuri col get local name getlocalname col get tag name gettagname colgroup get local name getlocalname equals colgroup rtf end element endelement local name localname saxexception system println xalan rtf xalanrtf attributes copy attributes copyattributes element node attributes impl attributesimpl attrs attributes impl attributesimpl named node map namednodemap nnm node get attributes getattributes count count nnm get length getlength count attr attr attr nnm item count string attr get name getname starts with startswith xmlns equals xmlns skip don love attrs add attribute addattribute attr get namespace uri getnamespaceuri attr get name getname attr get name getname cdata attr get value getvalue attrs