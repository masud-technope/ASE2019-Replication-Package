org aspectj apache bcel verifier structurals org aspectj apache bcel constants org aspectj apache bcel classfile constant org aspectj apache bcel classfile constant double constantdouble org aspectj apache bcel classfile constant float constantfloat org aspectj apache bcel classfile constant integer constantinteger org aspectj apache bcel classfile constant long constantlong org aspectj apache bcel classfile constant string constantstring org aspectj apache bcel visitor type based java virtual machine simulation check correct types operand stack operandstack local variables localvariables check sizes big visitor bytecode verifying externally type constraints java virtual machine instructions satisfied inst constraint visitor instconstraintvisitor visitor mandate visit iadd visitiadd iadd stack slots popped stack slot type pushed pop slot type top stack monitor specific behaviour simulated conventions type pushed stack type type stack slots high represented simple single type type object stack slot type stored local variable variable type type unknown version execution visitor executionvisitor java aclement exp author href http inf berlin ehaase enver haase visit dstore visitdstore dstore inst constraint visitor instconstraintvisitor execution visitor executionvisitor empty visitor emptyvisitor visitor executionframe operating frame frame constant pool gen constantpoolgen working set constant pool gen setconstantpoolgen constant pool gen constantpoolgen constant pool gen constantpoolgen cpg constructor constructs instance execution visitor executionvisitor operand stack operandstack current frame operating set frame setframe frame operand stack operandstack stack frame get stack getstack local variables localvariables current frame operating set frame setframe frame local variables localvariables locals frame get locals getlocals sets constant pool gen constantpoolgen needed symbolic execution set constant pool gen setconstantpoolgen constant pool gen constantpoolgen cpg cpg cpg method granting access single instance execution visitor executionvisitor actively instance constant pool gen constantpoolgen set constant pool gen setconstantpoolgen constant pool gen constantpoolgen set frame setframe frame frame symbolically executes java virtual machine instruction visit wide visitwide wide wide instruction modelled flag embedded instructions bcel bcel checks errors parsing file don possibilty care wide symbolically executes java virtual machine instruction visit aaload visitaaload aaload pop stack pop system print stack peek pop array type type stack pop type stack push type stackwise null pointer exception nullpointerexception thrown time array type arraytype array type arraytype stack push get element type getelementtype symbolically executes java virtual machine instruction visit aastore visitaastore aastore stack pop stack pop stack pop symbolically executes java virtual machine instruction visit aconst visitaconst aconst stack push type symbolically executes java virtual machine instruction visit aload visitaload aload stack push locals get index getindex symbolically executes java virtual machine instruction visit anewarray visitanewarray anewarray count stack pop stack push array type arraytype get type gettype cpg symbolically executes java virtual machine instruction visit areturn visitareturn areturn stack pop symbolically executes java virtual machine instruction visit arraylength visitarraylength arraylength stack pop stack push type symbolically executes java virtual machine instruction visit astore visitastore astore locals get index getindex stack pop system err println todo debug get index getindex locals get index getindex symbolically executes java virtual machine instruction visit athrow visitathrow athrow type stack pop stack clear equals type stack push type get type gettype ljava lang null pointer exception nullpointerexception stack push symbolically executes java virtual machine instruction visit baload visitbaload baload stack pop stack pop stack push type symbolically executes java virtual machine instruction visit bastore visitbastore bastore stack pop stack pop stack pop symbolically executes java virtual machine instruction visit bipush visitbipush bipush stack push type symbolically executes java virtual machine instruction visit caload visitcaload caload stack pop stack pop stack push type symbolically executes java virtual machine instruction visit castore visitcastore castore stack pop stack pop stack pop symbolically executes java virtual machine instruction visit checkcast visitcheckcast checkcast wrong sun byte code bytecode verifier todo sophisticated analysis check type cated predict class cast exception classcastexception time stack pop stack push get type gettype cpg symbolically executes java virtual machine instruction visit d visitd stack pop stack push type symbolically executes java virtual machine instruction visit d visitd stack pop stack push type symbolically executes java virtual machine instruction visit d visitd stack pop stack push type symbolically executes java virtual machine instruction visit dadd visitdadd dadd stack pop stack pop stack push type symbolically executes java virtual machine instruction visit daload visitdaload daload stack pop stack pop stack push type symbolically executes java virtual machine instruction visit dastore visitdastore dastore stack pop stack pop stack pop symbolically executes java virtual machine instruction visit dcmpg visitdcmpg dcmpg stack pop stack pop stack push type symbolically executes java virtual machine instruction visit dcmpl visitdcmpl dcmpl stack pop stack pop stack push type symbolically executes java virtual machine instruction visit dconst visitdconst dconst stack push type symbolically executes java virtual machine instruction visit ddiv visitddiv ddiv stack pop stack pop stack push type symbolically executes java virtual machine instruction visit dload visitdload dload stack push type symbolically executes java virtual machine instruction visit dmul visitdmul dmul stack pop stack pop stack push type symbolically executes java virtual machine instruction visit dneg visitdneg dneg stack pop stack push type symbolically executes java virtual machine instruction visit drem visitdrem drem stack pop stack pop stack push type symbolically executes java virtual machine instruction visit dreturn visitdreturn dreturn stack pop symbolically executes java virtual machine instruction visit dstore visitdstore dstore locals get index getindex stack pop locals get index getindex type unknown symbolically executes java virtual machine instruction visit dsub visitdsub dsub stack pop stack pop stack push type symbolically executes java virtual machine instruction visit dup visitdup dup type stack pop stack push stack push symbolically executes java virtual machine instruction visit dup visitdup dup type stack pop type stack pop stack push stack push stack push symbolically executes java virtual machine instruction visit dup visitdup dup type stack pop type stack pop get size getsize stack push stack push stack push type stack pop stack push stack push stack push stack push symbolically executes java virtual machine instruction visit dup visitdup dup type stack pop get size getsize stack push stack push get size getsize type stack pop stack push stack push stack push stack push symbolically executes java virtual machine instruction visit dup visitdup dup type stack pop get size getsize type stack pop stack push stack push stack push get size getsize type stack pop type stack pop stack push stack push stack push stack push stack push symbolically executes java virtual machine instruction visit dup visitdup dup type stack pop get size getsize type stack pop get size getsize stack push stack push stack push type stack pop stack push stack push stack push stack push get size getsize type stack pop type stack pop get size getsize stack push stack push stack push stack push stack push type stack pop stack push stack push stack push stack push stack push stack push symbolically executes java virtual machine instruction visit f visitf stack pop stack push type symbolically executes java virtual machine instruction visit f visitf stack pop stack push type symbolically executes java virtual machine instruction visit f visitf stack pop stack push type symbolically executes java virtual machine instruction visit fadd visitfadd fadd stack pop stack pop stack push type symbolically executes java virtual machine instruction visit faload visitfaload faload stack pop stack pop stack push type symbolically executes java virtual machine instruction visit fastore visitfastore fastore stack pop stack pop stack pop symbolically executes java virtual machine instruction visit fcmpg visitfcmpg fcmpg stack pop stack pop stack push type symbolically executes java virtual machine instruction visit fcmpl visitfcmpl fcmpl stack pop stack pop stack push type symbolically executes java virtual machine instruction visit fconst visitfconst fconst stack push type symbolically executes java virtual machine instruction visit fdiv visitfdiv fdiv stack pop stack pop stack push type symbolically executes java virtual machine instruction visit fload visitfload fload stack push type symbolically executes java virtual machine instruction visit fmul visitfmul fmul stack pop stack pop stack push type symbolically executes java virtual machine instruction visit fneg visitfneg fneg stack pop stack push type symbolically executes java virtual machine instruction visit frem visitfrem frem stack pop stack pop stack push type symbolically executes java virtual machine instruction visit freturn visitfreturn freturn stack pop symbolically executes java virtual machine instruction visit fstore visitfstore fstore locals get index getindex stack pop symbolically executes java virtual machine instruction visit fsub visitfsub fsub stack pop stack pop stack push type symbolically executes java virtual machine instruction visit getfield visitgetfield getfield stack pop type get field type getfieldtype cpg equals type equals type equals type equals type type stack push symbolically executes java virtual machine instruction visit getstatic visitgetstatic getstatic type get field type getfieldtype cpg equals type equals type equals type equals type type stack push symbolically executes java virtual machine instruction visit goto visitgoto stack symbolically executes java virtual machine instruction visit goto visitgoto stack symbolically executes java virtual machine instruction visit i visiti stack pop stack push type symbolically executes java virtual machine instruction visit i visiti stack pop stack push type symbolically executes java virtual machine instruction visit i visiti stack pop stack push type symbolically executes java virtual machine instruction visit i visiti stack pop stack push type symbolically executes java virtual machine instruction visit i visiti stack pop stack push type symbolically executes java virtual machine instruction visit i visiti stack pop stack push type symbolically executes java virtual machine instruction visit iadd visitiadd iadd stack pop stack pop stack push type symbolically executes java virtual machine instruction visit iaload visitiaload iaload stack pop stack pop stack push type symbolically executes java virtual machine instruction visit iand visitiand iand stack pop stack pop stack push type symbolically executes java virtual machine instruction visit iastore visitiastore iastore stack pop stack pop stack pop symbolically executes java virtual machine instruction visit iconst visiticonst iconst stack push type symbolically executes java virtual machine instruction visit idiv visitidiv idiv stack pop stack pop stack push type symbolically executes java virtual machine instruction visit if visitif acmpeq acmpeq stack pop stack pop symbolically executes java virtual machine instruction visit if visitif acmpne acmpne stack pop stack pop symbolically executes java virtual machine instruction visit if visitif icmpeq icmpeq stack pop stack pop symbolically executes java virtual machine instruction visit if visitif icmpge icmpge stack pop stack pop symbolically executes java virtual machine instruction visit if visitif icmpgt icmpgt stack pop stack pop symbolically executes java virtual machine instruction visit if visitif icmple icmple stack pop stack pop symbolically executes java virtual machine instruction visit if visitif icmplt icmplt stack pop stack pop symbolically executes java virtual machine instruction visit if visitif icmpne icmpne stack pop stack pop symbolically executes java virtual machine instruction visit ifeq visitifeq ifeq stack pop symbolically executes java virtual machine instruction visit ifge visitifge ifge stack pop symbolically executes java virtual machine instruction visit ifgt visitifgt ifgt stack pop symbolically executes java virtual machine instruction visit ifle visitifle ifle stack pop symbolically executes java virtual machine instruction visit iflt visitiflt iflt stack pop symbolically executes java virtual machine instruction visit ifne visitifne ifne stack pop symbolically executes java virtual machine instruction visit ifnonnull visitifnonnull ifnonnull stack pop symbolically executes java virtual machine instruction visit ifnull visitifnull ifnull stack pop symbolically executes java virtual machine instruction visit iinc visitiinc iinc stack changed symbolically executes java virtual machine instruction visit iload visitiload iload stack push type symbolically executes java virtual machine instruction visit imul visitimul imul stack pop stack pop stack push type symbolically executes java virtual machine instruction visit ineg visitineg ineg stack pop stack push type symbolically executes java virtual machine instruction visit instanceof visitinstanceof stack pop stack push type symbolically executes java virtual machine instruction visit invokeinterface visitinvokeinterface invokeinterface objectref stack pop get argument types getargumenttypes cpg length stack pop method get return type getreturntype cpg type type get return type getreturntype cpg equals type equals type equals type equals type type stack push symbolically executes java virtual machine instruction visit invokespecial visitinvokespecial invokespecial get method name getmethodname cpg equals constants constructor uninitialized object type uninitializedobjecttype uninitialized object type uninitializedobjecttype stack peek get argument types getargumenttypes cpg length frame frame stack initialize object initializeobject locals initialize object initializeobject objectref stack pop get argument types getargumenttypes cpg length stack pop method get return type getreturntype cpg type type get return type getreturntype cpg equals type equals type equals type equals type type stack push symbolically executes java virtual machine instruction visit invokestatic visitinvokestatic invokestatic get argument types getargumenttypes cpg length stack pop method get return type getreturntype cpg type type get return type getreturntype cpg equals type equals type equals type equals type type stack push symbolically executes java virtual machine instruction visit invokevirtual visitinvokevirtual invokevirtual objectref stack pop get argument types getargumenttypes cpg length stack pop method get return type getreturntype cpg type type get return type getreturntype cpg equals type equals type equals type equals type type stack push symbolically executes java virtual machine instruction visit ior visitior ior stack pop stack pop stack push type symbolically executes java virtual machine instruction visit irem visitirem irem stack pop stack pop stack push type symbolically executes java virtual machine instruction visit ireturn visitireturn ireturn stack pop symbolically executes java virtual machine instruction visit ishl visitishl ishl stack pop stack pop stack push type symbolically executes java virtual machine instruction visit ishr visitishr ishr stack pop stack pop stack push type symbolically executes java virtual machine instruction visit istore visitistore istore locals get index getindex stack pop symbolically executes java virtual machine instruction visit isub visitisub isub stack pop stack pop stack push type symbolically executes java virtual machine instruction visit iushr visitiushr iushr stack pop stack pop stack push type symbolically executes java virtual machine instruction visit ixor visitixor ixor stack pop stack pop stack push type symbolically executes java virtual machine instruction visit jsr visitjsr jsr stack push returnaddress type returnaddresstype physical successor physicalsuccessor system err println todo physical successor physicalsuccessor symbolically executes java virtual machine instruction visit jsr visitjsr jsr stack push returnaddress type returnaddresstype physical successor physicalsuccessor symbolically executes java virtual machine instruction visit l visitl stack pop stack push type symbolically executes java virtual machine instruction visit l visitl stack pop stack push type symbolically executes java virtual machine instruction visit l visitl stack pop stack push type symbolically executes java virtual machine instruction visit ladd visitladd ladd stack pop stack pop stack push type symbolically executes java virtual machine instruction visit laload visitlaload laload stack pop stack pop stack push type symbolically executes java virtual machine instruction visit land visitland land stack pop stack pop stack push type symbolically executes java virtual machine instruction visit lastore visitlastore lastore stack pop stack pop stack pop symbolically executes java virtual machine instruction visit lcmp visitlcmp lcmp stack pop stack pop stack push type symbolically executes java virtual machine instruction visit lconst visitlconst lconst stack push type symbolically executes java virtual machine instruction visit ldc visitldc ldc constant cpg get constant getconstant get index getindex constant integer constantinteger stack push type constant float constantfloat stack push type constant string constantstring stack push type string symbolically executes java virtual machine instruction visit ldc visitldc ldc constant cpg get constant getconstant get index getindex constant integer constantinteger stack push type constant float constantfloat stack push type constant string constantstring stack push type string symbolically executes java virtual machine instruction visit ldc visitldc ldc constant cpg get constant getconstant get index getindex constant long constantlong stack push type constant double constantdouble stack push type symbolically executes java virtual machine instruction visit ldiv visitldiv ldiv stack pop stack pop stack push type symbolically executes java virtual machine instruction visit lload visitlload lload stack push locals get index getindex symbolically executes java virtual machine instruction visit lmul visitlmul lmul stack pop stack pop stack push type symbolically executes java virtual machine instruction visit lneg visitlneg lneg stack pop stack push type symbolically executes java virtual machine instruction visit lookupswitch visitlookupswitch lookupswitch key stack pop symbolically executes java virtual machine instruction visit lor visitlor lor stack pop stack pop stack push type symbolically executes java virtual machine instruction visit lrem visitlrem lrem stack pop stack pop stack push type symbolically executes java virtual machine instruction visit lreturn visitlreturn lreturn stack pop symbolically executes java virtual machine instruction visit lshl visitlshl lshl stack pop stack pop stack push type symbolically executes java virtual machine instruction visit lshr visitlshr lshr stack pop stack pop stack push type symbolically executes java virtual machine instruction visit lstore visitlstore lstore locals get index getindex stack pop locals get index getindex type unknown symbolically executes java virtual machine instruction visit lsub visitlsub lsub stack pop stack pop stack push type symbolically executes java virtual machine instruction visit lushr visitlushr lushr stack pop stack pop stack push type symbolically executes java virtual machine instruction visit lxor visitlxor lxor stack pop stack pop stack push type symbolically executes java virtual machine instruction visit monitorenter visitmonitorenter monitorenter stack pop symbolically executes java virtual machine instruction visit monitorexit visitmonitorexit monitorexit stack pop symbolically executes java virtual machine instruction visit multianewarray visitmultianewarray multianewarray get dimensions getdimensions stack pop stack push get type gettype cpg symbolically executes java virtual machine instruction visit new visitnew stack push uninitialized object type uninitializedobjecttype object type objecttype get type gettype cpg symbolically executes java virtual machine instruction visit newarray visitnewarray newarray stack pop stack push get type gettype symbolically executes java virtual machine instruction visit nop visitnop nop symbolically executes java virtual machine instruction visit pop visitpop pop stack pop symbolically executes java virtual machine instruction visit pop visitpop pop type stack pop get size getsize stack pop symbolically executes java virtual machine instruction visit putfield visitputfield putfield stack pop stack pop symbolically executes java virtual machine instruction visit putstatic visitputstatic putstatic stack pop symbolically executes java virtual machine instruction visit ret visitret ret address local variables symbolically executes java virtual machine instruction visit return visitreturn symbolically executes java virtual machine instruction visit saload visitsaload saload stack pop stack pop stack push type symbolically executes java virtual machine instruction visit sastore visitsastore sastore stack pop stack pop stack pop symbolically executes java virtual machine instruction visit sipush visitsipush sipush stack push type symbolically executes java virtual machine instruction visit swap visitswap swap type stack pop type stack pop stack push stack push symbolically executes java virtual machine instruction visit tableswitch visittableswitch tableswitch stack pop