org aspectj apache bcel util java util org aspectj apache bcel constants org aspectj apache bcel org apache regexp instruction finder instructionfinder tool search instructions patterns match sequences instructions instruction list regular expressions order implement peep hole optimizer code patterns replaces faster equivalents internally href http jakarta apache org regexp regexp search regular expressions typical application pre instruction finder instructionfinder instruction finder instructionfinder string pat if instruction ifinstruction iconst iconst nop ifeq ifne iterator search pat constraint has next hasnext instruction handle instructionhandle match instruction handle instructionhandle delete match match pre version instruction finder instructionfinder java aclement exp author href http berlin markus dahm dahm instruction instruction list instructionlist instruction finder instructionfinder offset latin offset potential number opcodes map string pattern hash map hashmap map hash map hashmap instruction list instructionlist instruction list string string string map instruction list array instruction handle instructionhandle handles param instruction list search patterns instruction finder instructionfinder instruction list instructionlist reread reread instruction list altered list match reread size get length getlength create string length equal length buf size handles get instruction handles getinstructionhandles map opcodes characters size buf make char makechar handles get instruction getinstruction get opcode getopcode string string buf map symbolic instruction names getfield single character param pattern instruction pattern encoded string pattern branch instruction branchinstruction string map name mapname string pattern string result string map pattern result result opcodes pattern equals constants opcode names make char makechar runtime exception runtimeexception instruction unknown pattern replace symbolic names instructions appropiate character remove white space string meta characters param pattern pattern compile translated regular expression string string compile pattern compilepattern string pattern string pattern to lower case tolowercase string buffer stringbuffer buf string buffer stringbuffer size pattern length size char at charat character is letter or digit isletterordigit string buffer stringbuffer string buffer stringbuffer character is letter or digit isletterordigit size append size char at charat buf append map name mapname to string tostring character is whitespace iswhitespace buf append buf to string tostring matched piece code array instruction handles instruction handle instructionhandle get match getmatch matched match length instruction handle instructionhandle match instruction handle instructionhandle match length system arraycopy handles matched match match length match search pattern instruction list search valid opcode symbolic istore match instructions branch instruction branchinstruction load instruction loadinstruction istore alias istore instructions additional aliases ifxx icmp icmpxx acmp acmpxx consecutive instruction names separated white space removed compilation pattern usual pattern matching rules regular expressions apply pattern pre search branch instruction branchinstruction nop if instruction ifinstruction istore instruction pre alter instruction list match matching areas call reread update finder call search matches cached param pattern instruction pattern search param start search instruction list param constraint optional code constraint codeconstraint check code pattern user defined constraints iterator matches next element nextelement returns array instruction handles describing matched area iterator search string pattern instruction handle instructionhandle code constraint codeconstraint constraint string search compile pattern compilepattern pattern start handles length handles start search start start class gen exception classgenexception instruction handle instruction list regex search array list arraylist matches array list arraylist start string length regex match string start start expr startexpr regex get paren start getparenstart end expr endexpr regex get paren end getparenend len expr lenexpr regex get paren length getparenlength instruction handle instructionhandle match get match getmatch start expr startexpr len expr lenexpr constraint constraint check code checkcode match matches add match start end expr endexpr matches iterator resyntax exception resyntaxexception system err println start search start instruction list param pattern instruction pattern search iterator matches next element nextelement returns array instruction handles describing matched area iterator search string pattern search pattern get start getstart start search param pattern instruction pattern search param start search instruction list iterator matches next element nextelement returns array instruction handles describing matched area iterator search string pattern instruction handle instructionhandle search pattern start search start instruction list check matches constraint object param pattern instruction pattern search param constraint constraints checked matching code instruction handle match failed iterator search string pattern code constraint codeconstraint constraint search pattern get start getstart constraint convert opcode number make char makechar opcode opcode offset inquired instruction list instruction list instructionlist get instruction list getinstructionlist code patterns checked additional user defined constraint object match needed criterion check constraints expressed regular expressions code constraint codeconstraint param match array instructions matching requested pattern matched area check code checkcode instruction handle instructionhandle match map arithmeticinstruction irem lrem iand ior ineg isub lneg fneg fmul ldiv fadd lxor frem idiv land ixor ishr fsub lshl fdiv iadd lor dmul lsub ishl imul lmul lushr dneg iushr lshr ddiv drem dadd ladd dsub map invokeinstruction invokevirtual invokeinterface invokestatic invokespecial map arrayinstruction baload aastore saload caload fastore lastore iaload castore iastore aaload bastore sastore faload laload daload dastore map gotoinstruction map conversioninstruction map localvariableinstruction fstore iinc lload dstore dload iload aload astore istore fload lstore map loadinstruction fload dload lload iload aload map fieldinstruction getfield putstatic getstatic putfield map cpinstruction ldc invokeinterface multianewarray putstatic getstatic checkcast getfield invokespecial ldc invokestatic invokevirtual putfield ldc anewarray map stackinstruction dup swap dup pop pop dup dup dup dup map branchinstruction ifle acmpne icmpeq acmpeq ifnonnull iflt ifnull icmpne tableswitch icmple ifeq icmplt jsr icmpgt ifgt jsr ifne ifge lookupswitch icmpge map returninstruction lreturn ireturn freturn dreturn areturn map storeinstruction istore fstore dstore astore lstore map select tableswitch lookupswitch map ifinstruction ifeq ifgt icmpne icmpeq ifge ifnull ifne icmple icmpge acmpeq icmplt acmpne ifnonnull iflt icmpgt ifle map jsrinstruction jsr jsr map variablelengthinstruction tableswitch jsr lookupswitch map unconditionalbranch jsr jsr athrow map constantpushinstruction dconst bipush sipush fconst iconst lconst map typedinstruction imul lsub aload fload lor aaload fcmpg iand iaload lrem idiv isub dcmpg dastore ret drem iinc checkcast frem lreturn astore lushr daload dneg fastore istore lshl ldiv lstore areturn ishr ldc invokeinterface aastore lxor ishl faload sipush iushr caload invokespecial putfield fmul ireturn laload lneg ixor fdiv lastore multianewarray getstatic putstatic fcmpl saload ladd irem dload jsr dconst dcmpl fsub freturn ldc aconst castore lmul ldc dadd iconst ddiv dstore land jsr anewarray dmul bipush dsub sastore lshr iadd lload bastore fstore fneg iload fadd baload fconst ior ineg dreturn lconst getfield invokevirtual invokestatic iastore map popinstruction fstore dstore pop pop astore putstatic istore lstore map allocationinstruction multianewarray anewarray newarray map indexedinstruction lload lstore fload ldc invokeinterface multianewarray astore dload putstatic getstatic checkcast getfield invokespecial dstore istore iinc ldc ret fstore invokestatic iload putfield invokevirtual ldc aload anewarray map pushinstruction dup lload dup bipush fload ldc sipush lconst fconst dload getstatic ldc aconst dconst iload ldc iconst aload map stackproducer imul lsub aload fload lor aaload fcmpg iand iaload lrem idiv isub dcmpg dup drem checkcast frem lushr daload dneg lshl ldiv ishr ldc invokeinterface lxor ishl faload sipush iushr caload invokespecial fmul laload lneg ixor fdiv getstatic swap dup fcmpl saload ladd irem dload jsr dconst dcmpl fsub ldc arraylength aconst tableswitch lmul ldc iconst dadd ddiv land jsr anewarray dmul bipush dsub newarray lshr iadd lload fneg iload fadd baload fconst lookupswitch ior ineg lconst getfield invokevirtual invokestatic map stackconsumer imul lsub lor iflt fcmpg icmpgt iand ifeq icmplt lrem ifnonnull idiv isub dcmpg dastore icmpeq drem checkcast frem lreturn astore lushr pop monitorexit dneg fastore istore lshl ldiv lstore areturn icmpge ishr monitorenter invokeinterface aastore lxor ishl iushr invokespecial fmul ireturn lneg ixor pop ifnull fdiv lastore acmpeq ifge swap putstatic fcmpl ladd irem dcmpl fsub freturn ifgt castore lmul dadd ddiv dstore land icmpne acmpne dmul dsub sastore ifle lshr iadd bastore fstore fneg fadd ior ineg ifne dreturn icmple getfield invokevirtual invokestatic iastore map exceptionthrower irem lrem laload putstatic baload dastore areturn getstatic ldiv anewarray iastore castore idiv saload lastore fastore putfield lreturn caload getfield aastore freturn newarray multianewarray athrow faload iaload aaload dreturn monitorenter checkcast bastore arraylength invokevirtual sastore ldc ireturn invokespecial monitorexit invokeinterface ldc invokestatic daload map loadclass multianewarray invokeinterface invokespecial putfield checkcast putstatic invokevirtual getstatic invokestatic getfield anewarray map instructiontargeter ifle acmpne icmpeq acmpeq ifnonnull iflt ifnull icmpne tableswitch icmple ifeq icmplt jsr icmpgt ifgt jsr ifne ifge lookupswitch icmpge aliases map icmp icmpne icmpeq icmple icmpge icmplt icmpgt map acmp acmpeq acmpne map ifeq ifne iflt ifge ifgt ifle precompile aliases map iconst precompile constants iconst constants iconst constants iconst map lconst string make char makechar constants lconst make char makechar constants lconst map dconst string make char makechar constants dconst make char makechar constants dconst map fconst string make char makechar constants fconst make char makechar constants fconst map iload precompile constants iload constants iload constants iload map dload precompile constants dload constants dload constants dload map fload precompile constants fload constants fload constants fload map aload precompile constants aload constants aload constants aload map istore precompile constants istore constants istore constants istore map dstore precompile constants dstore constants dstore constants dstore map fstore precompile constants fstore constants fstore constants fstore map astore precompile constants astore constants astore constants astore iterator map key set keyset iterator has next hasnext string key string string string map key omit precompiled patterns char at charat offset precompile patterns map key compile pattern compilepattern add instruction alias match string buffer stringbuffer buf string buffer stringbuffer opcodes constants operands constants undefined invalid opcode buf append make char makechar opcodes buf append buf append map instruction buf to string tostring string precompile extra string buffer stringbuffer buf string buffer stringbuffer buf append make char makechar buf append buf append make char makechar extra buf append buf to string tostring internal debugging routines string pattern string string pattern pattern string pattern string pattern string string pattern string string buffer stringbuffer buf string buffer stringbuffer pattern length pattern char at charat offset string buf append constants opcode names offset buf append offset buf append buf to string tostring