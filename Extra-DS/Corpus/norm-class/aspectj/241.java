copyright contributors rights reserved program accompanying materials terms common license accompanies distribution http eclipse org legal cpl html contributors wes isberg initial implementation org aspectj testing taskdefs java file java util array list arraylist org aspectj bridge org aspectj bridge message handler messagehandler org aspectj testing harness bridge globals org aspectj util org aspectj util lang util langutil junit framework test case testcase test ajc task compile command ajctaskcompilecommand adapter assumes peer directory taskdefs module target files ajc task compile command test ajctaskcompilecommandtest test case testcase logged warning loggedwarning run all tests runalltests array list arraylist temp files tempfiles array list arraylist file get classes dir getclassesdir file temp dir tempdir file util fileutil get temp dir gettempdir ajc task compile command test ajctaskcompilecommandtest classes temp files tempfiles add temp dir tempdir temp dir tempdir add common args addcommonargs array list arraylist list list add list add get classes dir getclassesdir get absolute path getabsolutepath list add classpath list add globals aspectjrt jar get absolute path getabsolutepath do wait dowait imessage holder imessageholder holder seconds timeout ajc task compile command ajctaskcompilecommand wait until messages quiet waituntilmessagesquiet holder seconds timeout ajc task compile command test ajctaskcompilecommandtest string test wait until messages quiet testwaituntilmessagesquiet input errors inputerrors message handler messagehandler mhandler message handler messagehandler assert false assertfalse do wait dowait mhandler assert false assertfalse do wait dowait mhandler assert false assertfalse do wait dowait mhandler assert false assertfalse do wait dowait mhandler thrown do wait dowait illegal argument exception illegalargumentexception thrown assert true asserttrue exception thrown thrown test default testdefault run simple test runsimpletest taskdefs testdata java test default list testdefaultlist run simple test runsimpletest taskdefs testdata lst test compile error list testcompileerrorlist run simple test runsimpletest taskdefs testdata compile error compileerror lst test wait until messages quiet testwaituntilmessagesquiet run all tests runalltests check wait checkwait test wait until messages quiet testwaituntilmessagesquiet run all tests runalltests check wait checkwait test wait until messages quiet testwaituntilmessagesquiet check wait checkwait xxx async tests fail adder thread starved test wait until messages quiet testwaituntilmessagesquiet run all tests runalltests check wait checkwait test wait until messages quiet testwaituntilmessagesquiet run all tests runalltests check wait checkwait run simple test runsimpletest string path expected errors expectederrors file file file path assert true asserttrue path file can read canread array list arraylist list array list arraylist add common args addcommonargs list path ends with endswith lst list add argfile list add file get absolute path getabsolutepath file util fileutil has source suffix hassourcesuffix path list add file get absolute path getabsolutepath assert true asserttrue unrecognized file path run test runtest list expected errors expectederrors run test runtest array list arraylist args expected errors expectederrors ajc task compile command ajctaskcompilecommand command ajc task compile command ajctaskcompilecommand message handler messagehandler handler message handler messagehandler string parms string args to array toarray string result command run command runcommand parms handler expect pass expectpass expected errors expectederrors pass result expect pass expectpass pass string expect pass expectpass pass fail assert true asserttrue expected args check wait checkwait seconds timeout to add toadd add interval addinterval string test case testcase check wait checkwait seconds seconds timeout timeout message handler messagehandler mhandler message handler messagehandler start time starttime system current time millis currenttimemillis test timeout testtimeout start time starttime timeout result to add toadd adds synchronously result do wait dowait mhandler seconds timeout assert true asserttrue result test case testcase result logged warning loggedwarning system println warning test fail adder thread starved logged warning loggedwarning message adder messageadder adder message adder messageadder mhandler to add toadd add interval addinterval string label test case testcase wait to add toadd add interval addinterval result result thread added thread addedthread result wait result waitresult result thread test thread testthread thread runnable wait result waitresult added thread addedthread thread adder label child wait result waitresult added thread addedthread start wait result waitresult result ajc task compile command test ajctaskcompilecommandtest do wait dowait mhandler seconds timeout label test thread testthread start test thread testthread join test timeout testtimeout start time starttime interrupted exception interruptedexception wait result waitresult added thread addedthread wait test timeout testtimeout system current time millis currenttimemillis wait wait result waitresult added thread addedthread join wait interrupted exception interruptedexception result wait result waitresult result adder get num added getnumadded assert equals assertequals test case testcase to add toadd result assert true asserttrue test case testcase result adder end time endtime system current time millis currenttimemillis elapsed end time endtime start time starttime assert true asserttrue seconds seconds elapsed elapsed seconds assert true asserttrue timeout timeout elapsed elapsed timeout message adder messageadder runnable max test max millis wait imessage holder imessageholder messages num to add numtoadd interval num added numadded param holder imessage holder imessageholder add param num number messages add param interval seconds messages message adder messageadder imessage holder imessageholder holder num interval lang util langutil throw iax if null throwiaxifnull holder holder lang util langutil throw iax if false throwiaxiffalse num num to add numtoadd num lang util langutil throw iax if false throwiaxiffalse interval interval interval lang util langutil throw iax if false throwiaxiffalse num interval max millis messages holder num to add numtoadd num interval interval wait between adds waitbetweenadds interval cur time curtime system current time millis currenttimemillis timeout cur time curtime max millis thread thread thread current thread currentthread num added numadded timeout cur time curtime num added numadded num to add numtoadd target time targettime cur time curtime wait between adds waitbetweenadds cur time curtime timeout cur time curtime target time targettime thread sleep target time targettime cur time curtime interrupted exception interruptedexception cur time curtime system current time millis currenttimemillis cur time curtime timeout message util messageutil info messages time cur time curtime num added numadded num added numadded num added numadded get num added getnumadded num added numadded string to string tostring message adder messageadder num added numadded num added numadded num to add numtoadd num to add numtoadd interval interval wait wait num messages nummessages messages messages num messages nummessages