verbatim java saxon extensions supporting doc book docbook verbatim environments nwalsh saxon java util hashtable org xml sax org dom javax xml transform transformer exception transformerexception icl saxon expr icl saxon icl saxon pattern icl saxon context icl saxon tree icl saxon functions extensions saxon extensions supporting tables table java isberg exp copyright norman walsh href http users iclway mhkay saxon saxon implementation code adjust cals tables html tables column widths adjust column widths adjustcolumnwidths method takes result tree fragment assumed colgroup html table returns result tree fragment column widths adjusted html terms convert lengths convert length convertlength method takes length specification form unit returns length integral number pixels convenience percentage lengths returned unchanged recognized units inches centimeters millimeters picas points pixels number units assumed pixels change log initial release author norman walsh href mailto ndw nwalsh ndw nwalsh version table java isberg exp table number pixels inch pixels per inch pixelsperinch nominal table width nominal width nominalwidth pixels per inch pixelsperinch table width string table width tablewidth stylesheet fo stylesheet fostylesheet hash associate units length pixels hashtable unit hash unithash constructor verbatim methods constructor table initialize internal hash table proper values initialize hash initializehash unit hash unithash hashtable unit hash unithash pixels per inch pixelsperinch unit hash unithash pixels per inch pixelsperinch unit hash unithash pixels per inch pixelsperinch unit hash unithash pixels per inch pixelsperinch unit hash unithash pixels per inch pixelsperinch unit hash unithash pixels inch positive values legal set pixels per inch setpixelsperinch pixels per inch pixelsperinch initialize hash initializehash current pixels inch get pixels per inch getpixelsperinch pixels per inch pixelsperinch convert length specification number pixels length form valid unit convert length convertlength string length format length sign string digits string units lench length to char array tochararray flength pos factor pixels unit hash unithash initialize hash initializehash lench pos lench pos lench pos sign pos pos lench length lench pos lench pos lench pos units length substring pos digits lench pos flength parse float parsefloat digits number format exception numberformatexception system println digits number flength units equals unit hash unithash units system println units unit factor factor float value floatvalue factor flength factor pixels int value intvalue sign pixels find string stylesheet variable parameter returns string code var name varname code current code context code returns empty string variable defined param context current stylesheet context param var name varname variable dollar sign string variable string get variable getvariable context context string var name varname transformer exception transformerexception variable string var string varstring variable extensions evaluate context var name varname var string varstring variable as string asstring var string varstring illegal argument exception illegalargumentexception system println undefined variable var name varname setup parameters column width calculations method queries stylesheet variables table column widths called automatically column widths adjusted context retrieve values templates redefine variables variables queried variables exist builtin defaults bunch messages java interpreter code nominal table width code normal width tables absolute length code table width code width tables absolute length percentage param context current stylesheet context setup column widths setupcolumnwidths context context hardcoded defaults nominal width nominalwidth pixels per inch pixelsperinch table width tablewidth string var string varstring stylesheet type var string varstring get variable getvariable context stylesheet result type fo stylesheet fostylesheet var string varstring equals nominal table width var string varstring get variable getvariable context nominal table width nominal width nominalwidth convert length convertlength var string varstring table width var string varstring get variable getvariable context table width table width tablewidth var string varstring transformer exception transformerexception adjust column widths html table specification column widths cals relative width optional absolute width incompatible html column widths method adjusts cals column width specifiers attempt produce equivalent html specifiers order method work cals width specifications width attribute col colgroup colgroup result tree fragment passed method method parameters xsl stylesheet calls code nominal table width code code table width code code nominal table width code absolute distance code table width code absolute relative presented mixture relative absolute lengths table width calculate values code table width code relative nominal width calculation combinations values relative widths absolute widths html table absolute widths relative widths html table mixture absolute relative widths table width absolute widths absolute table width relative widths absolute relative nominal table width turn relative widths param context stylesheet context supplied automatically saxon param rtf result tree fragment colgroup result tree fragment adjusted colgroup node set value nodesetvalue adjust column widths adjustcolumnwidths context context node set value nodesetvalue rtf fragment value fragmentvalue rtf fragment value fragmentvalue rtf setup column widths setupcolumnwidths context name pool namepool name pool namepool context get controller getcontroller get name pool getnamepool column scan emitter columnscanemitter cs emitter csemitter column scan emitter columnscanemitter name pool namepool rtf replay cs emitter csemitter num columns numcolumns cs emitter csemitter column count columncount string widths cs emitter csemitter column widths columnwidths rel total reltotal rel parts relparts num columns numcolumns abs total abstotal abs parts absparts num columns numcolumns count count num columns numcolumns count string width widths count pos width index of indexof pos string rel part relpart width substring pos string abs part abspart width substring pos rel parse float parsefloat rel part relpart rel total reltotal rel rel parts relparts count rel number format exception numberformatexception system println rel part relpart valid relative unit pixels abs part abspart abs part abspart equals pixels convert length convertlength abs part abspart abs total abstotal pixels abs parts absparts count pixels rel parts relparts count pixels width width equals pixels convert length convertlength width abs total abstotal pixels abs parts absparts count pixels rel total reltotal count count num columns numcolumns count abs parts absparts count fo stylesheet fostylesheet pixels int value intvalue inches pixels pixels per inch pixelsperinch widths count inches widths count integer to string tostring int value intvalue abs total abstotal count count num columns numcolumns count rel rel parts relparts count rel total reltotal rel widths count integer to string tostring int value intvalue pixel width pixelwidth nominal width nominalwidth table width tablewidth index of indexof pixel width pixelwidth convert length convertlength table width tablewidth pixel width pixelwidth abs total abstotal system println table wider table width pixel width pixelwidth abs total abstotal abs total abstotal count count num columns numcolumns count rel rel parts relparts count rel total reltotal pixel width pixelwidth rel parts relparts count rel abs parts absparts count abs total abstotal rel abs parts absparts count table width tablewidth index of indexof count count num columns numcolumns count rel parts relparts count fo stylesheet fostylesheet pixels int value intvalue inches pixels pixels per inch pixelsperinch widths count inches widths count integer to string tostring int value intvalue count count num columns numcolumns count rel rel parts relparts count abs total abstotal rel widths count integer to string tostring int value intvalue column update emitter columnupdateemitter cu emitter cuemitter column update emitter columnupdateemitter name pool namepool widths rtf replay cu emitter cuemitter cu emitter cuemitter get result tree fragment getresulttreefragment transformer exception transformerexception system println transformer exception adjust column widths adjustcolumnwidths rtf