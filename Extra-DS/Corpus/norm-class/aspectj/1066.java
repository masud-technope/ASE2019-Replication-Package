org aspectj apache bcel verifier structurals java print writer printwriter java string writer stringwriter java util array list arraylist java util random java util vector org aspectj apache bcel constants org aspectj apache bcel repository org aspectj apache bcel classfile java class javaclass org aspectj apache bcel classfile method org aspectj apache bcel constant pool gen constantpoolgen org aspectj apache bcel instruction handle instructionhandle org aspectj apache bcel jsr instruction jsrinstruction org aspectj apache bcel method gen methodgen org aspectj apache bcel object type objecttype org aspectj apache bcel ret org aspectj apache bcel return instruction returninstruction org aspectj apache bcel returnaddress type returnaddresstype org aspectj apache bcel type org aspectj apache bcel verifier pass verifier passverifier org aspectj apache bcel verifier verification result verificationresult org aspectj apache bcel verifier verifier org aspectj apache bcel verifier exc assertion violated exception assertionviolatedexception org aspectj apache bcel verifier exc verifier constraint violated exception verifierconstraintviolatedexception pass b verifier bverifier pass verifier passverifier instruction context queue instructioncontextqueue utility holds instruction context instructioncontext array list arraylist pairs queue data structure hold instruction context instructioncontext objects externally saved instruction context instructioncontext object save execution path symbolic execution pass b verifier bverifier belongs instruction context instructioncontext object execute ing time instruction context instructioncontext object current symbolic execution predecessors instruction context queue instructioncontextqueue type instruction context instructioncontext vector ics vector type array list arraylist instruction context instructioncontext vector ecs vector add instruction context instructioncontext array list arraylist execution chain executionchain ics add ecs add execution chain executionchain is empty isempty ics is empty isempty remove remove remove ics remove ecs remove instruction context instructioncontext get ic getic instruction context instructioncontext ics array list arraylist get ec getec array list arraylist ecs size ics size instruction context queue instructioncontextqueue debug mode verification algorithm randomized debug verifier created verifier my owner myowner method number verify method instantiated verifier org aspectj apache bcel verifier verifier pass b verifier bverifier verifier owner method my owner myowner owner method method outgoing frame situation instruction context instructioncontext successors queue unvisited proof termination existence point frame merging circulation pump circulationpump control flow graph controlflowgraph cfg instruction context instructioncontext start frame vanilla frame vanillaframe inst constraint visitor instconstraintvisitor icv execution visitor executionvisitor random random random instruction context queue instructioncontextqueue icq instruction context queue instructioncontextqueue array list arraylist instruction executed start execute vanilla frame vanillaframe array list arraylist icv top level routine jsr call icq add start array list arraylist loop icq is empty isempty instruction context instructioncontext array list arraylist debug random next int nextint icq size icq get ic getic icq get ec getec icq remove icq get ic getic icq get ec getec icq remove array list arraylist oldchain array list arraylist clone array list arraylist newchain array list arraylist clone newchain add get instruction getinstruction get instruction getinstruction ret system err println follow successor jsr executed ret ret ret get instruction getinstruction get instruction getinstruction returnaddress type returnaddresstype returnaddress type returnaddresstype get out frame getoutframe oldchain get locals getlocals ret get index getindex instruction context instructioncontext the successor thesuccessor cfg context of contextof get target gettarget sanity check instruction context instructioncontext last jsr lastjsr skip jsr oldchain size skip jsr assertion violated exception assertionviolatedexception ret jsr execution chain system err println oldchain instruction context instructioncontext oldchain get instruction getinstruction get instruction getinstruction jsr instruction jsrinstruction skip jsr last jsr lastjsr instruction context instructioncontext oldchain skip jsr instruction context instructioncontext oldchain get instruction getinstruction get instruction getinstruction ret skip jsr last jsr lastjsr assertion violated exception assertionviolatedexception ret jsr execution chain executionchain oldchain jsr instruction jsrinstruction jsr jsr instruction jsrinstruction last jsr lastjsr get instruction getinstruction get instruction getinstruction the successor thesuccessor cfg context of contextof jsr physical successor physicalsuccessor assertion violated exception assertionviolatedexception ret get instruction getinstruction info inconsistent jump the successor thesuccessor cfg context of contextof jsr physical successor physicalsuccessor the successor thesuccessor execute get out frame getoutframe oldchain newchain icv icq add the successor thesuccessor array list arraylist newchain clone ret normal successors add queue successors instruction context instructioncontext succs get successors getsuccessors succs length instruction context instructioncontext succs execute get out frame getoutframe oldchain newchain icv icq add array list arraylist newchain clone ret exception handlers add queue successors subroutines mandated just ice justice exception handler exceptionhandler exc hds get exception handlers getexceptionhandlers exc hds length instruction context instructioncontext cfg context of contextof exc hds get handler start gethandlerstart icq add array list arraylist newchain clone execute frame get out frame getoutframe oldchain get locals getlocals operand stack operandstack get out frame getoutframe oldchain get stack getstack max stack maxstack exc hds get exception type getexceptiontype type throwable exc hds get exception type getexceptiontype array list arraylist icv icq add array list arraylist icq is empty isempty instruction handle instructionhandle start get instruction getinstruction get instruction getinstruction return instruction returninstruction cfg is dead isdead instruction context instructioncontext cfg context of contextof todo buggy check top level instructions maniac returns method subroutine frame get out frame getoutframe array list arraylist local variables localvariables lvs get locals getlocals lvs max locals maxlocals lvs uninitialized object type uninitializedobjecttype add message addmessage warning return instruction returninstruction leave method uninitialized object local variables array lvs operand stack operandstack get stack getstack size peek uninitialized object type uninitializedobjecttype add message addmessage warning return instruction returninstruction leave method uninitialized object operand stack get next getnext pass data flow analysis java virtual machine specification edition versions local variables info localvariablesinfo objects verify verifier inferred types file debug local variables localvariables attributes match todo org aspectj apache bcel verifier statics local variables info localvariablesinfo org aspectj apache bcel verifier statics pass verifier get local variables info getlocalvariablesinfo verification result verificationresult verify my owner myowner do pass dopass method equals verification result verificationresult verification result verificationresult notyet pass safe assume java class javaclass object bcel repository java class javaclass repository lookup class lookupclass my owner myowner get class name getclassname constant pool gen constantpoolgen constant pool gen constantpoolgen constant pool gen constantpoolgen get constant pool getconstantpool init visitors inst constraint visitor instconstraintvisitor icv inst constraint visitor instconstraintvisitor icv set constant pool gen setconstantpoolgen constant pool gen constantpoolgen execution visitor executionvisitor execution visitor executionvisitor set constant pool gen setconstantpoolgen constant pool gen constantpoolgen method method exists pass method methods get methods getmethods method gen methodgen method gen methodgen methods method my owner myowner get class name getclassname constant pool gen constantpoolgen icv set method gen setmethodgen dfa code pass is abstract isabstract is native isnative control flow graph controlflowgraph cfg control flow graph controlflowgraph build initial frame situation method frame frame get max locals getmaxlocals get max stack getmaxstack is static isstatic get name getname equals constants constructor frame uninitialized object type uninitializedobjecttype object type objecttype get class name getclassname get locals getlocals frame frame get locals getlocals object type objecttype get class name getclassname type argtypes get argument types getargumenttypes twoslotoffset argtypes length argtypes type argtypes type argtypes type argtypes type argtypes type get locals getlocals twoslotoffset is static isstatic argtypes argtypes get size getsize twoslotoffset get locals getlocals twoslotoffset is static isstatic type unknown circulation pump circulationpump cfg cfg context of contextof get instruction list getinstructionlist get start getstart icv verifier constraint violated exception verifierconstraintviolatedexception extend message extendmessage constraint violated method methods method verification result verificationresult verification result verificationresult verified rejected get message getmessage runtime exception runtimeexception string writer stringwriter string writer stringwriter print writer printwriter print writer printwriter print stack trace printstacktrace assertion violated exception assertionviolatedexception runtime exception runtimeexception occured verify ing get class name getclassname method methods method original runtime exception runtimeexception stack trace verification result verificationresult returns method number supplied instantiating get method no getmethodno method