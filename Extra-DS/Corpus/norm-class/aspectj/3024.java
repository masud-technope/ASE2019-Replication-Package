copyright contributors rights reserved program accompanying materials terms common license accompanies distribution http eclipse org legal cpl html contributors mik kersten initial implementation andy clement incremental support org aspectj asm java java util org aspectj asm internal org aspectj bridge isource location isourcelocation structure model asm represents containment hierarchy crossccutting structure map aspect j aspectj programs ide views document outline tools ajdoc aspect j aspectj declarations crosscutting links advice join point shadows author mik kersten asm manager asmmanager deprecated get default getdefault method asm manager asmmanager instance asm manager asmmanager ielement handle provider ielementhandleprovider handle provider handleprovider list structure listeners structurelisteners array list arraylist should save model shouldsavemodel set relationship map setrelationshipmap irelationship map irelationshipmap irm mapper irm set hierarchy sethierarchy ihierarchy hierarchy model manipulated aj build manager ajbuildmanager setup model setupmodel code trashes fields setting model batch build requirements incremental compilation tie info aj state ajstate compilation recover switching projects ihierarchy hierarchy irelationship map irelationshipmap mapper creating model creatingmodel dumping model expensive dump model post build dumpmodelpostbuild secretapi asc pull secret options system api lazy fool attempt incremental model repairs attemptincrementalmodelrepairs offline debugging asm manager asmmanager dump model method set reporting setreporting dump model dumpmodel dump relationships dumprelationships dump delta processing dumpdeltaprocessing string dump filename dumpfilename reporting completing type bindings completingtypebindings asm manager asmmanager hierarchy aspect jelement hierarchy aspectjelementhierarchy list relationships array list arraylist mapper relationship map relationshipmap hierarchy handle provider handleprovider optimized full path handle provider optimizedfullpathhandleprovider create new asm createnewasm hierarchy aspect jelement hierarchy aspectjelementhierarchy mapper relationship map relationshipmap hierarchy ihierarchy get hierarchy gethierarchy hierarchy asm manager asmmanager get default getdefault instance irelationship map irelationshipmap get relationship map getrelationshipmap mapper fire model updated firemodelupdated notify listeners notifylisteners dump model post build dumpmodelpostbuild hierarchy get config file getconfigfile write structure model writestructuremodel hierarchy get config file getconfigfile constructs map time called hash map hashmap get inline annotations getinlineannotations string source file sourcefile show sub member showsubmember show member and type showmemberandtype hierarchy is valid isvalid hash map hashmap annotations hash map hashmap iprogram element iprogramelement node hierarchy find element for source file findelementforsourcefile source file sourcefile node ihierarchy structure iprogram element iprogramelement file node filenode iprogram element iprogramelement node array list arraylist pe nodes penodes array list arraylist get all structure children getallstructurechildren file node filenode pe nodes penodes show sub member showsubmember show member and type showmemberandtype iterator pe nodes penodes iterator has next hasnext iprogram element iprogramelement pe node penode iprogram element iprogramelement list entries array list arraylist entries add pe node penode isource location isourcelocation source loc sourceloc pe node penode get source location getsourcelocation source loc sourceloc integer hash integer source loc sourceloc get line getline list existing entry existingentry list annotations hash existing entry existingentry entries add all addall existing entry existingentry annotations hash entries annotations get all structure children getallstructurechildren iprogram element iprogramelement node list result show sub member showsubmember show member and type showmemberandtype list children node get children getchildren node get children getchildren iterator children iterator has next hasnext iprogram element iprogramelement iprogram element iprogramelement list rels asm manager asmmanager get default getdefault get relationship map getrelationshipmap get kind getkind iprogram element iprogramelement kind code show sub member showsubmember get kind getkind iprogram element iprogramelement kind code show member and type showmemberandtype rels rels size result add get all structure children getallstructurechildren iprogram element iprogramelement result show sub member showsubmember show member and type showmemberandtype add listener addlistener ihierarchy listener ihierarchylistener listener structure listeners structurelisteners add listener remove structure listener removestructurelistener ihierarchy listener ihierarchylistener listener structure listeners structurelisteners remove listener shouldn needed people add listeners test suite remove amc called setup test cases cease leaking listeners executing reasonable speed remove all listeners removealllisteners structure listeners structurelisteners clear notify listeners notifylisteners iterator structure listeners structurelisteners iterator has next hasnext ihierarchy listener ihierarchylistener elements updated elementsupdated hierarchy ielement handle provider ielementhandleprovider get handle provider gethandleprovider handle provider handleprovider set handle provider sethandleprovider ielement handle provider ielementhandleprovider handle provider handleprovider handle provider handleprovider handle provider handleprovider fails silently write structure model writestructuremodel string config file path configfilepath string file path filepath gen extern file path genexternfilepath config file path configfilepath file output stream fileoutputstream fos file output stream fileoutputstream file path filepath object output stream objectoutputstream object output stream objectoutputstream fos store program element tree write object writeobject hierarchy store relationships write object writeobject mapper flush fos flush fos close close exception todo add proper handling bad paths suffixes param config file path configfilepath path lst file read structure model readstructuremodel string config file path configfilepath hierarchy read ok hierarchyreadok config file path configfilepath hierarchy set root setroot ihierarchy structure string file path filepath gen extern file path genexternfilepath config file path configfilepath file input stream fileinputstream file input stream fileinputstream file path filepath object input stream objectinputstream object input stream objectinputstream hierarchy aspect jelement hierarchy aspectjelementhierarchy read object readobject hierarchy read ok hierarchyreadok mapper relationship map relationshipmap read object readobject relationship map relationshipmap mapper set hierarchy sethierarchy hierarchy file not found exception filenotfoundexception fnfe hierarchy set root setroot ihierarchy structure eofexception eofe hierarchy read ok hierarchyreadok system err println asm manager asmmanager unable read structure model config file path configfilepath eofe print stack trace printstacktrace hierarchy set root setroot ihierarchy structure exception hierarchy set root setroot ihierarchy structure notify listeners notifylisteners string gen extern file path genexternfilepath string config file path configfilepath config file path configfilepath substring config file path configfilepath last index of lastindexof lst ajsym set should save model setshouldsavemodel should save model shouldsavemodel should save model shouldsavemodel should save model shouldsavemodel implementation canonical file path map accessors sophisticated optimisation left commented performance gains don justify disturbance close release call prepare for weave prepareforweave prepared for compilation preparedforcompilation completed prepare for compilation prepareforcompilation list files canonical file path map canonicalfilepathmap prepopulate files prepare for weave prepareforweave canonical file path map canonicalfilepathmap handover string get canonical file path getcanonicalfilepath file canonical file path map canonicalfilepathmap canonical file path map canonicalfilepathmap canonical file path map canonicalfilepathmap canonical file path map canonicalfilepathmap canonical file path map canonicalfilepathmap max size map path map pathmap hash map hashmap guards ensure correctness liveness cache in use cacheinuse stop requested stoprequested is cache in use iscacheinuse cache in use cacheinuse set cache in use setcacheinuse val cache in use cacheinuse val val notify all notifyall is stop requested isstoprequested stop requested stoprequested request stop requeststop stop requested stoprequested prepopulating map adding entry file get path getpath file get canonical path getcanonicalpath file list background thread param files prepopulate list files stop requested stoprequested set cache in use setcacheinuse path map pathmap size max size path map pathmap clear thread system println starting cache population system current time millis currenttimemillis iterator files iterator is stop requested isstoprequested has next hasnext file file path map pathmap get path getpath reuse cache compiles ides path map pathmap get path getpath get canonical path getcanonicalpath ioexception path map pathmap get path getpath get path getpath system println cached files size set cache in use setcacheinuse system println cache populated system current time millis currenttimemillis start pre populating cache customers ready cache misses point populate cache handover ensure thread accessing cache minimize synchronization handover is cache in use iscacheinuse request stop requeststop is cache in use iscacheinuse wait interrupted exception interruptedexception int ex intex string file cache in use cacheinuse unsynchronized test parallel threads point illegal state exception illegalstateexception ownership cache calling handover string ret string path map pathmap get path getpath ret ret get canonical path getcanonicalpath ioexception io ex ioex ret get path getpath path map pathmap get path getpath ret path map pathmap size max size path map pathmap clear ret secretapi set reporting setreporting string filename d model dmodel d rels drels d delta processing ddeltaprocessing deletefile reporting dump model dumpmodel d model dmodel dump relationships dumprelationships d rels drels dump delta processing dumpdeltaprocessing d delta processing ddeltaprocessing deletefile file filename delete dump filename dumpfilename filename is reporting isreporting reporting report model info reportmodelinfo string reason for report reasonforreport dump model dumpmodel dump relationships dumprelationships file writer filewriter file writer filewriter dump filename dumpfilename buffered writer bufferedwriter buffered writer bufferedwriter dump model dumpmodel write model status report reason for report reasonforreport dumptree asm manager asmmanager get default getdefault get hierarchy gethierarchy get root getroot write model report dump relationships dumprelationships write relationships report reason for report reasonforreport dumprels write relationships report properties model info modelinfo summarize model summarizemodel get properties getproperties enumeration pkeyenum write properties model relationships map pkeyenum has more elements hasmoreelements string pkey string pkeyenum next element nextelement write pkey get property getproperty pkey flush close ioexception system err println internal error internalerror unable report model print stack trace printstacktrace dumptree writer iprogram element iprogramelement node indent ioexception indent write string loc node node get source location getsourcelocation loc node get source location getsourcelocation to string tostring write node node node get kind getkind to string tostring loc node iterator node get children getchildren iterator has next hasnext dumptree iprogram element iprogramelement indent dumptree iprogram element iprogramelement node indent ioexception indent system print string loc node node get source location getsourcelocation loc node get source location getsourcelocation to string tostring system println node node node get kind getkind to string tostring loc node iterator node get children getchildren iterator has next hasnext dumptree iprogram element iprogramelement indent dumprels writer ioexception irelationship map irelationshipmap irm asm manager asmmanager get default getdefault get relationship map getrelationshipmap ctr entries irm get entries getentries iterator iter entries iterator iter has next hasnext string string iter list rels irm iterator iterator rels iterator iterator has next hasnext irelationship irelationship iterator list targets get targets gettargets iterator iterator targets iterator iterator has next hasnext string thid string iterator write ctr targets targets size get name getname thid delta processing code start xxx shouldn aware delimiter string get filename getfilename string substring index of indexof code slow isnt worth fixing address bugs binary weaving fixup structure model fixupstructuremodel writer list files to be compiled filestobecompiled files files deleted ioexception kinds worry files compile files deleted compile files changed compile config get files getfiles list files config get files getfiles ihierarchy model asm manager asmmanager get default getdefault get hierarchy gethierarchy model modified modelmodified files delete compiled deleted files to remove from structure model filestoremovefromstructuremodel hash set hashset files to be compiled filestobecompiled files to remove from structure model filestoremovefromstructuremodel add all addall files deleted deleted nodes deletednodes hash set hashset iterator iter files to remove from structure model filestoremovefromstructuremodel iterator iter has next hasnext file file for compilation fileforcompilation file iter string corrected path correctedpath asm manager asmmanager get default getdefault get canonical file path getcanonicalfilepath file for compilation fileforcompilation iprogram element iprogramelement prog elem progelem iprogram element iprogramelement model find in file map findinfilemap corrected path correctedpath prog elem progelem remove dump delta processing dumpdeltaprocessing write deleting prog elem progelem node file file for compilation fileforcompilation remove node removenode prog elem progelem deleted nodes deletednodes add get filename getfilename prog elem progelem get handle identifier gethandleidentifier model remove from file map removefromfilemap corrected path correctedpath to string tostring runtime exception runtimeexception repairing model couldn remove entry file corrected path correctedpath to string tostring filemap model modified modelmodified model modified modelmodified model flush type map flushtypemap model update handle map updatehandlemap deleted nodes deletednodes process delta processdelta list files to be compiled filestobecompiled files files deleted writer recording dump delta processing dumpdeltaprocessing file writer filewriter filew file writer filewriter dump filename dumpfilename buffered writer bufferedwriter filew write processing delta model write files compilation files to be compiled filestobecompiled size files to be compiled filestobecompiled write files files size files write files deleted files deleted size files deleted stime system current time millis currenttimemillis fixup structure model fixupstructuremodel files to be compiled filestobecompiled files files deleted etime stime time model etime system current time millis currenttimemillis ihierarchy model asm manager asmmanager get default getdefault get hierarchy gethierarchy file exist filemap handle file exist dump delta processing dumpdeltaprocessing write repairing relationships map sort relationships map irelationship map irelationshipmap irm asm manager asmmanager get default getdefault get relationship map getrelationshipmap sources to remove sourcestoremove hash set hashset cache handles invalid non existing handles nonexistinghandles hash set hashset srchandlecounter tgthandlecounter iterate source handles relationships map source handles keyset irm get entries getentries iterator keyiter keyset iterator keyiter has next hasnext string string keyiter srchandlecounter handle points non existing handles nonexistinghandles sources to remove sourcestoremove add check exists iprogram element iprogramelement existing element existingelement model get element getelement dump delta processing dumpdeltaprocessing write handle model existing element existingelement find existing element existingelement delete relationship sources to remove sourcestoremove add speed bit swine non existing handles nonexistinghandles add source valid targets list relationships irm list relationships to remove relationshipstoremove array list arraylist iterate relationships source handle iterator reliter relationships iterator reliter has next hasnext irelationship rel irelationship reliter list targets rel get targets gettargets list targets to remove targetstoremove array list arraylist iterate targets relationship iterator target iter targetiter targets iterator target iter targetiter has next hasnext string targethid string target iter targetiter tgthandlecounter doesn exist non existing handles nonexistinghandles targethid dump delta processing dumpdeltaprocessing write target handle targethid srchid rel rel get name getname exist targets to remove targetstoremove add targethid check iprogram element iprogramelement existing target existingtarget model get element getelement targethid existing target existingtarget dump delta processing dumpdeltaprocessing write target handle targethid srchid rel rel get name getname exist targets to remove targetstoremove add targethid non existing handles nonexistinghandles add targethid targets removing targets to remove targetstoremove size removing targets relationship removing relationship targets to remove targetstoremove size targets size dump delta processing dumpdeltaprocessing write targets remain srchid rel rel get name getname removing relationships to remove relationshipstoremove add rel remove targets longer valid iterator targs iter targsiter targets to remove targetstoremove iterator targs iter targsiter has next hasnext string togo string targs iter targsiter targets remove togo caught check targets size dump delta processing dumpdeltaprocessing write targets remain srchid rel rel get name getname removing todo remove relationship srchid relationships to remove relationshipstoremove add rel relationships emptied processing removing source handle relationships to remove relationshipstoremove size removing relationships source handle relationships to remove relationshipstoremove size relationships size delete source handle sources to remove sourcestoremove add relationships to remove relationshipstoremove size irelationship irel irelationship relationships to remove relationshipstoremove verify assumption verifyassumption irm remove irel failed remove relationship irel get name getname shid list rels irm rels rels size sources to remove sourcestoremove add remove sources valid relationships iterator srciter sources to remove sourcestoremove iterator srciter has next hasnext string string srciter irm remove all removeall iprogram element iprogramelement ipe model get element getelement ipe relationship hanging code node delete ipe get kind getkind equals iprogram element iprogramelement kind code remove single node removesinglenode ipe etime stime time repair relationship map etime system current time millis currenttimemillis dump delta processing dumpdeltaprocessing write delta processing timing write hierarchy etime stime relationshipmap etime etime write traversal write source handles processed srchandlecounter write target handles processed tgthandlecounter write flush close report model info reportmodelinfo delta processing ioexception print stack trace printstacktrace removes program element structure model parent program element children remove node delete list children remove single node removesinglenode iprogram element iprogramelement prog elem progelem verify assumption verifyassumption prog elem progelem delete ok deleteok iprogram element iprogramelement parent prog elem progelem get parent getparent list kids parent get children getchildren kids size kids equals prog elem progelem kids remove delete ok deleteok verify assumption verifyassumption delete ok deleteok removes program element structure model processing stages parent program element children remove node delete list children check parent children children code node node delete remove node removenode iprogram element iprogramelement prog elem progelem string buffer stringbuffer flightrecorder string buffer stringbuffer flightrecorder append remove node removenode chuck prog elem progelem verify assumption verifyassumption prog elem progelem delete ok deleteok iprogram element iprogramelement parent prog elem progelem get parent getparent flightrecorder append parent parent list kids parent get children getchildren flightrecorder append kids size kids kids size flightrecorder append comparing kids kids equals prog elem progelem kids remove delete ok deleteok kids left node parent get children getchildren size parent get parent getparent parent get kind getkind equals iprogram element iprogramelement kind code parent get kind getkind equals iprogram element iprogramelement kind node trim structural node check making code node trim system err println deleting parent parent remove node removenode parent null pointer exception nullpointerexception npe npe print stack trace printstacktrace verify assumption verifyassumption string info system err println assertion system err println info thread dump stack dumpstack system err println assertion runtime exception runtimeexception assertion verify assumption verifyassumption thread dump stack dumpstack runtime exception runtimeexception assertion model info modelinfo object captures basic structure model testing producing debug info model info modelinfo hashtable node type count nodetypecount hashtable properties extra properties extraproperties properties model info modelinfo ihierarchy hierarchy irelationship map irelationshipmap relationship map relationshipmap iprogram element iprogramelement ipe hierarchy get root getroot walk model walkmodel ipe record stat recordstat file map size filemapsize integer hierarchy get file map entry set getfilemapentryset size to string tostring record stat recordstat relationship map size relationshipmapsize integer relationship map relationshipmap get entries getentries size to string tostring walk model walkmodel iprogram element iprogramelement ipe count node countnode ipe list kids ipe get children getchildren iterator iter kids iterator iter has next hasnext iprogram element iprogramelement next element nextelement iprogram element iprogramelement iter walk model walkmodel next element nextelement count node countnode iprogram element iprogramelement ipe string node ipe get kind getkind to string tostring integer ctr integer node type count nodetypecount node ctr node type count nodetypecount node integer ctr integer ctr int value intvalue node type count nodetypecount node ctr string to string tostring string buffer stringbuffer string buffer stringbuffer append model node summary enumeration node keys nodekeys node type count nodetypecount node keys nodekeys has more elements hasmoreelements string key string node keys nodekeys next element nextelement integer integer node type count nodetypecount key append key append model stats enumeration extra properties extraproperties has more elements hasmoreelements string string next element nextelement string extra properties extraproperties get property getproperty append to string tostring properties get properties getproperties properties properties enumeration node keys nodekeys node type count nodetypecount node keys nodekeys has more elements hasmoreelements string key string node keys nodekeys next element nextelement integer integer node type count nodetypecount key set property setproperty key to string tostring put all putall extra properties extraproperties record stat recordstat string string string string extra properties extraproperties set property setproperty string string model info modelinfo summarize model summarizemodel model info modelinfo asm manager asmmanager get default getdefault get hierarchy gethierarchy asm manager asmmanager get default getdefault get relationship map getrelationshipmap building structure model front set creating model setcreatingmodel creating model creatingmodel returns generating structure model enables guarding expensive operations empty model is creating model iscreatingmodel creating model creatingmodel set completing type bindings setcompletingtypebindings completing type bindings completingtypebindings is completing type bindings iscompletingtypebindings completing type bindings completingtypebindings