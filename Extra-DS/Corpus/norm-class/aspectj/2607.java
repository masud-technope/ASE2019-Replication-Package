verbatim java saxon extensions supporting doc book docbook verbatim environments nwalsh saxon java util stack java util string tokenizer stringtokenizer org xml sax org dom javax xml transform transformer exception transformerexception icl saxon expr icl saxon icl saxon pattern icl saxon context icl saxon tree icl saxon functions extensions nwalsh saxon number lines emitter numberlinesemitter nwalsh saxon callout emitter calloutemitter saxon extensions supporting doc book docbook verbatim environments verbatim java isberg exp copyright norman walsh href http users iclway mhkay saxon saxon implementation features impractical implement xslt numbering callouts numbering number lines numberlines method takes result tree fragment assumed contents formatted verbatim element doc book docbook programlisting screen address literallayout synopsis returns result tree fragment decorated numbers callouts insert callouts insertcallouts method takes areaspec result tree fragment assumed contents formatted verbatim element doc book docbook programlisting screen address literallayout synopsis returns result tree fragment decorated callouts change log initial release author norman walsh href mailto ndw nwalsh ndw nwalsh version verbatim java isberg exp verbatim stylesheet producing formatting objects fo stylesheet fostylesheet modulus numbering modulus numbered modulus width characters numbers padding width separator number verbatim text string separator callouts setup callouts setup calloutssetup column callouts range default column defaultcolumn path graphical callout decorations string graphics path graphicspath extension graphical callout decorations string graphics ext graphicsext largest callout number represented graphically graphics max graphicsmax format callout formatcallout object formatting callouts format callout formatcallout f callout fcallout constructor verbatim methods constructor verbatim find string stylesheet variable parameter returns string code var name varname code current code context code returns empty string variable defined param context current stylesheet context param var name varname variable dollar sign string variable string get variable getvariable context context string var name varname variable string var string varstring variable extensions evaluate context var name varname var string varstring variable as string asstring var string varstring transformer exception transformerexception system println undefined variable var name varname illegal argument exception illegalargumentexception iae system println undefined variable var name varname setup parameters numbering method queries stylesheet variables numbering called automatically lines numbered context retrieve values templates redefine variables variables queried variables exist builtin defaults bunch messages java interpreter code linenumbering every nth everynth code specifies lines numbered numbered builtin code linenumbering width code specifies width numbers width narrow largest number needed automatically wider builtin code linenumbering separator code specifies string separates numbers lines program listing builtin code stylesheet result type code specifies stylesheet result type xsl formatting objects isn builtin html param context current stylesheet context setup line numbering setuplinenumbering context context hardcoded defaults modulus width separator fo stylesheet fostylesheet string var string varstring modulus var string varstring get variable getvariable context linenumbering every nth everynth modulus integer parse int parseint var string varstring number format exception numberformatexception nfe system println linenumbering every nth everynth number var string varstring width var string varstring get variable getvariable context linenumbering width width integer parse int parseint var string varstring number format exception numberformatexception nfe system println linenumbering width number var string varstring separator var string varstring get variable getvariable context linenumbering separator separator var string varstring stylesheet type var string varstring get variable getvariable context stylesheet result type fo stylesheet fostylesheet var string varstring equals number lines verbatim environment extension function expects variables calling context linenumbering every nth everynth linenumbering width linenumbering separator stylesheet result type method adds numbers result tree fragment newline occurs text node assumed start numbered subsequent every nth everynth numbered every nth everynth lines numbered every nth everynth lines environment numbered number justified string width characters number environment fit width width automatically increased smallest hold number attempt enumerate lines environment lines automatically environment separator string inserted number original program listing lines numbered preceded width blank string separator inline markup breaks markup required open elements closed reopened reopened elements attributes originals attributes duplicated stylesheet result type html attributes duplicated result type param rtf result tree fragment verbatim environment modified result tree fragment node set value nodesetvalue number lines numberlines context context node set value nodesetvalue rtf fragment value fragmentvalue rtf fragment value fragmentvalue rtf setup line numbering setuplinenumbering context line count emitter linecountemitter lc emitter lcemitter line count emitter linecountemitter rtf replay lc emitter lcemitter num lines numlines lc emitter lcemitter line count linecount listing modulus listingmodulus num lines numlines modulus modulus log num lines numlines math log num lines numlines math log listing width listingwidth width log num lines numlines math floor log num lines numlines width name pool namepool name pool namepool context get controller getcontroller get name pool getnamepool number lines emitter numberlinesemitter nl emitter nlemitter number lines emitter numberlinesemitter name pool namepool listing modulus listingmodulus listing width listingwidth separator fo stylesheet fostylesheet rtf replay nl emitter nlemitter nl emitter nlemitter get result tree fragment getresulttreefragment transformer exception transformerexception system println transformer exception number lines numberlines rtf setup parameters callouts method queries stylesheet variables numbering called automatically callouts processed context retrieve values templates redefine variables variables queried variables exist builtin defaults bunch messages java interpreter code callout graphics code callout graphics callout graphics parameters graphis queried code callout graphics path code specifies path callout graphics code callout graphics extension code specifies extension callout graphics code callout graphics number limit code identifies largest number represented graphic larger callout numbers represented text code callout defaultcolumn code specifies column callout bullets column code stylesheet result type code specifies stylesheet result type xsl formatting objects isn builtin html param context current stylesheet context setup callouts setupcallouts context context name pool namepool name pool namepool context get controller getcontroller get name pool getnamepool use graphics usegraphics use unicode useunicode unicode start unicodestart unicode max unicodemax string unicode font unicodefont hardcoded defaults default column defaultcolumn graphics path graphicspath graphics ext graphicsext graphics max graphicsmax fo stylesheet fostylesheet callouts setup calloutssetup variable string var string varstring stylesheet type var string varstring get variable getvariable context stylesheet result type fo stylesheet fostylesheet var string varstring equals column var string varstring get variable getvariable context callout defaultcolumn default column defaultcolumn integer parse int parseint var string varstring number format exception numberformatexception nfe system println callout defaultcolumn number var string varstring graphics var string varstring get variable getvariable context callout graphics use graphics usegraphics var string varstring equals var string varstring equals unicode var string varstring get variable getvariable context callout unicode use unicode useunicode var string varstring equals var string varstring equals use graphics usegraphics graphics path var string varstring get variable getvariable context callout graphics path graphics path graphicspath var string varstring graphics extension var string varstring get variable getvariable context callout graphics extension graphics ext graphicsext var string varstring number limit var string varstring get variable getvariable context callout graphics number limit graphics max graphicsmax integer parse int parseint var string varstring number format exception numberformatexception nfe system println callout graphics number limit number var string varstring graphics max graphicsmax f callout fcallout format graphic callout formatgraphiccallout name pool namepool graphics path graphicspath graphics ext graphicsext graphics max graphicsmax fo stylesheet fostylesheet use unicode useunicode starting character var string varstring get variable getvariable context callout unicode start character unicode start unicodestart integer parse int parseint var string varstring number format exception numberformatexception nfe system println callout unicode start character number var string varstring unicode start unicodestart number limit var string varstring get variable getvariable context callout unicode number limit unicode max unicodemax integer parse int parseint var string varstring number format exception numberformatexception nfe system println callout unicode number limit number var string varstring unicode start unicodestart font unicode font unicodefont get variable getvariable context callout unicode font unicode font unicodefont unicode font unicodefont f callout fcallout format unicode callout formatunicodecallout name pool namepool unicode font unicodefont unicode start unicodestart unicode max unicodemax fo stylesheet fostylesheet f callout fcallout format text callout formattextcallout name pool namepool fo stylesheet fostylesheet insert text callouts verbatim environment method examines areaset area elements supplied areaspec decorates supplied result tree fragment callout markers label attribute supplied area content label callout number surrounded parenthesis callout numbers represented graphics callouts numbered document order area areaset number linecolumn linerange units supported unit specifed linecolumn assumed callout decoration appears default column defaultcolumn lines padded blanks reach column callouts located verbatim environment callouts inserted character column occur graphical callouts callout number equal callout graphics number limit image generated html pre img src callout graphics path callout graphics ext alt conumber pre stylesheet result type image generated pre external graphic src callout graphics path callout graphics ext pre callout number exceeds callout graphics number limit callout callout number surrounded parenthesis param context stylesheet context param areaspec node set areaspecnodeset source node areaspec param rtf result tree fragment verbatim environment modified result tree fragment node set value nodesetvalue insert callouts insertcallouts context context node list nodelist areaspec node list areaspecnodelist node set value nodesetvalue rtf fragment value fragmentvalue rtf fragment value fragmentvalue rtf setup callouts setupcallouts context name pool namepool name pool namepool context get controller getcontroller get name pool getnamepool callout emitter calloutemitter c emitter cemitter callout emitter calloutemitter name pool namepool default column defaultcolumn fo stylesheet fostylesheet f callout fcallout c emitter cemitter setup callouts setupcallouts areaspec node list areaspecnodelist rtf replay c emitter cemitter c emitter cemitter get result tree fragment getresulttreefragment transformer exception transformerexception system println transformer exception insert callouts insertcallouts rtf