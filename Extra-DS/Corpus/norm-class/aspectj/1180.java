org aspectj apache bcel classfile java byte array input stream bytearrayinputstream java byte array output stream bytearrayoutputstream java char array reader chararrayreader java char array writer chararraywriter java data output stream dataoutputstream java filter reader filterreader java filter writer filterwriter java ioexception java print stream printstream java print writer printwriter java reader java writer java util array list arraylist java util iterator java util list java util zip gzipinput stream gzipinputstream java util zip gzipoutput stream gzipoutputstream org aspectj apache bcel constants org aspectj apache bcel classfile annotation annotation org aspectj apache bcel classfile annotation element name value pair elementnamevaluepair org aspectj apache bcel classfile annotation runtime invisible annotations runtimeinvisibleannotations org aspectj apache bcel classfile annotation runtime invisible parameter annotations runtimeinvisibleparameterannotations org aspectj apache bcel classfile annotation runtime visible annotations runtimevisibleannotations org aspectj apache bcel classfile annotation runtime visible parameter annotations runtimevisibleparameterannotations org aspectj apache bcel constant pool gen constantpoolgen org aspectj apache bcel annotation annotation gen annotationgen org aspectj apache bcel util byte sequence bytesequence utility functions belong version utility java aclement exp author href mailto markus dahm berlin dahm modified andy clement mar removed unnecessary optimized utility wide instruction code bit wide indices local variables opcode precedes iload opcode takes extra combined form bit wide convert bit field flags string param access flags access flags string representation flags string access to string accesstostring access flags access to string accesstostring access flags convert bit field flags string special classes compiled compilers acc flag sun flags acc acc param access flags access flags param access flags qualifiers string representation flags string access to string accesstostring access flags string buffer stringbuffer buf string buffer stringbuffer constants max acc flag loop flags pow access flags special comment top constants acc constants acc buf append constants access names append buf to string tostring trim depending acc flag string class or interface classorinterface access flags access flags constants acc disassemble array jvm codes starting code disassembled string representation decode num opcodes including operands decompile param code code array param constant pool array constants param offset code array number opcodes bytes param length number opcodes decompile param verbose verbose print constant pool string representation codes string code to string codetostring code constant pool constantpool constant pool length verbose sufficient string buffer stringbuffer buf string buffer stringbuffer code length byte sequence bytesequence stream byte sequence bytesequence code skip lines code skip lines code skip lines code code to string codetostring stream constant pool verbose stream length length string indices fillup stream get index getindex buf append indices code to string codetostring stream constant pool verbose ioexception system println buf to string tostring print stack trace printstacktrace class format exception classformatexception code error buf to string tostring disassemble stream codes string representation string code to string codetostring code constant pool constantpool constant pool length code to string codetostring code constant pool length string code to string codetostring byte sequence bytesequence bytes constant pool constantpool constant pool ioexception code to string codetostring bytes constant pool shorten names java lang string string param str compacted string compact class name compactclassname string str compact class name compactclassname str shorten str chop prefix starts string flag chopit slashes converted dots param str param prefix prefix rid param chopit flag determines chopping executed compacted string compact class name compactclassname string str string prefix chopit len prefix length systems dos str str replace chopit string starts prefix dots str starts with startswith prefix str substring len index of indexof str str substring len str shorten names java lang string java lang string chopit prefix java lang removed param str param chopit flag determines chopping executed compacted string compact class name compactclassname string str chopit compact class name compactclassname str java lang chopit bit modification flag bit set bit setbit flag flag pow flag bit clear bit clearbit flag bit pow flag bit flag flag bit bit flag is set isset flag flag pow converts string method argument types code method signature param return type returntype type method java lang string param method args methodargs types method arguments code representation method signature string method type to signature methodtypetosignature string return type returntype string method args methodargs class format exception classformatexception string buffer stringbuffer buf string buffer stringbuffer method args methodargs method args methodargs length string str get signature getsignature method args methodargs method argument str equals class format exception classformatexception invalid type method args methodargs buf append str buf append get signature getsignature return type returntype buf to string tostring param signature method signature array argument types class format exception classformatexception string method signature argument types methodsignatureargumenttypes string signature class format exception classformatexception method signature argument types methodsignatureargumenttypes signature method signature file format ljava lang string returns array strings representing arguments normal form java lang string param signature method signature param chopit shorten names array argument types string method signature argument types methodsignatureargumenttypes string signature chopit class format exception classformatexception array list arraylist vec array list arraylist string types read declarations signature char at charat class format exception classformatexception invalid method signature signature current string position signature char at charat result holder resultholder signature to string internal signaturetostringinternal signature substring chopit vec add get result getresult get consumed chars getconsumedchars string index out of bounds exception stringindexoutofboundsexception class format exception classformatexception invalid method signature signature types string vec size vec to array toarray types types method signature file format ljava lang string returns string representing type normal form param signature method signature type method class format exception classformatexception string method signature return type methodsignaturereturntype string signature class format exception classformatexception method signature return type methodsignaturereturntype signature method signature file format ljava lang string returns string representing type normal form param signature method signature param chopit shorten names type method string method signature return type methodsignaturereturntype string signature chopit class format exception classformatexception string type read type signature last index of lastindexof type signature to string signaturetostring signature substring chopit string index out of bounds exception stringindexoutofboundsexception class format exception classformatexception invalid method signature signature type string method signature to string methodsignaturetostring string signature string string access method signature to string methodsignaturetostring signature access string method signature to string methodsignaturetostring string signature string string access chopit method signature to string methodsignaturetostring signature access chopit method converts string java type declaration main string class format exception classformatexception parsed type invalid param signature method signature param method param access method access rights java type declaration class format exception classformatexception string method signature to string methodsignaturetostring string signature string string access chopit local variable table localvariabletable vars class format exception classformatexception signature char at charat class format exception classformatexception invalid method signature signature signature pieces params returntype last bracket pos lastbracketpos signature last index of lastindexof string parameters signature substring last bracket pos lastbracketpos string return type returntype signature substring last bracket pos lastbracketpos parameters ljava util list ljava lang string return type returntype signature parts dont lots substringing posn string buffer stringbuffer piece posn parameters length piece string buffer stringbuffer posn get signature from getsignaturefrom parameters piece string buffer stringbuffer buf string buffer stringbuffer string type access index of indexof read declarations signature char at charat class format exception classformatexception invalid method signature signature current string position signature char at charat result holder resultholder signature to string internal signaturetostringinternal signature substring chopit string param type get result getresult buf append param type vars local variable localvariable vars get local variable getlocalvariable buf append get name getname buf append arg equals param type equals param type buf append get consumed chars getconsumedchars read type type signature to string signaturetostring signature substring chopit string index out of bounds exception stringindexoutofboundsexception occur class format exception classformatexception invalid method signature signature tack extra buf length buf set length setlength buf length buf append empty string access access length type buf to string tostring replace occurences str param str string permute param string replaced param replacement string string object string replace string str string string string buffer stringbuffer buf string buffer stringbuffer str index of indexof replace str index of indexof append prefix buf append str substring append replacement buf append skip length chars length append string buf append str substring str buf to string tostring string index out of bounds exception stringindexoutofboundsexception system err println str converts signature string names compacted param signature convert human readable signature string signature to string signaturetostring string signature signature to string signaturetostring signature string signature to string signaturetostring string signature chopit result holder resultholder signature to string internal signaturetostringinternal signature chopit get result getresult method converts string java type declaration string class format exception classformatexception parsed type invalid param signature signature param chopit flag determines chopping executed java type declaration result holder resultholder signature to string internal signaturetostringinternal string signature chopit read processed chars processedchars signature char at charat result holder resultholder result holder resultholder result holder resultholder result holder resultholder result holder resultholder result holder resultholder full closing signature index of indexof jump correct signature length signature char at charat class format exception classformatexception invalid signature signature generic start genericstart signature index of indexof generic end genericend signature index of indexof generic start genericstart fixme asc lot work generics result holder resultholder signature to string internal signaturetostringinternal signature substring generic start genericstart generic end genericend chopit result holder resultholder retval result holder resultholder compact class name compactclassname signature substring generic start genericstart get result getresult chopit generic end genericend retval lblabla removed processed chars processedchars result holder resultholder retval result holder resultholder compact class name compactclassname signature substring chopit processed chars processedchars retval result holder resultholder result holder resultholder array declaration string buffer stringbuffer brackets consumed chars consumedchars accumulate brackets string buffer stringbuffer count opening brackets optional size argument signature char at charat brackets append consumed chars consumedchars string denotes field type result holder resultholder rest of it restofit signature to string internal signaturetostringinternal signature substring chopit type signature to string signaturetostring signature substring chopit consumed chars consumedchars rest of it restofit get consumed chars getconsumedchars result holder resultholder rest of it restofit get result getresult brackets to string tostring consumed chars consumedchars result holder resultholder class format exception classformatexception invalid signature signature string index out of bounds exception stringindexoutofboundsexception occur class format exception classformatexception invalid signature signature parse java type java lang string signature code format ljava lang string param type java type code signature string get signature getsignature string type string buffer stringbuffer buf string buffer stringbuffer chars type to char array tochararray delim loop chars length chars delim runtime exception runtimeexception illegal type type loop delim buf append chars brackets brackets count brackets countbrackets type substring type buf to string tostring buf set length setlength brackets buf append constants constants constants type names equals type buf append constants type names buf append type replace buf to string tostring type method signature defined constants param signature format type method signature constants type of method signature typeofmethodsignature string signature class format exception classformatexception signature char at charat class format exception classformatexception invalid method signature signature signature last index of lastindexof type of signature typeofsignature signature substring string index out of bounds exception stringindexoutofboundsexception class format exception classformatexception invalid method signature signature map opcode names opcode numbers constants aload aload search opcode searchopcode string to lower case tolowercase constants opcode names length constants opcode names equals convert signed unsigned negative values positive byte to short bytetoshort convert bytes hexidecimal string bytes hexidecimal string string to hex string tohexstring bytes string buffer stringbuffer buf string buffer stringbuffer bytes length byte to short bytetoshort bytes string hex integer to string tostring digit prepend buf append buf append hex bytes length buf append buf to string tostring string integer justified left filled fill characters param integer format param length length desired string param left justify format left param fill fill character formatted string format length left justify fill fillup integer to string tostring length left justify fill fillup length characters fill justify left param str string format param length length desired string param left justify format left param fill fill character formatted string string fillup string str length left justify fill len length str length buf len len buf length buf fill left justify str string buf string buf str equals size size length length size print array printarray print stream printstream object obj println print array printarray obj print array printarray print writer printwriter object obj println print array printarray obj string print array printarray object obj print array printarray obj string print array printarray object obj braces print array printarray obj braces string print array printarray object obj braces quote obj string buffer stringbuffer buf string buffer stringbuffer braces buf append obj length obj buf append quote obj to string tostring quote buf append obj length buf append braces buf append buf to string tostring character is java identifier part isjavaidentifierpart encode array java identifier string string characters encoding algorithm clever current ascii valid java identifier leave writes escape character ascii hexadecimal string range java identifier lowercase hexadecimal string range operation inflates original array roughly param bytes array convert param compress gzip minimize string string encode bytes compress ioexception compress byte array output stream bytearrayoutputstream baos byte array output stream bytearrayoutputstream gzipoutput stream gzipoutputstream gos gzipoutput stream gzipoutputstream baos gos write bytes bytes length gos close baos close bytes baos to byte array tobytearray char array writer chararraywriter caw char array writer chararraywriter java writer javawriter java writer javawriter caw bytes length normalize unsigned bytes write caw to string tostring decode string array param bytes array convert param uncompress gzip uncompress stream bytes decode string uncompress ioexception chars to char array tochararray char array reader chararrayreader car char array reader chararrayreader chars java reader javareader java reader javareader car byte array output stream bytearrayoutputstream bos byte array output stream bytearrayoutputstream read bos write bos close car close close bytes bos to byte array tobytearray uncompress gzipinput stream gzipinputstream gis gzipinput stream gzipinputstream byte array input stream bytearrayinputstream bytes rough estimate tmp bytes length count gis read tmp count bytes count system arraycopy tmp bytes count bytes free chars map free chars reverse map map escape map map map map map map map map decode characters bytes href utility html decode java lang string decode java reader javareader filter reader filterreader java reader javareader reader read ioexception read escape read normal escape read tmp integer parse int parseint string tmp special escape map read cbuf len ioexception len cbuf read len encode bytes valid java identifier characters href utility html encode encode java writer javawriter filter writer filterwriter java writer javawriter writer write ioexception is java identifier part isjavaidentifierpart escape write escape character write escape special escape free chars write map normal escape tmp integer to hex string tohexstring to char array tochararray tmp length write write tmp write tmp write tmp write cbuf len ioexception len write cbuf write string str len ioexception write str to char array tochararray len escape occurences newline chars quotes string convert string convertstring string label label to char array tochararray string buffer stringbuffer buf string buffer stringbuffer length buf append buf append buf append buf append buf append buf append buf to string tostring list get list of annotation names getlistofannotationnames annotation list get values getvalues list names array list arraylist iterator iterator has next hasnext element name value pair elementnamevaluepair element element name value pair elementnamevaluepair names add element get name string getnamestring names attribute get annotation attributes getannotationattributes constant pool gen constantpoolgen list vec vec size count visible countvisible count invisible countinvisible vec size annotation gen annotationgen annotation gen annotationgen vec is runtime visible isruntimevisible count visible countvisible count invisible countinvisible byte array output stream bytearrayoutputstream rva bytes rvabytes byte array output stream bytearrayoutputstream byte array output stream bytearrayoutputstream ria bytes riabytes byte array output stream bytearrayoutputstream data output stream dataoutputstream rva dos rvados data output stream dataoutputstream rva bytes rvabytes data output stream dataoutputstream ria dos riados data output stream dataoutputstream ria bytes riabytes rva dos rvados write short writeshort count visible countvisible ria dos riados write short writeshort count invisible countinvisible vec size annotation gen annotationgen annotation gen annotationgen vec is runtime visible isruntimevisible dump rva dos rvados dump ria dos riados rva dos rvados close ria dos riados close rva data rvadata rva bytes rvabytes to byte array tobytearray ria data riadata ria bytes riabytes to byte array tobytearray rva index rvaindex ria index riaindex rva data rvadata length rva index rvaindex add utf addutf runtime visible annotations runtimevisibleannotations ria data riadata length ria index riaindex add utf addutf runtime invisible annotations runtimeinvisibleannotations list new attributes newattributes array list arraylist rva data rvadata length new attributes newattributes add runtime visible annotations runtimevisibleannotations rva index rvaindex rva data rvadata length rva data rvadata get constant pool getconstantpool ria data riadata length new attributes newattributes add runtime invisible annotations runtimeinvisibleannotations ria index riaindex ria data riadata length ria data riadata get constant pool getconstantpool attribute new attributes newattributes to array toarray attribute ioexception system err println ioexception processing annotations print stack trace printstacktrace attribute get parameter annotation attributes getparameterannotationattributes constant pool gen constantpoolgen list vec vis count viscount vec length total vis count totalviscount invis count inviscount vec length total invis count totalinviscount vec length list vec iterator iter iterator iter has next hasnext annotation gen annotationgen element annotation gen annotationgen iter element is runtime visible isruntimevisible vis count viscount total vis count totalviscount invis count inviscount total invis count totalinviscount byte array output stream bytearrayoutputstream rva bytes rvabytes byte array output stream bytearrayoutputstream data output stream dataoutputstream rva dos rvados data output stream dataoutputstream rva bytes rvabytes rva dos rvados write byte writebyte vec length vec length rva dos rvados write short writeshort vis count viscount vis count viscount list vec iterator iter iterator iter has next hasnext annotation gen annotationgen element annotation gen annotationgen iter element is runtime visible isruntimevisible element dump rva dos rvados rva dos rvados close byte array output stream bytearrayoutputstream ria bytes riabytes byte array output stream bytearrayoutputstream data output stream dataoutputstream ria dos riados data output stream dataoutputstream ria bytes riabytes ria dos riados write byte writebyte vec length vec length ria dos riados write short writeshort invis count inviscount invis count inviscount list vec iterator iter iterator iter has next hasnext annotation gen annotationgen element annotation gen annotationgen iter element is runtime visible isruntimevisible element dump ria dos riados ria dos riados close rva data rvadata rva bytes rvabytes to byte array tobytearray ria data riadata ria bytes riabytes to byte array tobytearray rva index rvaindex ria index riaindex total vis count totalviscount rva index rvaindex add utf addutf runtime visible parameter annotations runtimevisibleparameterannotations total invis count totalinviscount ria index riaindex add utf addutf runtime invisible parameter annotations runtimeinvisibleparameterannotations list new attributes newattributes array list arraylist total vis count totalviscount new attributes newattributes add runtime visible parameter annotations runtimevisibleparameterannotations rva index rvaindex rva data rvadata length rva data rvadata get constant pool getconstantpool total invis count totalinviscount new attributes newattributes add runtime invisible parameter annotations runtimeinvisibleparameterannotations ria index riaindex ria data riadata length ria data riadata get constant pool getconstantpool attribute new attributes newattributes to array toarray attribute ioexception system err println ioexception processing parameter annotations print stack trace printstacktrace digit space result holder resultholder string result consumed result holder resultholder result holder resultholder result holder resultholder result holder resultholder result holder resultholder result holder resultholder result holder resultholder result holder resultholder result holder resultholder result holder resultholder result holder resultholder result holder resultholder result holder resultholder result holder resultholder result holder resultholder result holder resultholder result holder resultholder result holder resultholder result holder resultholder string result consumed string get result getresult result get consumed chars getconsumedchars consumed type of signature typeofsignature string signature class format exception classformatexception signature char at charat constants constants constants constants constants constants constants reference constants array constants constants constants class format exception classformatexception invalid method signature signature string index out of bounds exception stringindexoutofboundsexception class format exception classformatexception invalid method signature signature string read class type signature from readclasstypesignaturefrom string signature string buffer stringbuffer string buffer stringbuffer read class type signature from readclasstypesignaturefrom signature to string tostring read class type signature from readclasstypesignaturefrom string signature posn string buffer stringbuffer result chopit idx posn signature char at charat idx result append result append result append result append result append result append result append result append result append idx next semi idx nextsemiidx signature index of indexof idx result append signature substring idx next semi idx nextsemiidx next semi idx nextsemiidx posn result append read class type signature from readclasstypesignaturefrom signature idx result chopit result append read class type signature from readclasstypesignaturefrom signature idx result chopit result append parameterized idx semicolon idxsemicolon signature index of indexof idx idx angly idxangly signature index of indexof idx end of sig endofsig idx semicolon idxsemicolon idx angly idxangly idx angly idxangly end of sig endofsig end of sig endofsig idx angly idxangly parameterized string signature substring idx end of sig endofsig string compact class name compactclassname chopit result append idx end of sig endofsig parameterized idx result append signature char at charat idx idx read class type signature from readclasstypesignaturefrom signature idx result chopit signature char at charat idx result append result append idx signature char at charat idx runtime exception runtimeexception find signature signature char at charat idx idx idx posn dim signature char at charat idx dim idx idx read class type signature from readclasstypesignaturefrom signature idx result chopit dim result append dim idx posn class format exception classformatexception invalid signature signature string index out of bounds exception stringindexoutofboundsexception class format exception classformatexception invalid signature signature count brackets countbrackets string brackets chars brackets to char array tochararray count open chars length chars open runtime exception runtimeexception illegally nested brackets brackets open open runtime exception runtimeexception illegally nested brackets brackets open count open runtime exception runtimeexception illegally nested brackets brackets count string code to string codetostring byte sequence bytesequence bytes constant pool constantpool constant pool verbose ioexception opcode bytes read unsigned byte readunsignedbyte offset high npairs vindex constant match jump table pad bytes offset string buffer stringbuffer buf string buffer stringbuffer constants opcode names opcode opcode constants tableswitch opcode constants lookupswitch remainder bytes get index getindex pad bytes remainder remainder pad bytes bytes read byte readbyte system err println warning padding constants opcode names opcode offset bytes read int readint opcode constants tableswitch bytes read int readint high bytes read int readint offset bytes get index getindex pad bytes offset offset buf append tdefault offset high high jump table high jump table length jump table offset bytes read int readint buf append jump table jump table length buf append buf append constants lookupswitch npairs bytes read int readint offset bytes get index getindex pad bytes match npairs jump table npairs offset offset buf append tdefault offset npairs npairs npairs match bytes read int readint jump table offset bytes read int readint buf append match jump table npairs buf append buf append constants constants ifeq constants ifge constants ifgt constants ifle constants iflt constants jsr constants ifne constants ifnonnull constants ifnull constants acmpeq constants acmpne constants icmpeq constants icmpge constants icmpgt constants icmple constants icmplt constants icmpne buf append bytes get index getindex bytes read short readshort constants constants jsr buf append bytes get index getindex bytes read int readint constants aload constants astore constants dload constants dstore constants fload constants fstore constants iload constants istore constants lload constants lstore constants ret wide vindex bytes read unsigned short readunsignedshort wide vindex bytes read unsigned byte readunsignedbyte buf append vindex constants wide wide buf append wide constants newarray buf append constants type names bytes read byte readbyte constants getfield constants getstatic constants putfield constants putstatic bytes read unsigned short readunsignedshort buf append constant pool constant to string constanttostring constants constant fieldref verbose constants constants checkcast buf append constants bytes read unsigned short readunsignedshort buf append constant pool constant to string constanttostring constants constant verbose constants invokespecial constants invokestatic constants invokevirtual bytes read unsigned short readunsignedshort buf append constant pool constant to string constanttostring constants constant methodref verbose constants invokeinterface bytes read unsigned short readunsignedshort nargs bytes read unsigned byte readunsignedbyte buf append constant pool constant to string constanttostring constants constant interface methodref interfacemethodref verbose nargs bytes read unsigned byte readunsignedbyte constants ldc constants ldc bytes read unsigned short readunsignedshort buf append constant pool constant to string constanttostring constant pool get constant getconstant get tag gettag verbose constants ldc bytes read unsigned byte readunsignedbyte buf append constant pool constant to string constanttostring constant pool get constant getconstant get tag gettag verbose constants anewarray bytes read unsigned short readunsignedshort buf append compact class name compactclassname constant pool get constant string getconstantstring constants constant verbose constants multianewarray bytes read unsigned short readunsignedshort dimensions bytes read unsigned byte readunsignedbyte buf append compact class name compactclassname constant pool get constant string getconstantstring constants constant dimensions verbose constants iinc wide vindex bytes read unsigned short readunsignedshort constant bytes read short readshort wide vindex bytes read unsigned byte readunsignedbyte constant bytes read byte readbyte buf append vindex constant constants operands opcode constants type operands opcode length buf append constants type operands opcode constants buf append bytes read byte readbyte constants buf append bytes read short readshort constants buf append bytes read int readint system err println unreachable reached system exit buf to string tostring pow