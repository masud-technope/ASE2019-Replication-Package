verbatim java xalan extensions supporting doc book docbook verbatim environments nwalsh xalan java util stack java util string tokenizer stringtokenizer org xml sax org xml sax helpers attributes impl attributesimpl org dom org dom traversal node iterator nodeiterator org apache xerces dom org apache xpath objects xobject org apache xpath xpath org apache xpath xpath context xpathcontext org apache xpath node set nodeset org apache xpath domhelper org apache xalan extensions xslprocessor context xslprocessorcontext org apache xalan extensions expression context expressioncontext org apache xalan transformer transformer impl transformerimpl org apache xalan templates stylesheet root stylesheetroot org apache xalan templates elem extension call elemextensioncall org apache xalan templates output properties outputproperties org apache xalan res xslterror resources xslterrorresources org apache xml utils dombuilder org apache xml utils att list attlist org apache xml utils qname javax xml transform stream stream result streamresult javax xml transform transformer exception transformerexception javax xml parsers document builder documentbuilder javax xml parsers document builder factory documentbuilderfactory javax xml parsers parser configuration exception parserconfigurationexception nwalsh xalan callout nwalsh xalan params xalan extensions supporting doc book docbook verbatim environments verbatim java isberg exp copyright norman walsh href http xml apache org xalan xalan implementation features impractical implement xslt numbering callouts numbering number lines numberlines family functions takes result tree fragment assumed contents formatted verbatim element doc book docbook programlisting screen address literallayout synopsis returns result tree fragment decorated numbers callouts insert callouts insertcallouts family functions takes areaspec result tree fragment assumed contents formatted verbatim element doc book docbook programlisting screen address literallayout synopsis returns result tree fragment decorated callouts change log initial release author norman walsh href mailto ndw nwalsh ndw nwalsh version verbatim java isberg exp verbatim stack hold open elements walking rtf stack element stack elementstack stack hold temporarily closed elements stack temp stack tempstack current number line number linenumber current column number col number colnumber modulus numbering modulus numbered modulus width characters numbers padding width separator number verbatim text string separator sorted array callouts areaspec callout callout number callouts callout array callout count calloutcount pointer track position callout array callout pos calloutpos path graphical callout decorations string graphics path graphicspath extension graphical callout decorations string graphics ext graphicsext largest callout number represented graphically graphics max graphicsmax graphic callouts external graphics imgs graphics fo graphicsfo string fo uri fouri http org xsl format string xh uri xhuri http org xhtml constructor verbatim methods constructor verbatim number lines verbatim environment method adds numbers result tree fragment newline occurs text node assumed start numbered subsequent xalan mod xalanmod numbered xalan mod xalanmod lines numbered xalan mod xalanmod lines environment numbered xalan mod xalanmod linenumbering every nth everynth parameter number justified string xalan width xalanwidth characters number environment fit width width automatically increased smallest hold number attempt enumerate lines environment lines automatically environment xalan width xalanwidth linenumbering width parameter xalan sep xalansep string inserted number original program listing lines numbered preceded xalan width xalanwidth blank string separator xalan sep xalansep linenumbering separator parameter inline markup breaks markup required open elements closed reopened reopened elements attributes originals attributes duplicated param xalan rtf xalanrtf result tree fragment verbatim environment modified result tree fragment document fragment documentfragment number lines numberlines expression context expressioncontext context node iterator nodeiterator xalan ni xalanni xalan mod xalanmod params get int getint context linenumbering every nth everynth xalan width xalanwidth params get int getint context linenumbering width string xalan sep xalansep params get string getstring context linenumbering separator document fragment documentfragment xalan rtf xalanrtf document fragment documentfragment xalan ni xalanni next node nextnode num lines numlines count line breaks countlinebreaks xalan rtf xalanrtf document builder factory documentbuilderfactory doc factory docfactory document builder factory documentbuilderfactory new instance newinstance document builder documentbuilder doc builder docbuilder doc builder docbuilder doc factory docfactory new document builder newdocumentbuilder parser configuration exception parserconfigurationexception system println pce xalan rtf xalanrtf document doc doc builder docbuilder new document newdocument document fragment documentfragment doc create document fragment createdocumentfragment dombuilder dombuilder doc element stack elementstack stack line number linenumber modulus num lines numlines xalan mod xalanmod xalan mod xalanmod width xalan width xalanwidth separator xalan sep xalansep log num lines numlines math log num lines numlines math log width log num lines numlines width math floor log num lines numlines line number fragment linenumberfragment xalan rtf xalanrtf count number lines verbatim environment method walks nodes document fragment documentfragment returns number lines breaks param node root tree walk count line breaks countlinebreaks node node num lines numlines node get node type getnodetype node document fragment node node get node type getnodetype node document node node get node type getnodetype node element node node child node get first child getfirstchild child num lines numlines count line breaks countlinebreaks child child child get next sibling getnextsibling node get node type getnodetype node text node string text node get node value getnodevalue walk text node newlines pos count count text length count text char at charat count num lines numlines nop num lines numlines build document fragment documentfragment numbered lines method work numbering lines verbatim environment recursively walks tree nodes copying structure rtf text nodes examined lines modified requested global numbering parameters called rtf empty document fragment documentfragment node child result tree fragment existing formatted verbatim text param rtf verbatim environment numbered lines param node root tree copy line number fragment linenumberfragment dombuilder rtf node node node get node type getnodetype node document fragment node node get node type getnodetype node document node node child node get first child getfirstchild child line number fragment linenumberfragment rtf child child child get next sibling getnextsibling node get node type getnodetype node element node string node get namespace uri getnamespaceuri string local name localname node get local name getlocalname string element node get tag name gettagname rtf start element startelement local name localname copy attributes copyattributes element node element stack elementstack push node node child node get first child getfirstchild child line number fragment linenumberfragment rtf child child child get next sibling getnextsibling node get node type getnodetype node text node string text node get node value getnodevalue line number linenumber numbered format line number formatlinenumber rtf line number linenumber walk text node newlines chars text to char array tochararray pos count count text length count text char at charat count pos rtf characters chars pos pos close open elements closeopenelements rtf copy newline output chars pos text char at charat count rtf characters chars pos pos add number format line number formatlinenumber rtf line number linenumber open closed elements openclosedelements rtf chars pos text char at charat count pos rtf characters chars pos node get node type getnodetype node comment node string text node get node value getnodevalue chars text to char array tochararray rtf comment chars text length node get node type getnodetype node processing instruction node rtf processing instruction processinginstruction node get node name getnodename node get node value getnodevalue system println warning unexpected node type line number fragment linenumberfragment node get node type getnodetype node element node string node get namespace uri getnamespaceuri string local name localname node get local name getlocalname string element node get tag name gettagname rtf end element endelement local name localname element stack elementstack pop saxexception system println sax exception line number fragment linenumberfragment add formatted number result tree fragment method examines global parameters control number presentation modulus width separator adds text result tree fragment param rtf verbatim environment numbered lines param line number linenumber number current format line number formatlinenumber dombuilder rtf line number linenumber string lno line number linenumber modulus line number linenumber modulus lno line number linenumber lno length width lno lno lno separator chars lno to char array tochararray rtf characters chars lno length saxexception system println sax exception format line number formatlinenumber insert text callouts verbatim environment method examines areaset area elements supplied areaspec decorates supplied result tree fragment callout markers label attribute supplied area content label callout number surrounded parenthesis callouts numbered document order area areaset number linecolumn linerange units supported unit specifed linecolumn assumed callout decoration appears default column defaultcolumn lines padded blanks reach column callouts located verbatim environment callouts inserted character column occur param areaspec node set areaspecnodeset source node areaspec param xalan rtf xalanrtf result tree fragment verbatim environment param default column defaultcolumn column callouts modified result tree fragment insert graphical callouts verbatim environment method examines areaset area elements supplied areaspec decorates supplied result tree fragment callout markers label attribute supplied area content label callout number callouts numbered document order area areaset number callout number greater g max gmax callout generated pre img src g path gpath conumber g ext gext alt conumber pre callout number surrounded parenthesis linecolumn linerange units supported unit specifed linecolumn assumed callout decoration appears default column defaultcolumn lines padded blanks reach column callouts located verbatim environment callouts inserted character column occur param areaspec node set areaspecnodeset source node areaspec param xalan rtf xalanrtf result tree fragment verbatim environment param default column defaultcolumn column callouts param g path gpath path callout graphics param g ext gext extension callout graphics param g max gmax largest number represented graphic param use fo usefo external graphics produced opposed html imgs bogus extension figure haven figured modified result tree fragment document fragment documentfragment insert callouts insertcallouts expression context expressioncontext context node iterator nodeiterator areaspec node set areaspecnodeset node iterator nodeiterator xalan ni xalanni string type params get string getstring context stylesheet result type use fo usefo type equals default column defaultcolumn params get int getint context callout defaultcolumn params get boolean getboolean context callout graphics string g path gpath params get string getstring context callout graphics path string g ext gext params get string getstring context callout graphics extension g max gmax params get int getint context callout graphics number limit insert graphic callouts insertgraphiccallouts areaspec node set areaspecnodeset xalan ni xalanni default column defaultcolumn g path gpath g ext gext g max gmax use fo usefo params get boolean getboolean context callout unicode u start ustart params get int getint context callout unicode start character u max umax params get int getint context callout unicode number limit insert unicode callouts insertunicodecallouts areaspec node set areaspecnodeset xalan ni xalanni default column defaultcolumn u start ustart u max umax use fo usefo params get boolean getboolean context callout dingbats d max dmax insert dingbat callouts insertdingbatcallouts areaspec node set areaspecnodeset xalan ni xalanni default column defaultcolumn d max dmax use fo usefo insert text callouts inserttextcallouts areaspec node set areaspecnodeset xalan ni xalanni default column defaultcolumn use fo usefo document fragment documentfragment insert graphic callouts insertgraphiccallouts node iterator nodeiterator areaspec node set areaspecnodeset node iterator nodeiterator xalan ni xalanni default column defaultcolumn string g path gpath string g ext gext g max gmax use fo usefo format graphic callout formatgraphiccallout fgc format graphic callout formatgraphiccallout g path gpath g ext gext g max gmax use fo usefo insert callouts insertcallouts areaspec node set areaspecnodeset xalan ni xalanni default column defaultcolumn fgc document fragment documentfragment insert unicode callouts insertunicodecallouts node iterator nodeiterator areaspec node set areaspecnodeset node iterator nodeiterator xalan ni xalanni default column defaultcolumn u start ustart u max umax use fo usefo format unicode callout formatunicodecallout fuc format unicode callout formatunicodecallout u start ustart u max umax use fo usefo insert callouts insertcallouts areaspec node set areaspecnodeset xalan ni xalanni default column defaultcolumn fuc document fragment documentfragment insert dingbat callouts insertdingbatcallouts node iterator nodeiterator areaspec node set areaspecnodeset node iterator nodeiterator xalan ni xalanni default column defaultcolumn g max gmax use fo usefo format dingbat callout formatdingbatcallout fdc format dingbat callout formatdingbatcallout g max gmax use fo usefo insert callouts insertcallouts areaspec node set areaspecnodeset xalan ni xalanni default column defaultcolumn fdc document fragment documentfragment insert text callouts inserttextcallouts node iterator nodeiterator areaspec node set areaspecnodeset node iterator nodeiterator xalan ni xalanni default column defaultcolumn use fo usefo format text callout formattextcallout ftc format text callout formattextcallout use fo usefo insert callouts insertcallouts areaspec node set areaspecnodeset xalan ni xalanni default column defaultcolumn ftc document fragment documentfragment insert callouts insertcallouts node iterator nodeiterator areaspec node set areaspecnodeset node iterator nodeiterator xalan ni xalanni default column defaultcolumn format callout formatcallout f callout fcallout document fragment documentfragment xalan rtf xalanrtf document fragment documentfragment xalan ni xalanni next node nextnode callout callout callout count calloutcount callout pos calloutpos line number linenumber col number colnumber walk areaspec calculate position callouts areaspec areaset plco coords area plco coords area plco coords areaset area plco ret coords area plco dest coords areaspec pos co num conum in area set inareaset node node areaspec node set areaspecnodeset next node nextnode node node get first child getfirstchild node node get node type getnodetype node element node node get node name getnodename equals areaset co num conum node area node get first child getfirstchild area area get node type getnodetype node element node area get node name getnodename equals area add callout addcallout co num conum area default column defaultcolumn system println unexpected element areaset area get node name getnodename area area get next sibling getnextsibling node get node name getnodename equals ignore case equalsignorecase area co num conum add callout addcallout co num conum node default column defaultcolumn system println unexpected element areaspec node get node name getnodename node node get next sibling getnextsibling sort java util arrays sort callout callout count calloutcount document builder factory documentbuilderfactory doc factory docfactory document builder factory documentbuilderfactory new instance newinstance document builder documentbuilder doc builder docbuilder doc builder docbuilder doc factory docfactory new document builder newdocumentbuilder parser configuration exception parserconfigurationexception system println pce xalan rtf xalanrtf document doc doc builder docbuilder new document newdocument document fragment documentfragment doc create document fragment createdocumentfragment dombuilder dombuilder doc element stack elementstack stack callout fragment calloutfragment xalan rtf xalanrtf f callout fcallout build fragment value fragmentvalue callout decorations method work adding callouts verbatim environment recursively walks tree nodes copying structure rtf text nodes examined position callouts global callout parameters called rtf empty fragment value fragmentvalue node child result tree fragment existing formatted verbatim text param rtf verbatim environment numbered lines param node root tree copy callout fragment calloutfragment dombuilder rtf node node format callout formatcallout f callout fcallout node get node type getnodetype node document fragment node node get node type getnodetype node document node node child node get first child getfirstchild child callout fragment calloutfragment rtf child f callout fcallout child child get next sibling getnextsibling node get node type getnodetype node element node string node get namespace uri getnamespaceuri string local name localname node get local name getlocalname string element node get tag name gettagname rtf start element startelement local name localname copy attributes copyattributes element node element stack elementstack push node node child node get first child getfirstchild child callout fragment calloutfragment rtf child f callout fcallout child child get next sibling getnextsibling node get node type getnodetype node text node string text node get node value getnodevalue chars text to char array tochararray pos count count text length count callout pos calloutpos callout count calloutcount callout callout pos calloutpos get line getline line number linenumber callout callout pos calloutpos get column getcolumn col number colnumber pos rtf characters chars pos pos close open elements closeopenelements rtf callout pos calloutpos callout count calloutcount callout callout pos calloutpos get line getline line number linenumber callout callout pos calloutpos get column getcolumn col number colnumber f callout fcallout format callout formatcallout rtf callout callout pos calloutpos callout pos calloutpos open closed elements openclosedelements rtf text char at charat count pad callout pos calloutpos callout count calloutcount callout callout pos calloutpos get line getline line number linenumber callout callout pos calloutpos get column getcolumn col number colnumber pos rtf characters chars pos pos close open elements closeopenelements rtf callout pos calloutpos callout count calloutcount callout callout pos calloutpos get line getline line number linenumber callout callout pos calloutpos get column getcolumn col number colnumber format pad formatpad rtf callout callout pos calloutpos get column getcolumn col number colnumber col number colnumber callout callout pos calloutpos get column getcolumn callout pos calloutpos callout count calloutcount callout callout pos calloutpos get line getline line number linenumber callout callout pos calloutpos get column getcolumn col number colnumber f callout fcallout format callout formatcallout rtf callout callout pos calloutpos callout pos calloutpos open closed elements openclosedelements rtf line number linenumber col number colnumber col number colnumber chars pos text char at charat count pos rtf characters chars pos node get node type getnodetype node comment node string text node get node value getnodevalue chars text to char array tochararray rtf comment chars text length node get node type getnodetype node processing instruction node rtf processing instruction processinginstruction node get node name getnodename node get node value getnodevalue system println warning unexpected node type callout fragment calloutfragment node get node type getnodetype node get node name getnodename node get node type getnodetype node element node string node get namespace uri getnamespaceuri string local name localname node get local name getlocalname string element node get tag name gettagname rtf end element endelement local name localname element stack elementstack pop nop saxexception system println sax exception callout fragment calloutfragment add callout global callout array method examines callout area adds global callout array interpreted linecolumn linerange units supported unit specifed linecolumn assumed callout decoration appears default column defaultcolumn param co num conum callout number param node area param default column defaultcolumn column callouts add callout addcallout co num conum node node default column defaultcolumn element area element node string units area get attribute getattribute units string other units otherunits area get attribute getattribute otherunits string coords area get attribute getattribute coords type string other type othertype units units equals linecolumn type callout column units equals linerange type callout range units equals linecolumnpair type callout column pair units equals calspair type callout cals pair type callout other type othertype other units otherunits type callout column type callout range system println linecolumn linerange units supported coords system println coords interpret coordinates string tokenizer stringtokenizer string tokenizer stringtokenizer coords token count tokencount has more tokens hasmoretokens token count tokencount token count tokencount system println unparseable coordinates string token next token nexttoken coord integer parse int parseint token coord token count tokencount coord number format exception numberformatexception system println unparseable coordinate blow array callout count calloutcount callout length callout bigger callout callout count calloutcount count count callout length count bigger count callout count callout bigger add callout token count tokencount type callout range count count count callout callout count calloutcount callout co num conum area count default column defaultcolumn type assume linecolumn callout callout count calloutcount callout co num conum area type number assume callout callout count calloutcount callout co num conum area default column defaultcolumn type add blanks result tree fragment method adds num blanks numblanks result tree fragment pad lines callouts occur existing characater param rtf verbatim environment numbered lines param num blanks numblanks number blanks add format pad formatpad dombuilder rtf num blanks numblanks chars num blanks numblanks count count num blanks numblanks count chars count rtf characters chars num blanks numblanks saxexception system println sax exception format callout formatcallout close open elements closeopenelements dombuilder rtf saxexception close open elements temp stack tempstack stack element stack elementstack empty node elem node element stack elementstack pop string elem get namespace uri getnamespaceuri string local name localname elem get local name getlocalname string element elem get tag name gettagname html pre div don duplicate element stack elementstack empty equals fo uri fouri local name localname equals block local name localname equals ignore case equalsignorecase pre equals xh uri xhuri local name localname equals pre local name localname equals ignore case equalsignorecase div equals xh uri xhuri local name localname equals div element stack elementstack push elem rtf end element endelement local name localname temp stack tempstack push elem open closed elements openclosedelements dombuilder rtf saxexception reopen elements closed temp stack tempstack empty node elem node temp stack tempstack pop string elem get namespace uri getnamespaceuri string local name localname elem get local name getlocalname string element elem get tag name gettagname named node map namednodemap dom attr domattr elem get attributes getattributes attributes impl attributesimpl attr attributes impl attributesimpl acount acount dom attr domattr get length getlength acount node dom attr domattr item acount http org xhtml local name localname equals ignore case equalsignorecase get local name getlocalname equals ignore case equalsignorecase skip attribute attr add attribute addattribute get namespace uri getnamespaceuri get local name getlocalname get node name getnodename cdata get node value getnodevalue rtf start element startelement local name localname attr element stack elementstack push elem temp stack tempstack attributes copy attributes copyattributes element node attributes impl attributesimpl attrs attributes impl attributesimpl named node map namednodemap nnm node get attributes getattributes count count nnm get length getlength count attr attr attr nnm item count string attr get name getname starts with startswith xmlns equals xmlns skip don love attrs add attribute addattribute attr get namespace uri getnamespaceuri attr get name getname attr get name getname cdata attr get value getvalue attrs