copyright ibm corporation rights reserved program accompanying materials terms common license accompanies distribution http eclipse org legal cpl html contributors adrian colyer org aspectj tools ajc java byte array output stream bytearrayoutputstream java file java filename filter filenamefilter java ioexception java print stream printstream java util array list arraylist java util list java util string tokenizer stringtokenizer junit framework assertion failed error assertionfailederror org aspectj bridge abort exception abortexception org aspectj bridge icommand org aspectj bridge imessage org aspectj bridge imessage handler imessagehandler org aspectj bridge message handler messagehandler org aspectj bridge imessage kind org aspectj bridge context compilation and weaving context compilationandweavingcontext org aspectj util file util fileutil ajc intended unit test suite drives aspect j aspectj compiler check compilation compilations sandbox created temp ajc sandbox ajcsandbox tmp ajc sandbox ajcsandbox depending platform expected usage ajc test case testcase superclass ajc test case ajctestcase helper methods conveniently drive base functions exposed org aspectj tools ajc ajc test case ajctestcase ajc string sandbox ajc sandbox ajcsandbox string tester path file separator testing client file separator bin file path separator pathseparator file separator runtime file separator bin file path separator pathseparator file separator aspectj file separator bin file path separator pathseparator file separator lib file separator junit file separator junit jar file path separator pathseparator file separator bridge file separator bin file path separator pathseparator file separator loadtime file separator bin file path separator pathseparator file separator weaver file separator bin file path separator pathseparator file separator weaver file separator bin bin directories types jars classpath file path separator pathseparator file separator build file separator jars file separator bridge jar file path separator pathseparator file separator build file separator jars file separator util jar file path separator pathseparator file separator build file separator jars file separator loadtime jar file path separator pathseparator file separator build file separator jars file separator weaver jar file path separator pathseparator file separator build file separator jars file separator weaver jar file path separator pathseparator file separator build file separator jars file separator asm jar file path separator pathseparator file separator lib file separator test file separator testing client jar hmmm point build jar file path separator pathseparator file separator lib file separator test file separator aspectjrt jar compilation result compilationresult result file sandbox file base dir basedir main main string ajc args ajcargs incremental stage incrementalstage should empty sandbox shouldemptysandbox ajc command controller ajccommandcontroller controller system get property getproperty org aspectj tools ajc ajc verbose equals verbose constructs ajc instance aspect j aspectj compiler ajc main main controller ajc command controller ajccommandcontroller main set controller setcontroller controller call code compile code creates sandbox temp ajc sandbox ajcsandbox ajt testxxx ajttestxxx tmp tmp ajc sandbox ajcsandbox ajc testxxx ajctestxxx tmp depending platform write test performs multiple incremental compiles building previous compilations empty sandbox compile subsequent compiles test directory contents set should empty sandbox setshouldemptysandbox empty should empty sandbox shouldemptysandbox empty call compiler arguments args pass ajc command compile returned code compilation result compilationresult code easy testing compilation sandbox temp ajc sandbox ajcsandbox aj testxxx ajtestxxx tmp tmp ajc sandbox ajcsandbox ajc testxxx ajctestxxx tmp depending platform compiler arguments adapted sandbox file directory listed argument source file component inpath aspectpath sourceroots classpath file absolute path left unchanged file relative path base directory set base dir setbasedir files directories copied base directory sandbox compiler arguments adjusted reflect location base dir basedir tests compile command ajc src java src java files pre tests src java java pre copied pre ajc sandbox ajcsandbox ajc testxxx ajctestxxx tmp src java java pre classpath classpath arguments classpath include sandbox directory testing client bin tester runtime bin aspect j aspectj runtime classpath relative directories relative sandbox testing client runtime bin directories output directory arguments output directory sandbox directory path relative relative sandbox param args compiler arguments compilation result compilationresult object messages produced compiler description ajc command issued standard output error compile excluding messages separately ioexception org aspectj tools ajc compilation result compilationresult compilation result compilationresult compile string args ioexception incremental stage incrementalstage compile args compilation result compilationresult compile string args is incremental isincremental ioexception result ajc args ajcargs args byte array output stream bytearrayoutputstream byte array output stream bytearrayoutputstream print stream printstream pout print stream printstream byte array output stream bytearrayoutputstream err byte array output stream bytearrayoutputstream print stream printstream perr print stream printstream err print stream printstream system out systemout system print stream printstream system err systemerr system err system set out setout pout system set err seterr perr list fails array list arraylist list errors array list arraylist list warnings array list arraylist list infos array list arraylist list weaves array list arraylist is incremental isincremental should empty sandbox shouldemptysandbox create empty sandbox createemptysandbox args adjust to sandbox adjusttosandbox args is incremental isincremental message handler messagehandler holder message handler messagehandler holder set interceptor setinterceptor abort interceptor abortinterceptor main set holder setholder holder incremental stage incrementalstage has specified incremental hasspecifiedincremental args sleep preparing sandbox incremental stage notes thread sleep exception is incremental isincremental controller do incremental doincremental holder main run main runmain args add messages to addmessagesto infos holder get messages getmessages imessage info add messages to addmessagesto warnings holder get warnings getwarnings add messages to addmessagesto errors holder get errors geterrors add messages to addmessagesto fails holder get messages getmessages imessage fail add messages to addmessagesto weaves holder get messages getmessages imessage weaveinfo string std out stdout string to byte array tobytearray string std err stderr string err to byte array tobytearray result compilation result compilationresult args std out stdout std err stderr infos errors warnings fails weaves system set out setout system out systemout system set err seterr system err systemerr verbose system err println result get standard error getstandarderror system println result get standard output getstandardoutput system println result result has specified incremental hasspecifiedincremental string args args args length args equals incremental compiling time compile incremental option subsequent incremental compiles calling method illegal state exception illegalstateexception call method compile incremental option compilation result compilationresult increment ioexception compilation result compilationresult do incremental compile doincrementalcompile ioexception ajc args ajcargs is incremental isincremental ajc args ajcargs illegal state exception illegalstateexception incremental compile incremental compile place incremental stage incrementalstage compile ajc args ajcargs result compile incremental compile compile do incremental compile doincrementalcompile methods compilation result compilationresult get last compilation result getlastcompilationresult result sandbox directory compilation file get sandbox directory getsandboxdirectory sandbox create empty sandbox createemptysandbox sandbox base directory relative relative paths arguments compile interpreted set base dir setbasedir file dir dir dir is directory isdirectory illegal argument exception illegalargumentexception dir get path getpath directory base dir basedir dir add messages to addmessagesto list a list alist imessage messages messages length a list alist add messages is incremental isincremental string args args length args trim equals incremental create empty sandbox createemptysandbox string system get property getproperty file temp dir tempdir documents settings failed test starts with startswith windows temp dir tempdir file temp temp dir tempdir exists temp dir tempdir mkdir temp dir tempdir file tmp file sandbox root sandboxroot file temp dir tempdir sandbox sandbox root sandboxroot exists sandbox root sandboxroot mkdir file util fileutil delete contents deletecontents sandbox root sandboxroot sandbox file create temp file createtempfile ajc test ajctest tmp sandbox root sandboxroot sandbox delete sandbox mkdir ioexception io ex ioex assertion failed error assertionfailederror unable create sandbox directory test relative file dir absolute sandbox add tester path classpath string adjust to sandbox adjusttosandbox string args do copy docopy ioexception string new args newargs string args length has classpath hasclasspath has outdir hasoutdir args length new args newargs args file util fileutil has source suffix hassourcesuffix args file file args new args newargs file base dir basedir args get absolute path getabsolutepath quicker new args newargs adjust file or dir adjustfileordir do copy docopy get absolute path getabsolutepath args equals aspectpath args equals inpath args equals injars args equals outjar args equals classpath args equals sourceroots args equals xlintfile args equals extdirs args equals args length new args newargs args string buffer stringbuffer buff string buffer stringbuffer copy this time copythistime do copy docopy args equals copy this time copythistime has outdir hasoutdir string tokenizer stringtokenizer str tok strtok string tokenizer stringtokenizer args file path separator pathseparator str tok strtok has more tokens hasmoretokens file file str tok strtok next token nexttoken buff append adjust file or dir adjustfileordir copy this time copythistime get absolute path getabsolutepath str tok strtok has more tokens hasmoretokens buff append file path separator pathseparator new args newargs buff to string tostring args equals classpath has classpath hasclasspath new args newargs new args newargs file path separator pathseparator tester path file path separator pathseparator get sandbox directory getsandboxdirectory get absolute path getabsolutepath resource file file file args exists new args newargs adjust file or dir adjustfileordir do copy docopy get absolute path getabsolutepath has classpath hasclasspath string old args oldargs new args newargs new args newargs string old args oldargs length system arraycopy old args oldargs new args newargs old args oldargs length new args newargs old args oldargs length classpath new args newargs old args oldargs length tester path file path separator pathseparator get sandbox directory getsandboxdirectory get absolute path getabsolutepath has outdir hasoutdir string old args oldargs new args newargs new args newargs string old args oldargs length system arraycopy old args oldargs new args newargs old args oldargs length new args newargs old args oldargs length new args newargs old args oldargs length get sandbox directory getsandboxdirectory get path getpath new args newargs file adjust file or dir adjustfileordir file do copy docopy ioexception file file ret is absolute isabsolute ret file sandbox get path getpath file from parent fromparent get parent file getparentfile string relative to path relativetopath from parent fromparent from parent fromparent get path getpath file separator base dir basedir file base dir basedir get path getpath exists ret do copy docopy copied err event files is file isfile string prefix get name getname substring get name getname last index of lastindexof string to copy tocopy get parent file getparentfile list filename filter filenamefilter accept file dir string index of indexof string to match tomatch substring last index of lastindexof to match tomatch equals prefix to copy tocopy length string to path topath relative to path relativetopath to copy tocopy file sandbox to path topath file util fileutil copy file copyfile file get parent file getparentfile to copy tocopy file util fileutil copy file copyfile ret ret drive incremental compilation easily unit test ajc command controller ajccommandcontroller main command controller commandcontroller icommand command javadoc org aspectj tools ajc main command controller commandcontroller do repeat command dorepeatcommand do repeat command dorepeatcommand icommand command command command ensure control returns caller javadoc org aspectj tools ajc main command controller commandcontroller running running do incremental doincremental imessage handler imessagehandler handler command illegal argument exception illegalargumentexception repeat command executed command repeat command repeatcommand handler abort interceptor abortinterceptor imessage handler imessagehandler handle message handlemessage imessage message abort exception abortexception message get kind getkind imessage abort system err println abort message received system err println compilation and weaving context compilationandweavingcontext get current context getcurrentcontext system err println message get message getmessage message get thrown getthrown system err println caused message get thrown getthrown to string tostring message accumulate is ignoring isignoring kind kind kind imessage abort dont ignore dontignore kind kind