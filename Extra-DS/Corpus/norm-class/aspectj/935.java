copyright ibm corporation rights reserved program accompanying materials terms common license accompanies distribution http eclipse org legal cpl html contributors adrian colyer org aspectj testing java file java file input stream fileinputstream java file output stream fileoutputstream java ioexception java output stream outputstream java util array list arraylist java util collections java util iterator java util list java util string tokenizer stringtokenizer java util jar jar entry jarentry java util jar jar output stream jaroutputstream org aspectj tools ajc ajc test case ajctestcase org aspectj tools ajc compilation result compilationresult author colyer todo change template generated type comment window preferences java code style code templates weave spec weavespec compile spec compilespec string classes files classesfiles string aspects files aspectsfiles list class files from classes classfilesfromclasses javadoc org aspectj testing itest step iteststep execute org aspectj tools ajc ajc test case ajctestcase execute ajc test case ajctestcase in test case intestcase string fail message failmessage test get test gettest get title gettitle failed file base file get base dir getbasedir class files from classes classfilesfromclasses array list arraylist set files setfiles classes files classesfiles string args build args buildargs compilation result compilationresult result in test case intestcase ajc base args in test case intestcase assert no messages assertnomessages result fail message failmessage file sandbox in test case intestcase get sandbox directory getsandboxdirectory create jar createjar sandbox classes jar in test case intestcase set should empty sandbox setshouldemptysandbox set files setfiles aspects files aspectsfiles string options get options getoptions options set options setoptions set classpath setclasspath classes jar args build args buildargs result in test case intestcase ajc base args in test case intestcase assert no messages assertnomessages result fail message failmessage create jar createjar sandbox aspects jar args build weave args buildweaveargs in test case intestcase set should empty sandbox setshouldemptysandbox result in test case intestcase ajc base args ajc test case ajctestcase message spec messagespec message spec messagespec build message spec buildmessagespec in test case intestcase assert messages assertmessages result fail message failmessage message spec messagespec subsequent steps test in test case intestcase set should empty sandbox setshouldemptysandbox ioexception ajc test case ajctestcase fail fail message failmessage set classes files setclassesfiles string files classes files classesfiles files set aspects files setaspectsfiles string files aspects files aspectsfiles files find files dir jar file delete param in dir indir param create jar createjar file in dir indir string is classes isclasses ioexception file out jar outjar file in dir indir file output stream fileoutputstream fos file output stream fileoutputstream out jar outjar jar output stream jaroutputstream jar out jarout jar output stream jaroutputstream fos list class files classfiles array list arraylist list to exclude toexclude is classes isclasses collections empty list class files from classes classfilesfromclasses collect class files collectclassfiles in dir indir class files classfiles to exclude toexclude is classes isclasses class files from classes classfilesfromclasses class files classfiles string prefix in dir indir get path getpath file separator iterator iter class files classfiles iterator iter has next hasnext file file iter string this path thispath get path getpath this path thispath starts with startswith prefix this path thispath this path thispath substring prefix length jar entry jarentry entry jar entry jarentry this path thispath jar out jarout put next entry putnextentry entry copy file copyfile jar out jarout jar out jarout close entry closeentry jar out jarout flush jar out jarout close collect class files collectclassfiles file in dir indir list in list inlist list to exclude toexclude file contents in dir indir list files listfiles contents length contents get name getname ends with endswith to exclude toexclude contents in list inlist add contents contents is directory isdirectory collect class files collectclassfiles contents in list inlist to exclude toexclude copy file copyfile file output stream outputstream dest ioexception file input stream fileinputstream fis file input stream fileinputstream buf read read fis read buf dest write buf read string build weave args buildweaveargs string buffer stringbuffer args string buffer stringbuffer get options getoptions string tokenizer stringtokenizer str tok strtok string tokenizer stringtokenizer get options getoptions str tok strtok has more tokens hasmoretokens args append str tok strtok next token nexttoken args append args append inpath args append classes jar args append file path separator pathseparator args append aspects jar args append args append aspectpath args append aspects jar string argument string argumentstring args to string tostring string tokenizer stringtokenizer str tok strtok string tokenizer stringtokenizer argument string argumentstring string ret string str tok strtok count tokens counttokens ret length ret str tok strtok next token nexttoken ret