copyright palo alto center incorporated parc rights reserved program accompanying materials terms common license accompanies distribution http eclipse org legal cpl html contributors xerox parc initial implementation org aspectj testing harness bridge java file java file filter filefilter java util array list arraylist java util arrays org aspectj bridge icommand org aspectj bridge imessage org aspectj bridge imessage handler imessagehandler org aspectj testing taskdefs ajc task compile command ajctaskcompilecommand org aspectj testing util diffs org aspectj util file util fileutil org aspectj util lang util langutil sandbox holds shared ajc test ajctest runs directories relevant testing permits limited amount coordination setup cleanup operations todo xxx ajc test ajctest creates sandbox initializes fields coordinate components values sources running sinks interactions clear avoid accidentally violating semantics setters getters coordinated property constrained ways extra typed caller parameter authenticating caller valid getter illegal state exception illegalstateexception called setter setter illegal state exception illegalstateexception called getter xxx subclass general sandbox sandbox classes directory token dir changes dirchanges spec string dir directory token dir changes dirchanges spec string classes dir classes can read canread file dir dir dir is directory isdirectory dir can read canread can write canwrite file dir dir dir is directory isdirectory dir can write canwrite iax write iaxwrite file dir string label can write canwrite dir illegal argument exception illegalargumentexception label dir iax read iaxread file dir string label can read canread dir illegal argument exception illegalargumentexception label dir illegal state exception illegalstateexception message test assert state assertstate test string message test illegal state exception illegalstateexception message read base test sources base java sources file test base dir testbasedir parent temporary workspace includes file sandbox dir sandboxdir shared working dir file working dir workingdir shared classes dir file classes dir classesdir dir forking runs file run dir rundir staging directory iajc run iajcrun requiring files copied deleted file staging dir stagingdir manages creation deletion temporary directories hold reference clients signal deleted xxx required completing tests validator validator original base original java sources compile run compilerun setup file test base src dir testbasesrcdir directories libraries classpath compile run compilerun setup file compile classpath compileclasspath string boot classpath bootclasspath aspectpath entries compile run compilerun setup file aspectpath track classpath getter got classpath gotclasspath command shared runs sandbox compiler icommand command track command getter got command gotcommand cache rendering fields string to string leader tostringleader compiler run init compilerruninit illegal argument exception illegalargumentexception validator validates test base dir testbasedir readable sandbox file test base dir testbasedir validator validator lang util langutil throw iax if null throwiaxifnull validator validator validator validator sandbox iax read iaxread test base dir testbasedir test base dir testbasedir test base dir testbasedir test base dir testbasedir file base dir basedir file util fileutil get temp dir gettempdir sandbox base dir basedir is absolute isabsolute base dir basedir base dir basedir get absolute file getabsolutefile sandbox dir sandboxdir base dir basedir xxx iax sandbox iax write iaxwrite sandbox dir sandboxdir sandbox dir sandboxdir working dir workingdir file util fileutil make new child dir makenewchilddir sandbox dir sandboxdir working dir workingdir sandbox iax write iaxwrite working dir workingdir working dir workingdir classes dir classesdir file util fileutil make new child dir makenewchilddir sandbox dir sandboxdir classes sandbox iax write iaxwrite classes dir classesdir classes dir classesdir run dir rundir file util fileutil make new child dir makenewchilddir sandbox dir sandboxdir sandbox iax write iaxwrite run dir rundir run dir rundir staging dir stagingdir file util fileutil make new child dir makenewchilddir sandbox dir sandboxdir staging sandbox iax write iaxwrite staging dir stagingdir staging dir stagingdir validator register sandbox registersandbox string get to string leader gettostringleader to string leader tostringleader to string leader tostringleader sandbox sandbox dir sandboxdir get name getname test base src dir testbasesrcdir get name getname to string leader tostringleader sandbox sandbox src classes names string to string tostring get to string leader gettostringleader classes dir classesdir get name getname sandbox sandbox src classes paths string to long string tolongstring get to string leader gettostringleader classes dir classesdir get path getpath command command command set command setcommand icommand command compiler run compilerrun caller lang util langutil throw iax if null throwiaxifnull caller caller lang util langutil throw iax if null throwiaxifnull command command lang util langutil throw iax if false throwiaxiffalse got command gotcommand command command command test completed clear compiler avoid memory leaks clear command clearcommand ajc test ajctest caller lang util langutil throw iax if null throwiaxifnull caller caller command add icommand quit command ajc task compile command ajctaskcompilecommand xxx urk ajc task compile command ajctaskcompilecommand command quit command locked suite validator validator delete temp files deletetempfiles populate staging directory copying files source directory from suffix fromsuffix staging directory renaming to suffix tosuffix source file starts delete file staging directory deleting string files copied deleted path suffix relative staging dir error file from suffix fromsuffix string populate staging dir populatestagingdir string from suffix fromsuffix string to suffix tosuffix iajc run iajcrun caller lang util langutil throw iax if null throwiaxifnull from suffix fromsuffix from suffix fromsuffix lang util langutil throw iax if null throwiaxifnull to suffix tosuffix to suffix tosuffix lang util langutil throw iax if null throwiaxifnull caller caller array list arraylist result array list arraylist file util fileutil copy dir copydir src base srcbase target src targetsrc from suffix fromsuffix to suffix tosuffix collector string canonical from canonicalfrom src base srcbase get canonical path getcanonicalpath definition defs get definitions getdefinitions src base srcbase defs defs length error definitions message handler messagehandler compiler messages compilermessages message handler messagehandler string buffer stringbuffer command line commandline string buffer stringbuffer result string from suffix fromsuffix java copy files collecting files clear files size xxx detect incomplete string result to array toarray string xxx move general file util fileutil report class diffs reportclassdiffs imessage handler imessagehandler handler inc compiler run inccompilerrun caller classes dir start time classesdirstarttime string expected sources expectedsources lang util langutil throw iax if false throwiaxiffalse classes dir start time classesdirstarttime classes dir start time classesdirstarttime accept prefixes acceptprefixes diffs diffs org aspectj testing util file util fileutil dir diffs dirdiffs classes classes dir classesdir classes dir start time classesdirstarttime expected sources expectedsources accept prefixes acceptprefixes diffs report handler imessage error xxx replace imessage based implementation xxx move general file util fileutil report classes dir diffs reportclassesdirdiffs imessage handler imessagehandler handler inc compiler run inccompilerrun caller string expected sources expectedsources normalize sources ignore array list arraylist sources array list arraylist lang util langutil is empty isempty expected sources expectedsources expected sources expectedsources length string src path srcpath expected sources expectedsources clip file util fileutil source suffix length sourcesuffixlength src path srcpath clip src path srcpath src path srcpath substring src path srcpath length clip sources add file util fileutil weak normalize weaknormalize src path srcpath src path srcpath ends with endswith src path srcpath src path srcpath substring src path srcpath length sources add file util fileutil weak normalize weaknormalize src path srcpath message util messageutil info handler source file src path srcpath gather normalize paths changed array list arraylist changed array list arraylist file filter filefilter touched collector touchedcollector file filter filefilter accept file file file last modified lastmodified classes dir time classesdirtime string path file get path getpath path ends with endswith message util messageutil info handler changed file file string class path classpath path substring path length class path classpath file util fileutil weak normalize weaknormalize class path classpath sources class path classpath sources remove class path classpath changed add class path classpath classes dir classesdir list files listfiles touched collector touchedcollector report unexpected diffs diffs diffs classes sources changed string insensitive order diffs report handler imessage error icommand get command getcommand compiler run compilerrun caller lang util langutil throw iax if null throwiaxifnull caller caller assert state assertstate command command command icommand get command getcommand inc compiler run inccompilerrun caller lang util langutil throw iax if null throwiaxifnull caller caller assert state assertstate command command command file get test base src dir gettestbasesrcdir inc compiler run inccompilerrun caller lang util langutil throw iax if null throwiaxifnull caller caller test base src dir testbasesrcdir files names sensitive staging test base directories param names file find files findfiles string names array list arraylist result array list arraylist names filter namesfilter filter names filter namesfilter names file bases test base dir testbasedir sandbox dir sandboxdir bases length file base bases base base can read canread result add all addall arrays as list aslist file util fileutil list files listfiles base filter file result to array toarray file file get test base src dir gettestbasesrcdir java run javarun caller lang util langutil throw iax if null throwiaxifnull caller caller test base src dir testbasesrcdir default test base src dir defaulttestbasesrcdir java run javarun caller lang util langutil throw iax if null throwiaxifnull caller caller test base src dir testbasesrcdir illegal state exception illegalstateexception test base src dir testbasesrcdir test base src dir testbasesrcdir test base dir testbasedir readable dir readabledir file dir dir dir is directory isdirectory dir can read canread compiler run init compilerruninit compiler run compilerrun caller file test base src dir testbasesrcdir file aspect path aspectpath aspectpath readable aspectpathreadable file class path classpath classpath readable classpathreadable string bootclass path bootclasspath test base src dir testbasesrcdir set test base src dir settestbasesrcdir test base src dir testbasesrcdir caller aspect path aspectpath aspect path aspectpath length set aspectpath setaspectpath aspect path aspectpath aspectpath readable aspectpathreadable caller class path classpath class path classpath length set classpath setclasspath class path classpath classpath readable classpathreadable caller set bootclasspath setbootclasspath bootclass path bootclasspath caller compiler run init compilerruninit java run init javaruninit java run javarun caller compiler run init compilerruninit test base src dir testbasesrcdir test base dir testbasedir aspectjrt jar compile classpath compileclasspath file illegal argument exception illegalargumentexception readable directory set test base src dir settestbasesrcdir file dir compiler run compilerrun caller lang util langutil throw iax if null throwiaxifnull caller caller dir dir is directory isdirectory dir can read canread illegal argument exception illegalargumentexception bad test base src dir dir test base src dir testbasesrcdir dir aspectpath param readable illegal argument exception illegalargumentexception readable set aspectpath setaspectpath file files readable compiler run compilerrun caller lang util langutil throw iax if null throwiaxifnull files files lang util langutil throw iax if null throwiaxifnull caller caller assert state assertstate aspectpath aspectpath written aspectpath file files length files length lang util langutil throw iax if null throwiaxifnull files files readable files can read canread illegal argument exception illegalargumentexception bad aspectpath entry files aspectpath files bootclasspath presumed delimited file path separator pathseparator valid entries param boot classpath bootclasspath param caller set bootclasspath setbootclasspath string boot classpath bootclasspath compiler run compilerrun caller boot classpath bootclasspath boot classpath bootclasspath compile classpath param readable illegal argument exception illegalargumentexception readable set classpath setclasspath file files readable compiler run compilerrun caller lang util langutil throw iax if null throwiaxifnull files files lang util langutil throw iax if null throwiaxifnull caller caller assert state assertstate got classpath gotclasspath classpath read compile classpath compileclasspath file files length files length lang util langutil throw iax if null throwiaxifnull files files readable files can read canread illegal argument exception illegalargumentexception bad classpath entry files compile classpath compileclasspath files classpath param caller unused restrict usage java run javarun illegal state exception illegalstateexception compile classpath compileclasspath illegal argument exception illegalargumentexception caller file get run classpath getrunclasspath java run javarun caller lang util langutil throw iax if null throwiaxifnull caller caller assert state assertstate compile classpath compileclasspath classpath compile path length compilepathlength compile classpath compileclasspath length aspect path length aspectpathlength aspectpath aspectpath length file result file aspect path length aspectpathlength compile path length compilepathlength system arraycopy compile classpath compileclasspath result compile path length compilepathlength aspect path length aspectpathlength system arraycopy aspectpath result compile path length compilepathlength aspect path length aspectpathlength result directories classpath selecting compile classpath ignores aspectpath jar files param readable omit readable directories file get classpath directories getclasspathdirectories readable java run javarun caller include output includeoutput lang util langutil throw iax if null throwiaxifnull caller caller assert state assertstate compile classpath compileclasspath classpath array list arraylist result array list arraylist file src compile classpath compileclasspath src length file src is directory isdirectory readable can read canread result add include output includeoutput classes dir classesdir readable classes dir classesdir can read canread result add classes dir classesdir file result to array toarray file jars belonging classpath including classpath aspectpath entries param readable omit readable directories file get classpath jars getclasspathjars readable java run javarun caller lang util langutil throw iax if null throwiaxifnull caller caller assert state assertstate compile classpath compileclasspath classpath array list arraylist result array list arraylist file src file compile classpath compileclasspath aspectpath src length file paths src len paths paths length len file paths file util fileutil has zip suffix haszipsuffix readable can read canread result add file result to array toarray file list aspect jars string string classpath entries delimited internally file path separator pathseparator string aspectpath to string aspectpathtostring compiler run compilerrun caller lang util langutil throw iax if null throwiaxifnull caller caller file util fileutil flatten aspectpath file path separator pathseparator compile classpath string string classpath entries delimited internally file path separator pathseparator string classpath to string classpathtostring compiler run compilerrun caller lang util langutil throw iax if null throwiaxifnull caller caller file util fileutil flatten compile classpath compileclasspath file path separator pathseparator boot classpath bootclasspath string string bootclasspath entries delimited internally file path separator pathseparator string get bootclasspath getbootclasspath compiler run compilerrun caller lang util langutil throw iax if null throwiaxifnull caller caller boot classpath bootclasspath boot classpath bootclasspath string string bootclasspath entries delimited internally file path separator pathseparator string get bootclasspath getbootclasspath java run javarun caller lang util langutil throw iax if null throwiaxifnull caller caller boot classpath bootclasspath names filter namesfilter file filter filefilter string names names filter namesfilter string names names names accept file file file string file get name getname names names length equals names