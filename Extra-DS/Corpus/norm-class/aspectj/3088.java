copyright xerox corporation palo alto center incorporated parc rights reserved program accompanying materials terms common license accompanies distribution http eclipse org legal cpl html contributors xerox parc initial implementation org aspectj util java java net java util java util zip java util zip zip file zipfile file util fileutil parent directory file file parent xxx user dir file parent file unmodifiable list string source file suffixes including leading list source suffixes collections unmodifiable list unmodifiablelist arrays as list aslist string java file filter filefilter zip filter file filter filefilter accept file file has zip suffix haszipsuffix file string to string tostring zip filter file filter filefilter source filter file filter filefilter accept file file has source suffix hassourcesuffix file string to string tostring source filter accept files file filter filefilter file filter filefilter accept file file filter filefilter dirs writable classes file filter filefilter accept file file file file is directory isdirectory file can write canwrite file get name getname to lower case tolowercase ends with endswith permit cvs string file util fileutil get name getname permit cvs permit cvs lang util langutil get boolean getboolean file path zip jar suffix has zip suffix haszipsuffix file file file has zip suffix haszipsuffix file get path getpath path ends zip jar has zip suffix haszipsuffix string path path zip suffix length zipsuffixlength path file zip jar suffix zip suffix length zipsuffixlength file file file zip suffix length zipsuffixlength file get path getpath zip jar suffix zip suffix length zipsuffixlength string path path path length string test path substring path length to lower case tolowercase zip equals test jar equals test file path source suffix has source suffix hassourcesuffix file file file has source suffix hassourcesuffix file get path getpath path ends java has source suffix hassourcesuffix string path path source suffix length sourcesuffixlength path file source suffix length suffix source suffix length sourcesuffixlength file file file source suffix length sourcesuffixlength file get path getpath source suffix length suffix source suffix length sourcesuffixlength string path lang util langutil is empty isempty path iterator iter source suffixes iterator iter has next hasnext string suffix string iter path ends with endswith suffix path to lower case tolowercase ends with endswith suffix suffix length readable directory can read dir canreaddir file dir dir dir can read canread dir is directory isdirectory readable file can read file canreadfile file file file file can read canread file is file isfile dir writable directory can write dir canwritedir file dir dir dir can write canwrite dir is directory isdirectory writable file can write file canwritefile file file file file can write canwrite file is file isfile illegal argument exception illegalargumentexception file readable directory throw iax unless can read file throwiaxunlesscanreadfile file file string label can read file canreadfile file illegal argument exception illegalargumentexception label readable file file illegal argument exception illegalargumentexception dir readable directory throw iax unless can read dir throwiaxunlesscanreaddir file dir string label can read dir canreaddir dir illegal argument exception illegalargumentexception label readable dir dir illegal argument exception illegalargumentexception file readable directory throw iax unless can write file throwiaxunlesscanwritefile file file string label can write file canwritefile file illegal argument exception illegalargumentexception label writable file file illegal argument exception illegalargumentexception dir readable directory throw iax unless can write dir throwiaxunlesscanwritedir file dir string label can write dir canwritedir dir illegal argument exception illegalargumentexception label writable dir dir array length input string paths string get paths getpaths file files files files length string string result string files length result length files result files get path getpath result array length input string paths string get paths getpaths list files size files files size size string string result string size size file file file files file result file get path getpath result extract path file basedir assumed class file classfile top level suffixes org java javax parent directory param basedir file base directory prefix class file classfile param class file classfile file extract illegal argument exception illegalargumentexception class file classfile basedir prefix class file classfile string file to class name filetoclassname file basedir file class file classfile lang util langutil throw iax if null throwiaxifnull class file classfile class file classfile string class file path classfilepath normalized path normalizedpath class file classfile class file path classfilepath ends with endswith string class file classfile illegal argument exception illegalargumentexception class file path classfilepath class file path classfilepath substring class file path classfilepath length basedir string base path basepath normalized path normalizedpath basedir class file path classfilepath starts with startswith base path basepath string class file classfile start basedir illegal argument exception illegalargumentexception class file path classfilepath class file path classfilepath substring base path basepath length string suffixes string org java javax suffixes length loc class file path classfilepath index of indexof suffixes loc loc class file path classfilepath char at charat loc class file path classfilepath class file path classfilepath substring loc loc class file path classfilepath last index of lastindexof loc treat class file path classfilepath class file path classfilepath substring loc class file path classfilepath replace normalize path comparisons rendering absolute clipping basedir prefix trimming changing param file file path normalize param basedir file prefix file normalize normalized path illegal argument exception illegalargumentexception basedir prefix file string normalized path normalizedpath file file file basedir string file path filepath normalized path normalizedpath file basedir string base path basepath normalized path normalizedpath basedir file path filepath starts with startswith base path basepath file path filepath file path filepath substring base path basepath length file path filepath starts with startswith file path filepath file path filepath substring file path filepath render files string path absolute paths delimiting infix param files file flatten empty param infix string delimiter internally entries file path separator pathseparator alias code flatten get absolute paths getabsolutepaths files infix code string absolute paths entries order delimited infix string flatten file files string infix lang util langutil is empty isempty files flatten get paths getpaths files infix flatten file string param files file paths flatten param infix string infix treated file path separator pathseparator string flatten string paths string infix infix infix file path separator pathseparator string buffer stringbuffer result string buffer stringbuffer paths length string path paths path result append infix result append path result to string tostring normalize path comparisons rendering absolute trimming changing normalized path string normalized path normalizedpath file file file weak normalize weaknormalize file get absolute path getabsolutepath weakly normalize path comparisons trimming changing string weak normalize weaknormalize string path path path path replace trim path file get best file getbestfile string paths paths file result result paths length string path paths path path starts with startswith path system get property getproperty path substring throwable path path file file path exists can read canread result file util fileutil get best file getbestfile throwable result file get best file getbestfile file file lang util langutil throw iax if null throwiaxifnull file file file exists file get canonical file getcanonicalfile ioexception file get absolute file getabsolutefile file string get best path getbestpath file file lang util langutil throw iax if null throwiaxifnull file file file exists file get canonical path getcanonicalpath ioexception file get absolute path getabsolutepath file get path getpath string get absolute paths getabsolutepaths file files files files length string string result string files length result length files result files get absolute path getabsolutepath result delete contents deletecontents file dir delete contents deletecontents dir delete contents deletecontents file dir file filter filefilter filter delete contents deletecontents dir filter delete contents deletecontents file dir file filter filefilter filter delete empty dirs deleteemptydirs dir illegal argument exception illegalargumentexception dir dir exists dir can write canwrite dir is directory isdirectory dir delete string from files fromfiles dir list result from files fromfiles length string string from files fromfiles file file file dir string filter filter accept file file is directory isdirectory result delete contents deletecontents file filter delete empty dirs deleteemptydirs delete empty dirs deleteemptydirs file list length file delete file delete result result copy dir copydir file from dir fromdir file to dir todir ioexception copy dir copydir from dir fromdir to dir todir copy dir copydir file from dir fromdir file to dir todir string from suffix fromsuffix string to suffix tosuffix ioexception copy dir copydir from dir fromdir to dir todir from suffix fromsuffix to suffix tosuffix file filter filefilter copy dir copydir file from dir fromdir file to dir todir string from suffix fromsuffix string to suffix tosuffix list collector ioexception collector copy dir copydir from dir fromdir to dir todir from suffix fromsuffix to suffix tosuffix file filter filefilter collect file filter filefilter accept file pathname collector add pathname copy dir copydir from dir fromdir to dir todir from suffix fromsuffix to suffix tosuffix collect copy dir copydir file from dir fromdir file to dir todir string from suffix fromsuffix string to suffix tosuffix file filter filefilter delegate ioexception from dir fromdir from dir fromdir can read canread have suffix havesuffix from suffix fromsuffix from suffix fromsuffix length slen have suffix havesuffix from suffix fromsuffix length to dir todir exists to dir todir mkdirs string from files fromfiles have suffix havesuffix from files fromfiles from dir fromdir list filename filter filenamefilter filter filename filter filenamefilter accept file dir string file dir is directory isdirectory ends with endswith from suffix fromsuffix from files fromfiles from dir fromdir list filter result max from files fromfiles from files fromfiles length max string filename from files fromfiles file from file fromfile file from dir fromdir filename from file fromfile can read canread from file fromfile is directory isdirectory result copy dir copydir from file fromfile file to dir todir filename from suffix fromsuffix to suffix tosuffix delegate from file fromfile is file isfile have suffix havesuffix filename filename substring filename length slen to suffix tosuffix filename filename to suffix tosuffix file target file targetfile file to dir todir filename delegate delegate accept target file targetfile copy file copyfile from file fromfile target file targetfile result result string list files listfiles file src dir srcdir array list arraylist result array list arraylist src dir srcdir src dir srcdir can read canread list files listfiles src dir srcdir result string result to array toarray string file filter filefilter aspectj source file filter aspectjsourcefilefilter file filter filefilter accept file pathname string pathname get name getname to lower case tolowercase ends with endswith java ends with endswith file list files listfiles file src dir srcdir file filter filefilter file filter filefilter array list arraylist result array list arraylist src dir srcdir src dir srcdir can read canread list files listfiles src dir srcdir result file filter filefilter file result to array toarray file result size file get base dir files getbasedirfiles file basedir string paths get base dir files getbasedirfiles basedir paths string file get base dir files getbasedirfiles file basedir string paths string suffixes lang util langutil throw iax if null throwiaxifnull basedir basedir lang util langutil throw iax if null throwiaxifnull paths paths file result lang util langutil is empty isempty suffixes array list arraylist list array list arraylist paths length listed string path paths listed suffixes length string suffix suffixes listed path ends with endswith suffix list add file basedir paths result file list to array toarray file result file paths length result length result new file newfile basedir paths result file new file newfile file dir string path equals path dir equals path file parent dir parentdir dir get parent file getparentfile parent dir parentdir parent dir parentdir file dir file dir path file copy files copyfiles file src dir srcdir string relative paths relativepaths file dest dir destdir illegal argument exception illegalargumentexception ioexception string paths relative paths relativepaths throw iax unless can read dir throwiaxunlesscanreaddir src dir srcdir src dir srcdir throw iax unless can write dir throwiaxunlesscanwritedir dest dir destdir dest dir destdir lang util langutil throw iax if null throwiaxifnull paths relative paths relativepaths file result file paths length paths length string path paths lang util langutil throw iax if null throwiaxifnull path relative paths relativepaths entry file src new file newfile src dir srcdir paths file dest new file newfile dest dir destdir path file dest parent destparent dest get parent file getparentfile dest parent destparent exists dest parent destparent mkdirs lang util langutil throw iax if false throwiaxiffalse can write dir canwritedir dest parent destparent dest entry parent copy file copyfile src dest result dest result copy file copyfile file from file fromfile file to file tofile ioexception lang util langutil throw iax if null throwiaxifnull from file fromfile from file fromfile lang util langutil throw iax if null throwiaxifnull to file tofile to file tofile lang util langutil throw iax if false throwiaxiffalse to file tofile equals from file fromfile file to file tofile is directory isdirectory throw iax unless can write dir throwiaxunlesscanwritedir to file tofile to file tofile from file fromfile is file isfile file targ file targfile file to file tofile from file fromfile get name getname copy valid files copyvalidfiles from file fromfile targ file targfile from file fromfile is directory isdirectory copy dir copydir from file fromfile to file tofile lang util langutil throw iax if false throwiaxiffalse dir file from file fromfile to file tofile is file isfile from file fromfile is directory isdirectory lang util langutil throw iax if false throwiaxiffalse copy file dir from file fromfile copy valid files copyvalidfiles from file fromfile to file tofile ensure parent writable ensureparentwritable to file tofile from file fromfile is file isfile copy valid files copyvalidfiles from file fromfile to file tofile from file fromfile is directory isdirectory to file tofile mkdirs throw iax unless can write dir throwiaxunlesscanwritedir to file tofile to file tofile copy dir copydir from file fromfile to file tofile lang util langutil throw iax if false throwiaxiffalse dir file from file fromfile file ensure parent writable ensureparentwritable file path lang util langutil throw iax if null throwiaxifnull path path file path parent pathparent path get parent file getparentfile path parent pathparent path parent pathparent parent path parent pathparent can write canwrite path parent pathparent mkdirs throw iax unless can write dir throwiaxunlesscanwritedir path parent pathparent path parent pathparent path parent pathparent copy valid files copyvalidfiles file from file fromfile file to file tofile ioexception file input stream fileinputstream file output stream fileoutputstream file input stream fileinputstream from file fromfile file output stream fileoutputstream to file tofile copy stream copystream close close copy stream copystream data input stream datainputstream print stream printstream ioexception lang util langutil throw iax if null throwiaxifnull lang util langutil throw iax if null throwiaxifnull string read line readline println copy stream copystream input stream inputstream output stream outputstream ioexception max buf max bytes read bytesread read buf max bytes read bytesread bytes read bytesread read buf max write buf bytes read bytesread copy stream copystream reader writer ioexception max buf max bytes read bytesread read buf max bytes read bytesread bytes read bytesread read buf max write buf bytes read bytesread file make new child dir makenewchilddir file parent string child parent parent can write canwrite parent is directory isdirectory illegal argument exception illegalargumentexception bad parent parent child child make new child dir makenewchilddir is valid file name isvalidfilename child illegal argument exception illegalargumentexception bad child child file result file parent child safety string suffix file util fileutil random file string randomfilestring safety result exists suffix file util fileutil random file string randomfilestring result file parent child suffix result result exists system err println exhausted files child dir parent result mkdirs result exists result file get temp dir gettempdir string file util fileutil get temp dir gettempdir is valid file name isvalidfilename illegal argument exception illegalargumentexception invalid file result file temp file tempfile temp file tempfile file create temp file createtempfile ignore me ignoreme txt file temp parent tempparent temp file tempfile get parent file getparentfile result make new child dir makenewchilddir temp parent tempparent ioexception result make new child dir makenewchilddir file temp file tempfile temp file tempfile delete result url get file urls getfileurls file files files files length url url result url files length result length result get file url getfileurl files result url get file url getfileurl file file lang util langutil throw iax if null throwiaxifnull file file url result result file to url tourl result result string url file file get absolute path getabsolutepath replace result url url file is directory isdirectory malformed urlexception malformedurlexception string util make url makeurl file get path getpath mue get message getmessage system err println result write contents file returning success error message parent directories param file file write param contents string write string error error string write as string writeasstring file file string contents lang util langutil throw iax if null throwiaxifnull file file contents contents writer file parent dir parentdir file get parent file getparentfile parent dir parentdir exists parent dir parentdir mkdirs unable parent dir file reader string reader stringreader contents file writer filewriter file file util fileutil copy stream copystream ioexception lang util langutil unqualified class name unqualifiedclassname writing file get message getmessage close ioexception reads array encoding read boolean array readbooleanarray data input stream datainputstream ioexception len read int readint ret len len ret read boolean readboolean ret writes array encoding write boolean array writebooleanarray data output stream dataoutputstream ioexception len length write int writeint len len write boolean writeboolean reads array encoding read int array readintarray data input stream datainputstream ioexception len read int readint ret len len ret read int readint ret writes array encoding write int array writeintarray data output stream dataoutputstream ioexception len length write int writeint len len write int writeint reads array encoding string read string array readstringarray data input stream datainputstream ioexception len read int readint string ret string len len ret read utf readutf ret writes array encoding write string array writestringarray string data output stream dataoutputstream ioexception write int writeint len length write int writeint len len write utf writeutf returns contents file string string read as string readasstring file file ioexception buffered reader bufferedreader buffered reader bufferedreader file reader filereader file string buffer stringbuffer string buffer stringbuffer read append close to string tostring returns contents stream string string read as string readasstring input stream inputstream ioexception buffered reader bufferedreader buffered reader bufferedreader input stream reader inputstreamreader string buffer stringbuffer string buffer stringbuffer read append close close to string tostring returns contents file read as byte array readasbytearray file file ioexception file input stream fileinputstream file input stream fileinputstream file ret file util fileutil read as byte array readasbytearray close ret reads input stream returns contents read as byte array readasbytearray input stream inputstream in stream instream ioexception size size read so far readsofar n read nread in stream instream read read so far readsofar size read so far readsofar n read nread read so far readsofar n read nread read so far readsofar size new size newsize size new ba newba new size newsize system arraycopy new ba newba size new ba newba size new size newsize new ba newba read so far readsofar system arraycopy new ba newba read so far readsofar new ba newba string filechars abcdefghijklmnopqrstuvxyz abcdefghijklmnopqrstuvwxyz abcdefghijklmnopqrstuvxyzabcdefghijklmnopqrstuvwxyz semi random string length usable filename suffix string random file string randomfilestring filechars length filechars length len result len math random len len result filechars char at charat math random filechars length string result input stream inputstream get stream from zip getstreamfromzip string zip file zipfile string zip file zipfile zip file zipfile zip file zipfile zip entry zipentry entry get entry getentry get input stream getinputstream entry safe close close ioexception ioe extract jar extractjar string zip file zipfile string out dir outdir ioexception zip input stream zipinputstream zip input stream zipinputstream file input stream fileinputstream zip file zipfile zip entry zipentry entry entry get next entry getnextentry entry is directory isdirectory read as byte array readasbytearray file out file outfile file out dir outdir entry get name getname out file outfile get parent file getparentfile exists system err println parent out file outfile get parent file getparentfile system err println parent out file outfile get parent file getparentfile out file outfile get parent file getparentfile mkdirs file output stream fileoutputstream file output stream fileoutputstream out file outfile write close close entry closeentry close based search literal text source files returning file param sought string text seek file param sources list string paths source files param list all listall list match file param error sink errorsink print stream printstream print errors silently ignore errors list string form file entry empty list line seek lineseek string sought list sources list all listall print stream printstream error sink errorsink lang util langutil is empty isempty sought lang util langutil is empty isempty sources collections empty list array list arraylist result array list arraylist iterator iter sources iterator iter has next hasnext string path string iter string error line seek lineseek sought path list all listall result error error sink errorsink error sink errorsink println error result based search literal text source file returning string form source path sourcepath column submitted collecting parameter sink error rendered string returned result param sought string text seek file param sources list string paths source files param list all listall list match file param list sink list string entries form source path sourcepath column string error add string entries sink string line seek lineseek string sought string source path sourcepath list all listall array list arraylist sink lang util langutil is empty isempty sought lang util langutil is empty isempty source path sourcepath sought lang util langutil is empty isempty source path sourcepath source path sourcepath file file file source path sourcepath file can read canread file is file isfile source path sourcepath readable file line num linenum file reader filereader fin fin file reader filereader file buffered reader bufferedreader reader buffered reader bufferedreader fin string reader read line readline line num linenum loc index of indexof sought loc sink add source path sourcepath line num linenum loc list all listall ioexception lang util langutil unqualified class name unqualifiedclassname reading source path sourcepath line num linenum fin fin close ignore ioexception buffered output stream bufferedoutputstream make output stream makeoutputstream file file file not found exception filenotfoundexception file parent file get parent file getparentfile parent parent mkdirs buffered output stream bufferedoutputstream file output stream fileoutputstream file sleep modified stamp files param files file files inspect modified times ignores empty files array existing components files array succeeded interrupts sleep past final modified time sleeppastfinalmodifiedtime file files files files length delay until delayuntil system current time millis currenttimemillis files length file file files file file exists next mod time nextmodtime file last modified lastmodified next mod time nextmodtime delay until delayuntil delay until delayuntil next mod time nextmodtime lang util langutil sleep until sleepuntil delay until delayuntil list files listfiles file base dir basedir array list arraylist result file filter filefilter filter file files base dir basedir list files listfiles hack https bugs eclipse org bugs bug cgi skip cvs skipcvs permit cvs filter aspectj source file filter aspectjsourcefilefilter files length file files is directory isdirectory skip cvs skipcvs string get name getname to lower case tolowercase cvs equals sccs equals list files listfiles result filter filter accept result add input path separator is valid file name isvalidfilename string input input input index of indexof file path separator pathseparator list files listfiles file base dir basedir string dir array list arraylist result string dir prefix dirprefix dir dir file dir file dirfile dir base dir basedir file base dir basedir get path getpath dir string files dir file dirfile list files length file file dir file dirfile files string path dir prefix dirprefix files is directory isdirectory list files listfiles base dir basedir path result result add path file util fileutil error utility list make classpath makeclasspath url urls list ret linked list linkedlist urls urls length ret add urls get path getpath ret pipe reads input stream output stream optionally sleeping reads copy stream copystream input stream inputstream output stream outputstream pipe runnable input stream inputstream output stream outputstream sleep byte array output stream bytearrayoutputstream snoop total written totalwritten throwable thrown halt unable detect erroroneous closing system close input closeinput close output closeoutput processing stream characters returned halting finish stream finishstream completing completes alias code pipe code param input stream inputstream source read param output stream outputstream sink write pipe input stream inputstream output stream outputstream param input stream inputstream source read param output stream outputstream sink write param try closing streams tryclosingstreams closing streams param sleep milliseconds delay reads pinned minute pipe input stream inputstream output stream outputstream sleep close input closeinput close output closeoutput lang util langutil throw iax if null throwiaxifnull lang util langutil throw iax if null throwiaxifnull close input closeinput close input closeinput close output closeoutput close output closeoutput sleep math min math max sleep set snoop setsnoop byte array output stream bytearrayoutputstream snoop snoop snoop pipe halts throwable thrown read returns file demand total written totalwritten halt max buf max todo blocks hanging harness count read buf max byte array output stream bytearrayoutputstream my snoop mysnoop halt finish stream finishstream count halt count write buf count my snoop mysnoop snoop my snoop mysnoop my snoop mysnoop write buf count total written totalwritten count halt finish stream finishstream halt sleep thread sleep sleep halt finish stream finishstream count read buf max throwable thrown halt close input closeinput close ioexception close output closeoutput close ioexception completing total written totalwritten thrown pipe halt time gains control param wait waits synchronously pipe param finish stream finishstream read input stream returns bytes halt code code time gains control halt wait finish stream finishstream halt halt wait notify all notifyall thread sleep interrupted exception interruptedexception halt total number bytes written total written totalwritten total written totalwritten exception thrown reading writing throwable get thrown getthrown thrown called pipe completing implementation subclasses implement notice note halt completed method called completing total written totalwritten throwable thrown