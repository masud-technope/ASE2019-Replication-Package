copyright zxing authors licensed apache license version license file compliance license copy license http apache org licenses license required applicable law agreed writing software distributed license distributed basis warranties conditions kind express implied license specific language governing permissions limitations license google zxing web javax servlet filter javax servlet filter chain filterchain javax servlet filter config filterconfig javax servlet servlet context servletcontext javax servlet servlet exception servletexception javax servlet servlet request servletrequest javax servlet servlet response servletresponse javax servlet http http servlet response httpservletresponse java ioexception java net inet address inetaddress java net unknown host exception unknownhostexception java util collections java util hash set hashset java util java util timer java util timer task timertask link filter rejects requests hosts sending requests time author sean owen do sfilter dosfilter filter max accesses time max access interval msec unban interval msec iptrie num recent accesses numrecentaccesses timer timer string banned ipaddresses bannedipaddresses servlet context servletcontext context do sfilter dosfilter num recent accesses numrecentaccesses iptrie timer timer dos filter dosfilter reset timer banned ipaddresses bannedipaddresses collections synchronized set synchronizedset hash set hashset string init filter config filterconfig filter config filterconfig context filter config filterconfig get servlet context getservletcontext timer schedule at fixed rate scheduleatfixedrate reset task resettask max access interval msec timer schedule at fixed rate scheduleatfixedrate unban task unbantask unban interval msec do filter dofilter servlet request servletrequest request servlet response servletresponse response filter chain filterchain chain ioexception servlet exception servletexception is banned isbanned request http servlet response httpservletresponse servlet response servletresponse http servlet response httpservletresponse response servlet response servletresponse send error senderror http servlet response httpservletresponse forbidden chain do filter dofilter request response is banned isbanned servlet request servletrequest request string remote ipaddress string remoteipaddressstring request get remote addr getremoteaddr banned ipaddresses bannedipaddresses remote ipaddress string remoteipaddressstring inet address inetaddress remote ipaddress remoteipaddress remote ipaddress remoteipaddress inet address inetaddress get by name getbyname remote ipaddress string remoteipaddressstring unknown host exception unknownhostexception uhe context log determine host remote ipaddress string remoteipaddressstring assuming banned num recent accesses numrecentaccesses increment and get incrementandget remote ipaddress remoteipaddress max accesses time context log do s dos attack remote ipaddress string remoteipaddressstring banned ipaddresses bannedipaddresses add remote ipaddress string remoteipaddressstring destroy timer cancel num recent accesses numrecentaccesses clear banned ipaddresses bannedipaddresses clear reset task resettask timer task timertask override num recent accesses numrecentaccesses clear unban task unbantask timer task timertask override banned ipaddresses bannedipaddresses clear