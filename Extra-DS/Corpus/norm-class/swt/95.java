copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse swt dnd org eclipse swt org eclipse swt widgets org eclipse swt internal win org eclipse swt internal ole win code clipboard code mechanism transferring data application application intended subclassed clipboard display display ole interfaces comobject i data object idataobject ref count refcount transfer transfer agents transferagents transfer object data object cfstr preferreddropeffect constructs instance creating instance clipboard system resources allocated depending platform mandatory clipboard instance disposed longer required param display display allocate clipboard exception swtexception error thread invalid access called thread created parent error invalid subclass allowed subclass clipboard dispose clipboard check subclass checksubclass clipboard display display check subclass checksubclass display display display get current getcurrent display display display get default getdefault display get thread getthread thread current thread currentthread dnd error swt error thread invalid access display display nls tchar ch format name chformatname tchar preferred drop effect dropeffect cfstr preferreddropeffect register clipboard format registerclipboardformat ch format name chformatname create cominterfaces createcominterfaces add ref addref checks subclassed swt library intended subclassed specific controlled points method enforces rule overridden providing implementation method subclass subclassing created implementer agrees fully responsible fact subclass fail swt releases platform specific support user written classes implemented fashion ability subclass allowed swt classes intended purely enable swt development team implement patches order specific limitations advance limitations addressed team subclassing attempted intimate detailed understanding hierarchy exception swtexception error invalid subclass allowed subclass check subclass checksubclass string get class getclass get name getname string valid name validname clipboard get name getname valid name validname equals dnd error swt error invalid subclass code swtexception code receiver accessed caller include checks receiver generally entire execution context method called widget implementors enforce standard swt invariants error invoke method code is disposed isdisposed code widget code dispose code method called error call widget methods thread thread created widget releases swt error checks exceptions thrown reasons exception swtexception error widget disposed receiver disposed error thread invalid access called thread created receiver check widget checkwidget display display display display dnd error swt error widget disposed display get thread getthread thread current thread currentthread dnd error swt error thread invalid access display is disposed isdisposed dnd error swt error widget disposed clipboard owner data system clipboard clear contents clipboard owner note clipboard assistant applications ownership data copies data clipboard cases clear clipboard exception swtexception error widget disposed receiver disposed error thread invalid access called thread created receiver clear contents clearcontents clear contents clearcontents dnd clipboard clipboard owner data clipboard clear contents clipboard owner note clipboard assistant applications ownership data copies data clipboard cases clear clipboard clipboards clipboard constants defined code dnd code built bitwise ing code code code dnd code clipboard constants param clipboards cleared exception swtexception error widget disposed receiver disposed error thread invalid access called thread created receiver dnd clipboard dnd selection clipboard clear contents clearcontents clipboards check widget checkwidget clipboards dnd clipboard ole is current clipboard oleiscurrentclipboard i data object idataobject get address getaddress ole set clipboard olesetclipboard disposes operating system resources clipboard data system clipboard dispose method called note platforms data application exited display disposed exception swtexception error thread invalid access called thread created parent dispose is disposed isdisposed display get thread getthread thread current thread currentthread dnd error swt error thread invalid access ole is current clipboard oleiscurrentclipboard i data object idataobject get address getaddress ole flush clipboard oleflushclipboard release display retrieve data type system clipboard refer specific subclass code transfer code determine type object returned snippet text rtf text retrieved clipboard code pre clipboard clipboard clipboard display text transfer texttransfer text transfer texttransfer text transfer texttransfer get instance getinstance string text data textdata string clipboard get contents getcontents text transfer texttransfer text data textdata system println text text data textdata rtftransfer rtf transfer rtftransfer rtftransfer get instance getinstance string rtf data rtfdata string clipboard get contents getcontents rtf transfer rtftransfer rtf data rtfdata system println rtf text rtf data rtfdata clipboard dispose code pre param transfer transfer agent type data requested data clipboard data type exception swtexception error widget disposed receiver disposed error thread invalid access called thread created receiver exception illegal argument exception illegalargumentexception error argument transfer transfer object get contents getcontents transfer transfer get contents getcontents transfer dnd clipboard retrieve data type clipboard refer specific subclass code transfer code determine type object returned snippet text rtf text retrieved clipboard code pre clipboard clipboard clipboard display text transfer texttransfer text transfer texttransfer text transfer texttransfer get instance getinstance string text data textdata string clipboard get contents getcontents text transfer texttransfer text data textdata system println text text data textdata rtftransfer rtf transfer rtftransfer rtftransfer get instance getinstance string rtf data rtfdata string clipboard get contents getcontents rtf transfer rtftransfer dnd clipboard rtf data rtfdata system println rtf text rtf data rtfdata clipboard dispose code pre clipboards clipboard constants defined code dnd code built bitwise ing code code code dnd code clipboard constants param transfer transfer agent type data requested param clipboards data data clipboard data type exception swtexception error widget disposed receiver disposed error thread invalid access called thread created receiver exception illegal argument exception illegalargumentexception error argument transfer transfer dnd clipboard dnd selection clipboard object get contents getcontents transfer transfer clipboards check widget checkwidget transfer dnd error swt error argument clipboards dnd clipboard bug windows application takes control clipboard applications open clipboard determine record clipoard updates clipboard accessed application finished applications release clipboard peek message peekmessage enable cross thread message sends ppv retry count retrycount result ole get clipboard olegetclipboard ppv result retry count retrycount thread sleep throwable msg msg msg peek message peekmessage msg noremove noyield result ole get clipboard olegetclipboard ppv result idata object idataobject data object dataobject idata object idataobject ppv transfer data transferdata allowed transfer get supported types getsupportedtypes allowed length data object dataobject query get data querygetdata allowed formatetc transfer data transferdata data allowed data p idata object pidataobject ppv transfer native to java nativetojava data data object dataobject release data transfer returns code code clipboard disposed code code method dispose clipboard clipboard disposed error invoke method clipboard code code widget disposed code code is disposed isdisposed display place data type system clipboard type data system clipboard time setting data clears previous data system clipboard type note platforms data copied system clipboard platforms request result application modifes data object clipboard modification data subsequently requested snippet text rtf text copy paste clipboard code pre clipboard clipboard clipboard display string text data textdata string rtf data rtfdata rtf text transfer texttransfer text transfer texttransfer text transfer texttransfer get instance getinstance rtftransfer rtf transfer rtftransfer rtftransfer get instance getinstance transfer transfers transfer text transfer texttransfer rtf transfer rtftransfer object data object text data textdata rtf data rtfdata clipboard set contents setcontents data transfers clipboard dispose code pre param data data clipboard param data types datatypes transfer agents convert data platform specific format entry data array data type datatype exception illegal argument exception illegalargumentexception error invalid argument data datatypes length data length data types datatypes exception swtexception error widget disposed receiver disposed error thread invalid access called thread created receiver exception swterror error clipboard clipboard locked unavailable note error clipboard swtexception recoverable error changed compatability set contents setcontents object data transfer data types datatypes set contents setcontents data data types datatypes dnd clipboard place data type clipboard type data clipboard time setting data clears previous data clipboard type note platforms data copied clipboard platforms request result application modifes data object clipboard modification data subsequently requested clipboards clipboard constants defined code dnd code built bitwise ing code code code dnd code clipboard constants snippet text rtf text copy paste clipboard code pre clipboard clipboard clipboard display string text data textdata string rtf data rtfdata rtf text transfer texttransfer text transfer texttransfer text transfer texttransfer get instance getinstance rtftransfer rtf transfer rtftransfer rtftransfer get instance getinstance transfer transfers transfer text transfer texttransfer rtf transfer rtftransfer object data object text data textdata rtf data rtfdata clipboard set contents setcontents data transfers dnd clipboard clipboard dispose code pre param data data clipboard param data types datatypes transfer agents convert data platform specific format entry data array data type datatype param clipboards data exception illegal argument exception illegalargumentexception error invalid argument data datatypes length data length data types datatypes exception swtexception error widget disposed receiver disposed error thread invalid access called thread created receiver exception swterror error clipboard clipboard locked unavailable note error clipboard swtexception recoverable error changed compatability dnd clipboard dnd selection clipboard set contents setcontents object data transfer data types datatypes clipboards check widget checkwidget data data types datatypes data length data types datatypes length data length dnd error swt error invalid argument data length data data types datatypes data types datatypes validate data dnd error swt error invalid argument clipboards dnd clipboard data data transfer agents transferagents data types datatypes result ole set clipboard olesetclipboard i data object idataobject get address getaddress bug windows application takes control clipboard applications open clipboard determine record clipoard updates clipboard flushed application finished applications data peek message peekmessage enable cross thread message sends retry count retrycount result retry count retrycount thread sleep throwable msg msg msg peek message peekmessage msg noremove noyield result ole set clipboard olesetclipboard i data object idataobject get address getaddress result dnd error dnd error clipboard add ref addref ref count refcount ref count refcount create cominterfaces createcominterfaces register interfaces object i data object idataobject comobject method args query interface queryinterface args args method args add ref addref method args release method args get data getdata args args method get data here getdatahere implemented method args query get data querygetdata args method get canonical format etc getcanonicalformatetc implemented method set data setdata implemented method args enum format etc enumformatetc args args dispose cominterfaces disposecominterfaces i data object idataobject i data object idataobject dispose i data object idataobject enum format etc enumformatetc dw direction dwdirection ppenum formatetc ppenumformatetc data set data setdata supported dw direction dwdirection datadir notimpl types registered transfer data transferdata allowed data types alloweddatatypes transfer data transferdata transfer agents transferagents length transfer data transferdata formats transfer agents transferagents get supported types getsupportedtypes transfer data transferdata new allowed data types newalloweddatatypes transfer data transferdata allowed data types alloweddatatypes length formats length system arraycopy allowed data types alloweddatatypes new allowed data types newalloweddatatypes allowed data types alloweddatatypes length system arraycopy formats new allowed data types newalloweddatatypes allowed data types alloweddatatypes length formats length allowed data types alloweddatatypes new allowed data types newalloweddatatypes ole enum formatetc oleenumformatetc enum formatetc enumformatetc ole enum formatetc oleenumformatetc enum formatetc enumformatetc add ref addref formatetc formats formatetc allowed data types alloweddatatypes length allowed data types alloweddatatypes length formats allowed data types alloweddatatypes formatetc include drop format copy operation formatetc dropeffect formatetc dropeffect cf format cfformat cfstr preferreddropeffect dropeffect dw aspect dwaspect dvaspect content dropeffect lindex dropeffect tymed tymed hglobal formats formats length dropeffect enum formatetc enumformatetc set formats setformats formats move memory movememory ppenum formatetc ppenumformatetc enum formatetc enumformatetc get address getaddress get data getdata p formatetc pformatetc pmedium called data consumer data source data object get data getdata method renders data formatetc structure transfers stgmedium structure caller assumes responsibility releasing stgmedium structure p formatetc pformatetc pmedium invalidarg query get data querygetdata p formatetc pformatetc formatetc transfer data transferdata transfer data transferdata transfer data transferdata transfer data transferdata formatetc formatetc move memory movememory transfer data transferdata formatetc p formatetc pformatetc formatetc sizeof transfer data transferdata type transfer data transferdata formatetc cf format cfformat transfer data transferdata stgmedium stgmedium transfer data transferdata result fail transfer data transferdata type cfstr preferreddropeffect copy operation performed stgmedium stgmedium stgmedium stgmedium tymed tymed hglobal stgmedium union field unionfield global alloc globalalloc gmem fixed gmem zeroinit move memory movememory stgmedium union field unionfield dropeffect copy stgmedium p unk for release punkforrelease move memory movememory pmedium stgmedium stgmedium sizeof matching transfer agent perform conversion transfer index transferindex transfer agents transferagents length transfer agents transferagents is supported type issupportedtype transfer data transferdata transfer index transferindex transfer index transferindex formatetc transfer agents transferagents transfer index transferindex java to native javatonative data transfer index transferindex transfer data transferdata move memory movememory pmedium transfer data transferdata stgmedium stgmedium sizeof transfer data transferdata result query get data querygetdata p formatetc pformatetc transfer agents transferagents fail transfer data transferdata transfer data transferdata transfer data transferdata transfer data transferdata formatetc formatetc move memory movememory transfer data transferdata formatetc p formatetc pformatetc formatetc sizeof transfer data transferdata type transfer data transferdata formatetc cf format cfformat transfer data transferdata type cfstr preferreddropeffect type supported transfer agent transfer agents transferagents length transfer agents transferagents is supported type issupportedtype transfer data transferdata formatetc query interface queryinterface riid ppv object ppvobject riid ppv object ppvobject invalidarg guid guid guid move memory movememory guid riid guid sizeof is equal guid isequalguid guid iidiunknown is equal guid isequalguid guid iididata object iididataobject move memory movememory ppv object ppvobject i data object idataobject get address getaddress add ref addref move memory movememory ppv object ppvobject nointerface release ref count refcount ref count refcount data object transfer agents transferagents transfer dispose cominterfaces disposecominterfaces co free unused libraries cofreeunusedlibraries ref count refcount returns array data types system clipboard transfer is supported type issupportedtype array data types system clipboard exception swtexception error widget disposed receiver disposed error thread invalid access called thread created receiver transfer is supported type issupportedtype transfer data transferdata get available types getavailabletypes get available types getavailabletypes dnd clipboard returns array data types clipboard transfer is supported type issupportedtype clipboards clipboard constants defined code dnd code built bitwise ing code code code dnd code clipboard constants param clipboards data types array data types clipboard exception swtexception error widget disposed receiver disposed error thread invalid access called thread created receiver transfer is supported type issupportedtype dnd clipboard dnd selection clipboard transfer data transferdata get available types getavailabletypes clipboards check widget checkwidget clipboards dnd clipboard transfer data transferdata formatetc types get available types getavailabletypes transfer data transferdata data transfer data transferdata types length types length data transfer data transferdata data type types cf format cfformat data formatetc types data returns platform specific list data types system clipboard note code get available type names getavailabletypenames code utility writing transfer application platform specific platform specific list data types system clipboard exception swtexception error widget disposed receiver disposed error thread invalid access called thread created receiver string get available type names getavailabletypenames check widget checkwidget formatetc types get available types getavailabletypes string names string types length max size maxsize types length tchar buffer tchar max size maxsize size get clipboard format name getclipboardformatname types cf format cfformat buffer max size maxsize size names buffer to string tostring size types cf format cfformat nls hdrop nls names hdrop nls nls text nls names text nls nls bitmap nls names bitmap nls nls metafilepict nls names metafilepict nls nls sylk nls names sylk nls nls dif nls names dif nls nls tiff nls names tiff nls nls oemtext nls names oemtext nls nls dib nls names dib nls nls palette nls names palette nls nls pendata nls names pendata nls nls riff nls names riff nls nls wave nls names wave nls nls unicodetext nls names unicodetext nls nls enhmetafile nls names enhmetafile nls nls locale nls names locale nls nls max nls names max nls nls names nls unknown names formatetc get available types getavailabletypes formatetc types formatetc ppv ole get clipboard olegetclipboard ppv types idata object idataobject data object dataobject idata object idataobject ppv pp formatetc ppformatetc data object dataobject enum format etc enumformatetc datadir pp formatetc ppformatetc data object dataobject release types ienum formatetc ienumformatetc enum formatetc enumformatetc ienum formatetc ienumformatetc pp formatetc ppformatetc loop enumerator save types match rgelt global alloc globalalloc gmem fixed gmem zeroinit formatetc sizeof pcelt fetched pceltfetched enum formatetc enumformatetc reset enum formatetc enumformatetc rgelt pcelt fetched pceltfetched pcelt fetched pceltfetched formatetc formatetc formatetc move memory movememory formatetc rgelt formatetc sizeof formatetc new types newtypes formatetc types length system arraycopy types new types newtypes types length new types newtypes types length formatetc types new types newtypes global free globalfree rgelt enum formatetc enumformatetc release types