copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse swt ole win org eclipse swt internal ole win org eclipse swt internal win ole automation oleautomation mechanism accessing functionality specific active x activex control ole document ole document active x activex control support idispatch order provide ole automation oleautomation support additional functionality ole object idl file additional methods property values code get property getproperty code property values code set property setproperty code invoke method code invoke code code invoke no reply invokenoreply code arguments passed form code variant code objects sample idl fragment pre imy control imycontrol idispatch propget hresult max file count maxfilecount retval propput hresult max file count maxfilecount hresult add file addfile bstr file name filename pre interact extended functionality code pre ole automation oleautomation automation ole automation oleautomation my control site mycontrolsite max file count maxfilecount parameter rgdispid automation get ids of names getidsofnames string max file count maxfilecount max file count id maxfilecountid rgdispid property max file count maxfilecount automation set property setproperty max file count id maxfilecountid variant system println max file count max file count maxfilecount parameter variant p var result pvarresult automation get property getproperty max file count id maxfilecountid p var result pvarresult system println max file count p var result pvarresult get int getint invoke add file addfile method ids add file addfile method parameter rgdispid automation get ids of names getidsofnames string add file addfile file name filename disp id member dispidmember rgdispid rgdispid named args rgdispidnamedargs rgdispid convert arguments variant objects variant rgvarg variant string file name filename testfile rgvarg variant file name filename call method variant p var result pvarresult automation invoke disp id member dispidmember rgvarg rgdispid named args rgdispidnamedargs check p var result pvarresult p var result pvarresult get int getint ole system println failed add file file name filename automation dispose pre code ole automation oleautomation idispatch obj idispatch objidispatch string exception description exceptiondescription itype info itypeinfo obj itype info objitypeinfo ole automation oleautomation idispatch idispatch idispatch ole error ole error invalid address obj idispatch objidispatch idispatch obj idispatch objidispatch add ref addref ppv result obj idispatch objidispatch get type info gettypeinfo locale user ppv result ole obj itype info objitypeinfo itype info itypeinfo ppv obj itype info objitypeinfo add ref addref creates ole automation oleautomation object client param client site clientsite site ole document active x activex control additional functionality access exception illegal argument exception illegalargumentexception error invalid address called invalid client site ole automation oleautomation ole client site oleclientsite client site clientsite client site clientsite ole error ole error invalid address obj idispatch objidispatch client site clientsite get automation object getautomationobject ppv result obj idispatch objidispatch get type info gettypeinfo locale user ppv result ole obj itype info objitypeinfo itype info itypeinfo ppv obj itype info objitypeinfo add ref addref disposes automation object method releases idispatch ole document active x activex control ole automation oleautomation object disposed dispose obj idispatch objidispatch obj idispatch objidispatch release obj idispatch objidispatch obj itype info objitypeinfo obj itype info objitypeinfo release obj itype info objitypeinfo get address getaddress obj idispatch objidispatch get address getaddress string get help file gethelpfile disp id dispid obj itype info objitypeinfo string file string obj itype info objitypeinfo get documentation getdocumentation disp id dispid file ole file string get documentation getdocumentation disp id dispid obj itype info objitypeinfo string doc string obj itype info objitypeinfo get documentation getdocumentation disp id dispid doc ole doc ole property description olepropertydescription get property description getpropertydescription obj itype info objitypeinfo pp var desc ppvardesc obj itype info objitypeinfo get var desc getvardesc pp var desc ppvardesc ole vardesc vardesc vardesc move memory movememory vardesc pp var desc ppvardesc vardesc sizeof ole property description olepropertydescription data ole property description olepropertydescription data vardesc memid data get name getname vardesc memid data type vardesc elemdesc var elemdescvar tdesc data type ole ptr move memory movememory vardesc elemdesc var elemdescvar tdesc union data type data flags vardesc w var flags wvarflags data kind vardesc varkind data description get documentation getdocumentation vardesc memid data help file helpfile get help file gethelpfile vardesc memid obj itype info objitypeinfo release var desc releasevardesc pp var desc ppvardesc data ole function description olefunctiondescription get function description getfunctiondescription obj itype info objitypeinfo pp func desc ppfuncdesc obj itype info objitypeinfo get func desc getfuncdesc pp func desc ppfuncdesc ole funcdesc funcdesc funcdesc move memory movememory funcdesc pp func desc ppfuncdesc funcdesc sizeof ole function description olefunctiondescription data ole function description olefunctiondescription data funcdesc memid data optional arg count optionalargcount funcdesc c params opt cparamsopt data invoke kind invokekind funcdesc invkind data func kind funckind funcdesc funckind data flags funcdesc w func flags wfuncflags data calling convention callingconvention funcdesc callconv data documentation get documentation getdocumentation funcdesc memid data help file helpfile get help file gethelpfile funcdesc memid string names get names getnames funcdesc memid funcdesc c params cparams names length data names data args ole parameter description oleparameterdescription funcdesc c params cparams data args length data args ole parameter description oleparameterdescription names length data args names move memory movememory funcdesc lprgelemdesc param lprgelemdescparam ole ptr p typedesc ptypedesc move memory movememory p typedesc ptypedesc funcdesc lprgelemdesc param lprgelemdescparam move memory movememory p typedesc ptypedesc byref data args type w param flags wparamflags move memory movememory w param flags wparamflags funcdesc lprgelemdesc param lprgelemdescparam data args flags w param flags wparamflags data return type returntype funcdesc elemdesc func elemdescfunc tdesc data return type returntype ole ptr move memory movememory funcdesc elemdesc func elemdescfunc tdesc union data return type returntype obj itype info objitypeinfo release func desc releasefuncdesc pp func desc ppfuncdesc data typeattr get type info attributes gettypeinfoattributes obj itype info objitypeinfo pp type attr pptypeattr obj itype info objitypeinfo get type attr gettypeattr pp type attr pptypeattr ole typeattr typeattr typeattr move memory movememory typeattr pp type attr pptypeattr typeattr sizeof obj itype info objitypeinfo release type attr releasetypeattr pp type attr pptypeattr typeattr string get name getname disp id dispid obj itype info objitypeinfo string string obj itype info objitypeinfo get documentation getdocumentation disp id dispid ole string get names getnames disp id dispid max size maxsize obj itype info objitypeinfo string string names string max size maxsize count obj itype info objitypeinfo get names getnames disp id dispid names max size maxsize count ole string new names newnames string count system arraycopy names new names newnames count new names newnames string returns positive integer values ids names idispatch implementor names parameters method string names array method names parameters param names array names require identifiers positive integer values names order names names unknown get ids of names getidsofnames string names rgdispid names length result obj idispatch objidispatch get ids of names getidsofnames guid names names length locale user rgdispid result rgdispid returns description error encountered description error encountered string get last error getlasterror exception description exceptiondescription returns property disp id member dispidmember param disp id member dispidmember property idl active x activex control ole automation oleautomation get ids of names getidsofnames property disp id member dispidmember variant get property getproperty disp id member dispidmember variant p var result pvarresult variant result invoke disp id member dispidmember dispatch propertyget p var result pvarresult result ole p var result pvarresult returns property disp id member dispidmember param disp id member dispidmember property idl active x activex control ole automation oleautomation get ids of names getidsofnames param rgvarg array arguments method arguments considered read variant reference variant type property disp id member dispidmember variant get property getproperty disp id member dispidmember variant rgvarg variant p var result pvarresult variant result invoke disp id member dispidmember dispatch propertyget rgvarg p var result pvarresult result ole p var result pvarresult returns property disp id member dispidmember param disp id member dispidmember property idl active x activex control ole automation oleautomation get ids of names getidsofnames param rgvarg array arguments method arguments considered read variant reference variant type param rgdispid named args rgdispidnamedargs array identifiers arguments rgvarg parameter ids order values arguments identifier identifiers ole automation oleautomation get ids of names getidsofnames property disp id member dispidmember variant get property getproperty disp id member dispidmember variant rgvarg rgdispid named args rgdispidnamedargs variant p var result pvarresult variant result invoke disp id member dispidmember dispatch propertyget rgvarg rgdispid named args rgdispidnamedargs p var result pvarresult result ole p var result pvarresult invokes method ole object method parameters param disp id member dispidmember method idl active x activex control ole automation oleautomation get ids of names getidsofnames result method method failed result variant invoke disp id member dispidmember variant p var result pvarresult variant result invoke disp id member dispidmember dispatch method p var result pvarresult result p var result pvarresult invokes method ole object method optional parameters param disp id member dispidmember method idl active x activex control ole automation oleautomation get ids of names getidsofnames param rgvarg array arguments method arguments considered read variant reference variant type result method method failed result variant invoke disp id member dispidmember variant rgvarg variant p var result pvarresult variant result invoke disp id member dispidmember dispatch method rgvarg p var result pvarresult result p var result pvarresult invokes method ole object method optional parameters optional parameters include parameters providing values param disp id member dispidmember method idl active x activex control ole automation oleautomation get ids of names getidsofnames param rgvarg array arguments method arguments considered read variant reference variant type param rgdispid named args rgdispidnamedargs array identifiers arguments rgvarg parameter ids order values arguments identifier identifiers ole automation oleautomation get ids of names getidsofnames result method method failed result variant invoke disp id member dispidmember variant rgvarg rgdispid named args rgdispidnamedargs variant p var result pvarresult variant result invoke disp id member dispidmember dispatch method rgvarg rgdispid named args rgdispidnamedargs p var result pvarresult result p var result pvarresult invoke disp id member dispidmember w flags wflags variant rgvarg rgdispid named args rgdispidnamedargs variant p var result pvarresult idispatch control obj idispatch objidispatch fail create dispparams structure input parameters dispparams p disp params pdispparams dispparams store arguments rgvarg rgvarg rgvarg length p disp params pdispparams c args cargs rgvarg length p disp params pdispparams rgvarg global alloc globalalloc gmem fixed gmem zeroinit variant sizeof rgvarg length offset rgvarg length rgvarg get data getdata p disp params pdispparams rgvarg offset offset variant sizeof arguments ids store ids rgdispid named args rgdispidnamedargs rgdispid named args rgdispidnamedargs rgdispid named args rgdispidnamedargs length p disp params pdispparams c named args cnamedargs rgdispid named args rgdispidnamedargs length p disp params pdispparams rgdispid named args rgdispidnamedargs global alloc globalalloc gmem fixed gmem zeroinit rgdispid named args rgdispidnamedargs length offset rgdispid named args rgdispidnamedargs length move memory movememory p disp params pdispparams rgdispid named args rgdispidnamedargs offset rgdispid named args rgdispidnamedargs offset invoke method excepinfo excep info excepinfo excepinfo p arg err pargerr p var result address pvarresultaddress p var result pvarresult p var result address pvarresultaddress global alloc globalalloc gmem fixed gmem zeroinit variant sizeof result obj idispatch objidispatch invoke disp id member dispidmember guid locale user w flags wflags p disp params pdispparams p var result address pvarresultaddress excep info excepinfo p arg err pargerr p var result address pvarresultaddress p var result pvarresult set data setdata p var result address pvarresultaddress variant clear variantclear p var result address pvarresultaddress global free globalfree p var result address pvarresultaddress free dispparams resources p disp params pdispparams rgdispid named args rgdispidnamedargs global free globalfree p disp params pdispparams rgdispid named args rgdispidnamedargs p disp params pdispparams rgvarg offset length rgvarg length length variant clear variantclear p disp params pdispparams rgvarg offset offset variant sizeof global free globalfree p disp params pdispparams rgvarg save error string cleanup excepinfo manage excepinfo manageexcepinfo result excep info excepinfo result invokes method ole object method parameters early days ole idispatch defined applications word support applications call method calling code invoke disp id member dispidmember code param disp id member dispidmember method idl active x activex control ole automation oleautomation get ids of names getidsofnames exception swtexception error action performed method invocation fails invoke no reply invokenoreply disp id member dispidmember result invoke disp id member dispidmember dispatch method result ole error ole error action performed result invokes method ole object method optional parameters early days ole idispatch defined applications word support applications call method calling code invoke disp id member dispidmember variant rgvarg code param disp id member dispidmember method idl active x activex control ole automation oleautomation get ids of names getidsofnames param rgvarg array arguments method arguments considered read variant reference variant type exception swtexception error action performed method invocation fails invoke no reply invokenoreply disp id member dispidmember variant rgvarg result invoke disp id member dispidmember dispatch method rgvarg result ole error ole error action performed result invokes method ole object method optional parameters optional parameters include parameters providing values early days ole idispatch defined applications word support applications call method calling code invoke disp id member dispidmember variant rgvarg rgdispid named args rgdispidnamedargs code param disp id member dispidmember method idl active x activex control ole automation oleautomation get ids of names getidsofnames param rgvarg array arguments method arguments considered read variant reference variant type param rgdispid named args rgdispidnamedargs array identifiers arguments rgvarg parameter ids order values arguments identifier identifiers ole automation oleautomation get ids of names getidsofnames exception swtexception error action performed method invocation fails invoke no reply invokenoreply disp id member dispidmember variant rgvarg rgdispid named args rgdispidnamedargs result invoke disp id member dispidmember dispatch method rgvarg rgdispid named args rgdispidnamedargs result ole error ole error action performed result manage excepinfo manageexcepinfo h result hresult excepinfo excep info excepinfo h result hresult nls exception description exceptiondescription error extract exception info h result hresult disp exception excep info excepinfo bstr description bstrdescription size sys string byte len sysstringbytelen excep info excepinfo bstr description bstrdescription buffer size move memory movememory buffer excep info excepinfo bstr description bstrdescription size exception description exceptiondescription string buffer nls exception description exceptiondescription ole automation error exception excep info excepinfo w code wcode exception description exceptiondescription code nls excep info excepinfo w code wcode excep info excepinfo scode exception description exceptiondescription code nls excep info excepinfo scode nls exception description exceptiondescription ole automation error hresult h result hresult cleanup excepinfo struct excep info excepinfo bstr description bstrdescription sys free string sysfreestring excep info excepinfo bstr description bstrdescription excep info excepinfo bstr help file bstrhelpfile sys free string sysfreestring excep info excepinfo bstr help file bstrhelpfile excep info excepinfo bstr source bstrsource sys free string sysfreestring excep info excepinfo bstr source bstrsource sets property disp id member dispidmember param disp id member dispidmember property idl active x activex control ole automation oleautomation get ids of names getidsofnames param rgvarg property operation successful set property setproperty disp id member dispidmember variant rgvarg variant rgvarg variant rgvarg rgdispid named args rgdispidnamedargs dispid propertyput dw flags dwflags dispatch propertyput rgvarg get type gettype byref byref dw flags dwflags dispatch propertyputref variant p var result pvarresult variant result invoke disp id member dispidmember dw flags dwflags rgvarg rgdispid named args rgdispidnamedargs p var result pvarresult result sets property disp id member dispidmember param disp id member dispidmember property idl active x activex control ole automation oleautomation get ids of names getidsofnames param rgvarg array arguments method arguments considered read variant reference variant type operation successful set property setproperty disp id member dispidmember variant rgvarg rgdispid named args rgdispidnamedargs dispid propertyput dw flags dwflags dispatch propertyput rgvarg length rgvarg get type gettype byref byref dw flags dwflags dispatch propertyputref variant p var result pvarresult variant result invoke disp id member dispidmember dw flags dwflags rgvarg rgdispid named args rgdispidnamedargs p var result pvarresult result