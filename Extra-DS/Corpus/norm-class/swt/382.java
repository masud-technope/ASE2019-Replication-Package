copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse swt ole win java file java file output stream fileoutputstream java file input stream fileinputstream java ioexception org eclipse swt org eclipse swt internal compatibility org eclipse swt internal ole win org eclipse swt graphics org eclipse swt widgets org eclipse swt internal win ole client site oleclientsite site manage embedded ole document container ole client site oleclientsite capabilities creates place editor blank document opening existing ole document lays editor mechanism activating deactivating document mechanism saving document object ole interfaces iunknown iole client site ioleclientsite iadvise sink iadvisesink iole in place site ioleinplacesite note subclass code composite code sense add code control code children layout styles border events dispose move resize ole client site oleclientsite composite interfaces ole client container comobject i unknown iunknown comobject i ole client site ioleclientsite comobject i advise sink iadvisesink comobject i ole in place site ioleinplacesite comobject i ole document site ioledocumentsite guid app clsid appclsid guid obj clsid objclsid ref count refcount references frame ole frame oleframe frame access embedded linked ole object iunknown obj iunknown objiunknown iole object ioleobject obj iole object objioleobject iview object iviewobject obj iview object objiviewobject iole in place object ioleinplaceobject obj iole in place object objioleinplaceobject iole command target iolecommandtarget obj iole command target objiolecommandtarget iole document view ioledocumentview obj document view objdocumentview storage istorage receiver istorage temp storage tempstorage internal style display aspect embedded object dvaspect content dvaspectcontent dvaspect icon dvaspecticon aspect type client supported container type item display bitmap metafile is static isstatic rect border widths borderwidths rect rect indent rect in update inupdate in init ininit in dispose indispose nls string wordprogid word document listener listener running inplaceactive uiactive active ole client site oleclientsite composite parent style note constructor create ole object parent style create cominterfaces createcominterfaces install ole frame client site parent parent ole frame oleframe frame ole frame oleframe parent parent parent get parent getparent frame ole error swt error invalid argument frame add ref addref aspect dvaspect content type oleembedded is static isstatic listener listener handle event handleevent event type swt resize swt move on resize onresize swt dispose on dispose ondispose swt focus in focusin on focus in onfocusin swt focus out focusout on focus out onfocusout swt paint on paint onpaint swt traverse on traverse ontraverse swt key down keydown required traversal ole error swt error implemented frame add listener addlistener swt resize listener frame add listener addlistener swt move listener add listener addlistener swt dispose listener add listener addlistener swt focus in focusin listener add listener addlistener swt focus out focusout listener add listener addlistener swt paint listener add listener addlistener swt traverse listener add listener addlistener swt key down keydown listener create ole client site oleclientsite child widget ole document type file ole document type determined header file registry entry file extension style bits select properties param parent composite widget ole frame oleframe param style bitwise ing widget styles param file file opened ole document exception illegal argument exception illegalargumentexception error argument parent error invalid argument parent ole frame oleframe exception swtexception error thread invalid access called wrong thread error create object failed create ole object error open file failed open file error unable create callbacks ole interfaces error invalid classid ole client site oleclientsite composite parent style file file parent style file file is directory isdirectory file exists ole error ole error invalid argument clsid app clsid appclsid guid file name filename file get absolute path getabsolutepath to char array tochararray result get class file getclassfile file name filename app clsid appclsid result ole error ole error invalid classid result clsid installed machine get program id getprogramid ole error ole error invalid classid result open temporary storage object temp storage tempstorage create temp storage createtempstorage create ole object storage object address result ole create from file olecreatefromfile app clsid appclsid file name filename iidiunknown olerender draw temp storage tempstorage get address getaddress address result ole error ole error create object result obj iunknown objiunknown iunknown address init sinks add object references addobjectreferences ole run olerun obj iunknown objiunknown get address getaddress ole running swtexception dispose dispose cominterfaces disposecominterfaces create ole client site oleclientsite child widget edit blank document ole document application style bits select properties param parent composite widget ole frame oleframe param style bitwise ing widget styles param prog id progid unique program identifier ole document application prog id progid key version independent prog id versionindependentprogid key registry desired ole document version independent prog id versionindependentprogid word word document exception illegal argument exception illegalargumentexception error argument parent error invalid argument parent ole frame oleframe exception swtexception error thread invalid access called wrong thread error invalid classid prog id progid map registered clsid error create object failed create ole object ole client site oleclientsite composite parent style string prog id progid parent style app clsid appclsid get class id getclassid prog id progid app clsid appclsid ole error ole error invalid classid open temporary storage object temp storage tempstorage create temp storage createtempstorage create ole object storage object address result ole create olecreate app clsid appclsid iidiunknown olerender draw temp storage tempstorage get address getaddress address result ole error ole error create object result obj iunknown objiunknown iunknown address init sinks add object references addobjectreferences ole run olerun obj iunknown objiunknown get address getaddress ole running swtexception dispose dispose cominterfaces disposecominterfaces create ole client site oleclientsite child widget edit file ole document application style bits select properties method api code ole client site oleclientsite code marked shared packages swt platforms called application code param parent composite widget ole frame oleframe param style bitwise ing widget styles param prog id progid unique program identifier ole document application prog id progid key version independent prog id versionindependentprogid key registry desired ole document version independent prog id versionindependentprogid word word document param file file opened ole document exception illegal argument exception illegalargumentexception error argument parent error invalid argument parent ole frame oleframe exception swtexception error thread invalid access called wrong thread error invalid classid prog id progid map registered clsid error create object failed create ole object error open file failed open file ole client site oleclientsite composite parent style string prog id progid file file parent style file file is directory isdirectory file exists ole error ole error invalid argument app clsid appclsid get class id getclassid prog id progid opening file preferred ole object file name filename file get absolute path getabsolutepath to char array tochararray guid file clsid fileclsid guid get class file getclassfile file name filename file clsid fileclsid is equal guid isequalguid app clsid appclsid file clsid fileclsid application created file mechanism temp storage tempstorage create temp storage createtempstorage create ole object storage object address result ole create from file olecreatefromfile app clsid appclsid file name filename iidiunknown olerender draw temp storage tempstorage get address getaddress address result ole error ole error create object result obj iunknown objiunknown iunknown address application created file copy original file storage file istorage storage stg is storage file stgisstoragefile file name filename address mode stgm read stgm transacted stgm share exclusive add ref addref successful result stg open storage stgopenstorage file name filename mode address result ole error ole error open file result storage istorage address original file storage file copy contents stream storage file address mode stgm readwrite stgm direct stgm share exclusive stgm create increments count successful result stg create docfile stgcreatedocfile mode stgm deleteonrelease address result ole error ole error open file result storage istorage address create stream storage object word follow standard contents primary stream string nls stream name streamname nls contents guid word guid wordguid get class id getclassid wordprogid is equal guid isequalguid app clsid appclsid word guid wordguid stream name streamname word document worddocument address increments count successful result storage create stream createstream stream name streamname mode address result storage release ole error ole error open file result istream stream istream address copy data file named stream file input stream fileinputstream file input fileinput file input stream fileinputstream file increment buffer increment count count file input fileinput read buffer co task mem alloc cotaskmemalloc count move memory movememory buffer count result stream write count co task mem free cotaskmemfree result file input fileinput close stream release storage release ole error ole error open file result file input fileinput close stream commit stgc stream release ioexception err stream release storage release ole error ole error open file open temporary storage object temp storage tempstorage create temp storage createtempstorage copy contents file result storage copy to copyto temp storage tempstorage get address getaddress storage release result ole error ole error open file result create ole client ppv result co create instance cocreateinstance app clsid appclsid clsctx inproc handler clsctx inproc server iidiunknown ppv result ole error ole error create object result obj iunknown objiunknown iunknown ppv persistant storage ole client ppv result obj iunknown objiunknown query interface queryinterface iidipersist storage iidipersiststorage ppv result ole error ole error create object result ipersist storage ipersiststorage i persist storage ipersiststorage ipersist storage ipersiststorage ppv load contents file ole client site result i persist storage ipersiststorage load temp storage tempstorage get address getaddress i persist storage ipersiststorage release result ole error ole error create object result init sinks add object references addobjectreferences ole run olerun obj iunknown objiunknown get address getaddress ole running swtexception dispose dispose cominterfaces disposecominterfaces add object references addobjectreferences ppv object ppvobject obj iunknown objiunknown query interface queryinterface iidipersist ppv object ppvobject ipersist obj ipersist objipersist ipersist ppv object ppvobject guid tempid guid obj ipersist objipersist get class id getclassid tempid obj clsid objclsid tempid obj ipersist objipersist release ppv object ppvobject result obj iunknown objiunknown query interface queryinterface iidiview object iidiviewobject ppv object ppvobject result ole error ole error result obj iview object objiviewobject iview object iviewobject ppv object ppvobject obj iview object objiviewobject set advise setadvise aspect i advise sink iadvisesink get address getaddress ppv object ppvobject result obj iunknown objiunknown query interface queryinterface iidiole object iidioleobject ppv object ppvobject result ole error ole error result obj iole object objioleobject iole object ioleobject ppv object ppvobject obj iole object objioleobject set client site setclientsite i ole client site ioleclientsite get address getaddress pdw connection pdwconnection obj iole object objioleobject advise i advise sink iadvisesink get address getaddress pdw connection pdwconnection nls nls obj iole object objioleobject set host names sethostnames main main notify control object embedded ole container ole set contained object olesetcontainedobject obj iunknown objiunknown get address getaddress ole object linked embedded ppv object ppvobject obj iunknown objiunknown query interface queryinterface iidiole link iidiolelink ppv object ppvobject iole link iolelink obj iole link objiolelink iole link iolelink ppv object ppvobject ppmk obj iole link objiolelink get source moniker getsourcemoniker ppmk imoniker obj imoniker objimoniker imoniker ppmk obj imoniker objimoniker release type olelinked obj iole link objiolelink bind if running bindifrunning is static isstatic obj iole link objiolelink release add ref addref ref count refcount ref count refcount can in place activate caninplaceactivate aspect dvaspect content type oleembedded context sensitive help contextsensitivehelp f enter mode fentermode create cominterfaces createcominterfaces i unknown iunknown comobject method args query interface queryinterface args args method args add ref addref method args release i ole client site ioleclientsite comobject method args query interface queryinterface args args method args add ref addref method args release method args save object saveobject method get moniker getmoniker implemented method args get container getcontainer args method args show object showobject method args on show window onshowwindow args i advise sink iadvisesink comobject method args query interface queryinterface args args method args add ref addref method args release method args on data change ondatachange args args method args on view change onviewchange args args method on rename onrename implemented method args on save onsave method args on close onclose i ole in place site ioleinplacesite comobject method args query interface queryinterface args args method args add ref addref method args release method args get window getwindow args method args context sensitive help contextsensitivehelp args method args can in place activate caninplaceactivate method args on in place activate oninplaceactivate method args on uiactivate onuiactivate method args get window context getwindowcontext args args args args args method args scroll args method args on uideactivate onuideactivate args method args on in place deactivate oninplacedeactivate method discard undo state discardundostate implemented method deactivate and undo change deactivateandundochange implemented method args on pos rect change onposrectchange args i ole document site ioledocumentsite comobject method args query interface queryinterface args args method args add ref addref method args release method args activate me activateme args istorage create temp storage createtempstorage temp storage tempstorage grf mode grfmode stgm readwrite stgm share exclusive stgm deleteonrelease result stg create docfile stgcreatedocfile grf mode grfmode temp storage tempstorage result ole error ole error create file result istorage temp storage tempstorage deactivates active place object discards object undo deactivate in place client deactivateinplaceclient obj iole in place object objioleinplaceobject obj iole in place object objioleinplaceobject in place deactivate inplacedeactivate delete temp storage deletetempstorage destroy item contents temp root istorage temp storage tempstorage temp storage tempstorage release temp storage tempstorage dispose cominterfaces disposecominterfaces i unknown iunknown i unknown iunknown dispose i unknown iunknown i ole client site ioleclientsite i ole client site ioleclientsite dispose i ole client site ioleclientsite i advise sink iadvisesink i advise sink iadvisesink dispose i advise sink iadvisesink i ole in place site ioleinplacesite i ole in place site ioleinplacesite dispose i ole in place site ioleinplacesite i ole document site ioledocumentsite i ole document site ioledocumentsite dispose i ole document site ioledocumentsite requests ole document active x activex control perform action actions activation param verb operation requested ole oleiverb values hresult indicating success operation request ole success do verb doverb verb ensure client running invoking verb ole run olerun obj iunknown objiunknown get address getaddress ole running is static isstatic fail rzw result obj iole object objioleobject do verb doverb verb i ole client site ioleclientsite get address getaddress handle running in init ininit update storage updatestorage in init ininit result asks ole document active x activex control execute command standard list commands ole document active x activex control support iole command target iolecommandtarget ole document active x activex control support commands standard list check command supported call query status querystatus cmd id cmdid param cmd id cmdid command ole olecmdid values small common commands param options optional flags ole olecmdexecopt values param argument command param command hresult ole returned successful exec cmd id cmdid options variant variant obj iole command target objiolecommandtarget address obj iunknown objiunknown query interface queryinterface iidiole command target iidiolecommandtarget address ole error obj iole command target objiolecommandtarget iole command target iolecommandtarget address in address inaddress in address inaddress global alloc globalalloc gmem fixed gmem zeroinit variant sizeof get data getdata in address inaddress out address outaddress out address outaddress global alloc globalalloc gmem fixed gmem zeroinit variant sizeof get data getdata out address outaddress result obj iole command target objiolecommandtarget exec cmd id cmdid options in address inaddress out address outaddress in address inaddress variant clear variantclear in address inaddress global free globalfree in address inaddress out address outaddress set data setdata out address outaddress variant clear variantclear out address outaddress global free globalfree out address outaddress result idispatch get automation object getautomationobject ppv object ppvobject obj iunknown objiunknown query interface queryinterface iididispatch ppv object ppvobject idispatch ppv object ppvobject guid get class id getclassid string client name clientname create guid struct hold result guid guid guid create terminated array buffer client name clientname count client name clientname length buffer count client name clientname get chars getchars count buffer clsidfrom prog id clsidfromprogid buffer guid result clsidfrom string clsidfromstring buffer guid result ole error ole error invalid classid result guid get container getcontainer pp container ppcontainer simple containers support links embedded objects implement method nointerface pp container ppcontainer pp container ppcontainer move memory movememory pp container ppcontainer nointerface size get extent getextent size sizel size current size embedded olenatives object obj iole object objioleobject obj iview object objiviewobject ole is running oleisrunning obj iole object objioleobject get address getaddress obj iview object objiviewobject get extent getextent aspect sizel obj iole object objioleobject get extent getextent aspect sizel x form himetric to pixels xformhimetrictopixels sizel rectangle get indent getindent rectangle indent left indent indent top indent bottom returns program ole document active x activex control program ole document active x activex control string get program id getprogramid app clsid appclsid lplpsz prog id lplpszprogid prog idfrom clsid progidfromclsid app clsid appclsid lplpsz prog id lplpszprogid h mem hmem lplpsz prog id lplpszprogid length global size globalsize h mem hmem ptr global lock globallock h mem hmem buffer length move memory movememory buffer ptr length global unlock globalunlock h mem hmem global free globalfree h mem hmem string result string buffer remove terminator result index of indexof result substring activate me activateme p view to activate pviewtoactivate p view to activate pviewtoactivate ppv object ppvobject obj iunknown objiunknown query interface queryinterface iidiole document iidioledocument ppv object ppvobject fail iole document ioledocument obj ole document objoledocument iole document ioledocument ppv object ppvobject obj ole document objoledocument create view createview i ole in place site ioleinplacesite get address getaddress ppv object ppvobject fail obj ole document objoledocument release obj document view objdocumentview iole document view ioledocumentview ppv object ppvobject obj document view objdocumentview iole document view ioledocumentview p view to activate pviewtoactivate obj document view objdocumentview add ref addref obj document view objdocumentview set in place site setinplacesite i ole in place site ioleinplacesite get address getaddress obj document view objdocumentview uiactivate rect rect get rect getrect obj document view objdocumentview set rect setrect rect obj document view objdocumentview get window getwindow phwnd phwnd invalidarg frame move memory movememory phwnd notimpl copy window handle memory passed move memory movememory phwnd frame handle rect get rect getrect point location get location getlocation rectangle area frame get client area getclientarea rect rect rect rect left location rect top location rect location area width border widths borderwidths left border widths borderwidths rect bottom location area height border widths borderwidths top border widths borderwidths bottom rect get window context getwindowcontext pp frame ppframe pp doc ppdoc lprc pos rect lprcposrect lprc clip rect lprccliprect lp frame info lpframeinfo frame pp frame ppframe notimpl fill frame handle i ole in place frame ioleinplaceframe frame get iole in place frame getioleinplaceframe move memory movememory pp frame ppframe i ole in place frame ioleinplaceframe frame add ref addref document handle pp doc ppdoc move memory movememory pp doc ppdoc fill position clipping info rect rect get rect getrect lprc pos rect lprcposrect move memory movememory lprc pos rect lprcposrect rect rect sizeof lprc clip rect lprccliprect move memory movememory lprc clip rect lprccliprect rect rect sizeof frame info oleinplaceframeinfo frame info frameinfo oleinplaceframeinfo frame info frameinfo oleinplaceframeinfo sizeof frame info frameinfo f mdiapp fmdiapp frame info frameinfo hwnd frame hwndframe frame handle shell shell get shell getshell menu menubar shell get menu bar getmenubar menubar menubar is disposed isdisposed hwnd shell handle c accel caccel send message sendmessage hwnd app c accel caccel h accel haccel send message sendmessage hwnd app h accel haccel frame info frameinfo c accel entries caccelentries c accel caccel frame info frameinfo haccel h accel haccel move memory movememory lp frame info lpframeinfo frame info frameinfo oleinplaceframeinfo sizeof is dirty isdirty note method absolutely clear contents ole document differ contents file file system access persistant storage mechanism address obj iole object objioleobject query interface queryinterface iidipersist file iidipersistfile address ipersist storage ipersiststorage perm storage permstorage ipersist storage ipersiststorage address contents permanent storage file result perm storage permstorage is dirty isdirty perm storage permstorage release result is focus control isfocuscontrol check widget checkwidget focus hwnd focushwnd get focus getfocus obj iole in place object objioleinplaceobject handle focus hwnd focushwnd phwnd obj iole in place object objioleinplaceobject get window getwindow phwnd focus hwnd focushwnd phwnd focus hwnd focushwnd focus hwnd focushwnd get parent getparent focus hwnd focushwnd on close onclose on data change ondatachange p formatetc pformatetc p stgmed pstgmed on dispose ondispose event in dispose indispose do verb doverb ole oleiverb discardundostate deactivate in place client deactivateinplaceclient note release object interfaces releasing frame release object interfaces releaseobjectinterfaces delete temp storage deletetempstorage remove listeners remove listener removelistener swt dispose listener remove listener removelistener swt focus in focusin listener remove listener removelistener swt paint listener remove listener removelistener swt traverse listener remove listener removelistener swt key down keydown listener frame remove listener removelistener swt resize listener frame remove listener removelistener swt move listener frame release frame on focus in onfocusin event in dispose indispose uiactive do verb doverb ole oleiverb obj iole in place object objioleinplaceobject is focus control isfocuscontrol phwnd obj iole in place object objioleinplaceobject get window getwindow phwnd phwnd set focus setfocus phwnd on focus out onfocusout event on in place activate oninplaceactivate inplaceactive frame set current document setcurrentdocument obj iole object objioleobject ppv object ppvobject obj iole object objioleobject query interface queryinterface iidiole in place object iidioleinplaceobject ppv object ppvobject obj iole in place object objioleinplaceobject iole in place object ioleinplaceobject ppv object ppvobject on in place deactivate oninplacedeactivate obj iole in place object objioleinplaceobject obj iole in place object objioleinplaceobject release obj iole in place object objioleinplaceobject running redraw shell shell get shell getshell is focus control isfocuscontrol frame is focus control isfocuscontrol shell traverse swt traverse tab on pos rect change onposrectchange lprc pos rect lprcposrect point size get size getsize set extent setextent size size on paint onpaint event running inplaceactive size size get extent getextent rectangle area get client area getclientarea rect rect rect nls get program id getprogramid starts with startswith excel sheet rect left area rect area area height size size rect top area rect bottom area area height rect left area rect area size rect top area rect bottom area size p area parea global alloc globalalloc gmem fixed gmem zeroinit rect sizeof move memory movememory p area parea rect rect sizeof ole draw oledraw obj iunknown objiunknown get address getaddress aspect handle p area parea global free globalfree p area parea on resize onresize event rectangle area frame get client area getclientarea set bounds setbounds border widths borderwidths left border widths borderwidths top area width border widths borderwidths left border widths borderwidths area height border widths borderwidths top border widths borderwidths bottom set object rects setobjectrects on save onsave on show window onshowwindow f show fshow on uiactivate onuiactivate obj iole in place object objioleinplaceobject fail uiactive phwnd obj iole in place object objioleinplaceobject get window getwindow phwnd set window pos setwindowpos phwnd hwnd top swp nosize swp nomove on uideactivate onuideactivate f undoable fundoable ignoring f undoable fundoable flag frame frame is disposed isdisposed inplaceactive frame set active object setactiveobject redraw shell shell get shell getshell is focus control isfocuscontrol frame is focus control isfocuscontrol shell traverse swt traverse tab menu menubar shell get menu bar getmenubar menubar menubar is disposed isdisposed shell handle shellhandle shell handle set menu setmenu shell handle shellhandle menubar handle ole set menu descriptor olesetmenudescriptor shell handle shellhandle on traverse ontraverse event event event detail swt traverse escape swt traverse swt traverse tab swt traverse tab previous swt traverse swt traverse previous swt traverse mnemonic event doit on view change onviewchange dw aspect dwaspect lindex query interface queryinterface riid ppv object ppvobject riid ppv object ppvobject nointerface guid guid guid move memory movememory guid riid guid sizeof is equal guid isequalguid guid iidiunknown move memory movememory ppv object ppvobject i unknown iunknown get address getaddress add ref addref is equal guid isequalguid guid iidiadvise sink iidiadvisesink move memory movememory ppv object ppvobject i advise sink iadvisesink get address getaddress add ref addref is equal guid isequalguid guid iidiole client site iidioleclientsite move memory movememory ppv object ppvobject i ole client site ioleclientsite get address getaddress add ref addref is equal guid isequalguid guid iidiole in place site iidioleinplacesite move memory movememory ppv object ppvobject i ole in place site ioleinplacesite get address getaddress add ref addref intentionally commented bug is equal guid isequalguid guid iidiole document site iidioledocumentsite string prog id progid get program id getprogramid prog id progid starts with startswith power point powerpoint nls move memory movememory ppv object ppvobject i ole document site ioledocumentsite get address getaddress add ref addref move memory movememory ppv object ppvobject nointerface returns status command status bitwise combination swtole olecmdf supported swtole olecmdf enabled swtole olecmdf latched swtole olecmdf ninched query status command invoking ole client site oleclientsite exec ole document active x activex control support iole command target iolecommandtarget method param cmd command ole olecmdid values small common commands status command unable query ole object ole olecmdf values query status querystatus cmd obj iole command target objiolecommandtarget address obj iunknown objiunknown query interface queryinterface iidiole command target iidiolecommandtarget address obj iole command target objiolecommandtarget iole command target iolecommandtarget address olecmd olecmd olecmd olecmd cmd id cmdid cmd result obj iole command target objiolecommandtarget query status querystatus olecmd result olecmd cmdf release ref count refcount ref count refcount dispose cominterfaces disposecominterfaces ref count refcount release object interfaces releaseobjectinterfaces obj iole in place object objioleinplaceobject obj iole in place object objioleinplaceobject release obj iole in place object objioleinplaceobject obj iole object objioleobject obj iole object objioleobject close oleclose nosave obj iole object objioleobject release obj iole object objioleobject obj document view objdocumentview obj document view objdocumentview release obj document view objdocumentview obj iview object objiviewobject obj iview object objiviewobject set advise setadvise aspect obj iview object objiviewobject release obj iview object objiviewobject obj iole command target objiolecommandtarget obj iole command target objiolecommandtarget release obj iole command target objiolecommandtarget obj iunknown objiunknown obj iunknown objiunknown release obj iunknown objiunknown co free unused libraries cofreeunusedlibraries save file file include ole info includeoleinfo include ole info includeoleinfo save to storage file savetostoragefile file save to traditional file savetotraditionalfile file save from contents savefromcontents address file file success istream temp contents tempcontents istream address temp contents tempcontents add ref addref file output stream fileoutputstream writer file output stream fileoutputstream file increment co task mem alloc cotaskmemalloc increment pcb written pcbwritten temp contents tempcontents read increment pcb written pcbwritten pcb written pcbwritten buffer pcb written pcbwritten move memory movememory buffer pcb written pcbwritten note file exist create file writer write buffer time called success co task mem free cotaskmemfree writer close ioexception err temp contents tempcontents release success save from ole savefromole address file file success istream temp contents tempcontents istream address temp contents tempcontents add ref addref ole stream dword header length data co task mem alloc cotaskmemalloc size temp contents tempcontents read move memory movememory size co task mem free cotaskmemfree size read data buffer size co task mem alloc cotaskmemalloc size temp contents tempcontents read size move memory movememory buffer size co task mem free cotaskmemfree open file write data file output stream fileoutputstream writer file output stream fileoutputstream file note file exist create file writer write buffer writer close success ioexception err temp contents tempcontents release success save object saveobject update storage updatestorage saves document file includes ole spcific inforrmation method files ole storage format word file edited word document saved method formating stored ole specific storage format param file file saved save successful save to storage file savetostoragefile file file save fails file file is directory isdirectory update storage updatestorage access persistant storage mechanism address obj iole object objioleobject query interface queryinterface iidipersist storage iidipersiststorage address ipersist storage ipersiststorage perm storage permstorage ipersist storage ipersiststorage address address path file get absolute path getabsolutepath to char array tochararray mode stgm transacted stgm readwrite stgm share exclusive stgm create add ref addref successful result stg create docfile stgcreatedocfile path mode address result istorage storage istorage address ole save olesave perm storage permstorage get address getaddress storage get address getaddress storage commit stgc storage release perm storage permstorage release saves document file method files ole storage format bitmap file edited mspaint saved method bitmap standard format include ole specific data param file file saved save successful save to traditional file savetotraditionalfile file file save fails file file is directory isdirectory update storage updatestorage address contents stream nls temp storage tempstorage open stream openstream contents stgm direct stgm read stgm share exclusive address save from contents savefromcontents address file ole object stream nls temp storage tempstorage open stream openstream ole stgm direct stgm read stgm share exclusive address save from ole savefromole address file scroll scroll extant scrollextant set border space setborderspace rect new borderwidth newborderwidth border widths borderwidths new borderwidth newborderwidth readjust size location client site rectangle area frame get client area getclientarea set bounds setbounds border widths borderwidths left border widths borderwidths top area width border widths borderwidths left border widths borderwidths area height border widths borderwidths top border widths borderwidths bottom set object rects setobjectrects set extent setextent width height obj iole object objioleobject is static isstatic in update inupdate size current extent currentextent get extent getextent width current extent currentextent height current extent currentextent size new extent newextent size new extent newextent width new extent newextent height new extent newextent x form pixels to himetric xformpixelstohimetric new extent newextent server running set extent setextent already running alreadyrunning ole is running oleisrunning obj iole object objioleobject get address getaddress already running alreadyrunning ole run olerun obj iole object objioleobject get address getaddress obj iole object objioleobject set extent setextent aspect new extent newextent in update inupdate obj iole object objioleobject update in update inupdate already running alreadyrunning close server wasn running entering method obj iole object objioleobject close oleclose saveifdirty set indent setindent rectangle new indent newindent indent rect indent left new indent newindent indent new indent newindent width indent top new indent newindent indent bottom new indent newindent height set object rects setobjectrects obj iole in place object objioleinplaceobject size object fill space leave border rect rect get rect getrect obj iole in place object objioleinplaceobject set object rects setobjectrects rect rect show object showobject tells container position object visible user method ensures container visible minimized displays dialog property ole object ole document active x activex control support ispecify property pages ispecifypropertypages param title titlebar dialog show properties showproperties string title property ole object ppv object ppvobject obj iunknown objiunknown query interface queryinterface iidispecify property pages iidispecifypropertypages ppv object ppvobject ispecify property pages ispecifypropertypages obj ispp objispp ispecify property pages ispecifypropertypages ppv object ppvobject cauuid ca guid caguid cauuid result obj ispp objispp get pages getpages ca guid caguid obj ispp objispp release result create frame display ch title chtitle title ch title chtitle title length title get chars getchars title length ch title chtitle result ole create property frame olecreatepropertyframe frame handle ch title chtitle obj iunknown objiunknown get address getaddress ca guid caguid c elems celems ca guid caguid p elems pelems locale user free property co task mem free cotaskmemfree ca guid caguid p elems pelems update storage updatestorage temp storage tempstorage ppv obj iunknown objiunknown query interface queryinterface iidipersist storage iidipersiststorage ppv ipersist storage ipersiststorage i persist storage ipersiststorage ipersist storage ipersiststorage ppv result ole save olesave i persist storage ipersiststorage get address getaddress temp storage tempstorage get address getaddress result ole save olesave fail objects ole save olesave write class stg writeclassstg temp storage tempstorage get address getaddress obj clsid objclsid result i persist storage ipersiststorage save temp storage tempstorage get address getaddress temp storage tempstorage commit stgc result i persist storage ipersiststorage save completed savecompleted i persist storage ipersiststorage release size x form himetric to pixels xformhimetrictopixels size a size asize size pixel transformation size himetric units h dc hdc get dc getdc logical pixels inch xppi get device caps getdevicecaps h dc hdc logical pixels inch yppi get device caps getdevicecaps h dc hdc release dc releasedc h dc hdc himetric units inch compatibility a size asize xppi compatibility a size asize yppi size size size size size size size x form pixels to himetric xformpixelstohimetric size a size asize size himetric transformation size pixel units h dc hdc get dc getdc logical pixels inch xppi get device caps getdevicecaps h dc hdc logical pixels inch yppi get device caps getdevicecaps h dc hdc release dc releasedc h dc hdc himetric units inch compatibility a size asize xppi compatibility a size asize yppi size size size size size size