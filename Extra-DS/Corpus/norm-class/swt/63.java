copyright ibm corporation rights reserved program accompanying materials terms eclipse license accompanies distribution http eclipse org legal epl html contributors ibm corporation initial api implementation org eclipse swt ole win org eclipse swt org eclipse swt internal ole win org eclipse swt widgets org eclipse swt internal win org eclipse swt internal java util vector ole frame oleframe ole container top level frame object ole interfaces iunknown iole in place frame ioleinplaceframe ole frame oleframe container position size active x activex control ole document application insert menu items application ole document menu activate deactivate ole document menus position ole document menu application translate accelerator keystrokes intended container frame styles border events dispose move resize ole frame oleframe composite interfaces ole client container comobject i unknown iunknown comobject i ole in place frame ioleinplaceframe access embedded linked ole object iole in place active object ioleinplaceactiveobject obj iole in place active object objioleinplaceactiveobject ole client site oleclientsite currentdoc ref count refcount menu item menuitem file menu items filemenuitems menu item menuitem container menu items containermenuitems menu item menuitem window menu items windowmenuitems listener listener nls string check focus ole check focus nls string hhook ole hhook nls string hhookmsg ole hhook msg create ole frame oleframe child widget style bits select properties param parent composite widget param style bitwise ing widget styles exception illegal argument exception illegalargumentexception error argument parent exception swtexception error thread invalid access called wrong thread ole frame oleframe composite parent style widget attributes parent style swt clip children swt clip siblings create cominterfaces createcominterfaces setup cleanup proc listener listener handle event handleevent event type swt dispose on dispose ondispose swt resize swt move on resize onresize ole error swt error implemented add listener addlistener swt dispose listener inform inplaceactiveobject frame resizes add listener addlistener swt resize listener inform inplaceactiveobject frame moves add listener addlistener swt move listener maintain reference client sites clientsites close don frame add ref addref check focus change display display get display getdisplay init check focus initcheckfocus display init msg hook initmsghook display init check focus initcheckfocus display display display get data getdata check focus display set data setdata check focus check focus time runnable timer runnable control last focus lastfocus control timer runnable last focus lastfocus ole client site oleclientsite last focus lastfocus is disposed isdisposed ignore popup menus dialogs hwnd get focus getfocus hwnd owner hwnd ownerhwnd get window getwindow hwnd owner owner hwnd ownerhwnd display timer exec timerexec time timer hwnd get parent getparent hwnd last focus lastfocus last focus lastfocus is disposed isdisposed last focus lastfocus is focus control isfocuscontrol control current focus currentfocus display get focus control getfocuscontrol current focus currentfocus ole frame oleframe ole frame oleframe frame ole frame oleframe current focus currentfocus current focus currentfocus frame get current document getcurrentdocument last focus lastfocus current focus currentfocus event event event last focus lastfocus ole client site oleclientsite last focus lastfocus is disposed isdisposed last focus lastfocus notify listeners notifylisteners swt focus out focusout event current focus currentfocus ole client site oleclientsite current focus currentfocus is disposed isdisposed current focus currentfocus notify listeners notifylisteners swt focus in focusin event last focus lastfocus current focus currentfocus display timer exec timerexec time timer display timer exec timerexec time timer init msg hook initmsghook display display display get data getdata hhook nls callback callback callback ole frame oleframe get msg proc getmsgproc address callback get address getaddress address swt error swt error callbacks thread id threadid get current thread id getcurrentthreadid h hook hhook set windows hook ex setwindowshookex getmessage address thread id threadid h hook hhook callback dispose display set data setdata hhook integer h hook hhook display set data setdata hhookmsg msg display dispose exec disposeexec runnable h hook hhook unhook windows hook ex unhookwindowshookex h hook hhook callback callback dispose get msg proc getmsgproc code w param wparam l param lparam display display display get current getcurrent display integer h hook hhook integer display get data getdata hhook h hook hhook code call next hook ex callnexthookex h hook hhook int value intvalue code w param wparam l param lparam msg msg msg display get data getdata hhookmsg move memory movememory msg l param lparam msg sizeof message msg message keyfirst message message keylast display widget widget hwnd msg hwnd hwnd widget display find widget findwidget hwnd widget hwnd get parent getparent hwnd widget widget ole client site oleclientsite ole client site oleclientsite site ole client site oleclientsite widget site handle hwnd consumed active x activex control translate accelerators menu active thread get window thread process id getwindowthreadprocessid msg hwnd guithreadinfo lpgui guithreadinfo lpgui cb size cbsize guithreadinfo sizeof get guithread info getguithreadinfo thread lpgui mask gui inmenumode gui inmovesize gui popupmenumode gui systemmenumode lpgui flags mask ole frame oleframe frame site frame consumed frame translate ole accelerator translateoleaccelerator msg ole client site oleclientsite process key events active x activex control consumed hwnd old hwndold msg hwnd msg hwnd site handle consumed dispatch message dispatchmessage msg msg hwnd hwnd old hwndold consumed order prevent message processed application message w param wparam l param lparam msg message msg w param wparam msg l param lparam move memory movememory l param lparam msg msg sizeof call next hook ex callnexthookex h hook hhook int value intvalue code w param wparam l param lparam increment count references instance current reference count add ref addref ref count refcount ref count refcount context sensitive help contextsensitivehelp f enter mode fentermode create cominterfaces createcominterfaces create interfaces object i unknown iunknown comobject method args query interface queryinterface args args method args add ref addref method args release i ole in place frame ioleinplaceframe comobject method args query interface queryinterface args args method args add ref addref method args release method args get window getwindow args method args context sensitive help contextsensitivehelp args method args get border getborder args method args request border space requestborderspace args method args set border space setborderspace args method args set active object setactiveobject args args method args insert menus insertmenus args args method args set menu setmenu args args args method args remove menus removemenus args method set status text setstatustext implemented method enable modeless enablemodeless implemented method args translate accelerator translateaccelerator args args dispose cominterfaces disposecominterfaces i unknown iunknown i unknown iunknown dispose i unknown iunknown i ole in place frame ioleinplaceframe i ole in place frame ioleinplaceframe dispose i ole in place frame ioleinplaceframe get border getborder lprect border lprectborder iole in place uiwindow ioleinplaceuiwindow get border getborder function called document frame window object returns rectangle relative window object toolbars controls lprect border lprectborder invalidarg rect rect border rectborder rect coordinates relative window get client rect getclientrect handle rect border rectborder move memory movememory lprect border lprectborder rect border rectborder rect sizeof returns application menu items container location ole document place activated ole document place active document menus application opportunity merge menus menubar application allowed insert menus locations file left container middle window ole document retains control edit object menu locations note application insert menu single location application menu items container location ole document place activated menu item menuitem get container menus getcontainermenus container menu items containermenuitems returns application menu items file location ole document place activated ole document place active document menus application opportunity merge menus menubar application allowed insert menus locations file left container middle window ole document retains control edit object menu locations note application insert menu single location application menu items file location ole document place activated menu item menuitem get file menus getfilemenus file menu items filemenuitems get iole in place frame getioleinplaceframe i ole in place frame ioleinplaceframe get address getaddress get menu item id getmenuitemid h menu hmenu menuiteminfo lpmii menuiteminfo lpmii cb size cbsize menuiteminfo sizeof lpmii f mask fmask miim miim submenu miim get menu item info getmenuiteminfo h menu hmenu lpmii lpmii f state fstate popup popup lpmii h sub menu hsubmenu lpmii w id wid get window getwindow phwnd phwnd move memory movememory phwnd handle returns application menu items window location ole document place activated ole document place active document menus application opportunity merge menus menubar application allowed insert menus locations file left container middle window ole document retains control edit object menu locations note application insert menu single location application menu items window location ole document place activated menu item menuitem get window menus getwindowmenus window menu items windowmenuitems insert menus insertmenus hmenu shared hmenushared lp menu widths lpmenuwidths locate menu bar menu menubar get shell getshell get menu bar getmenubar menubar menubar is disposed isdisposed move memory movememory lp menu widths lpmenuwidths h menu hmenu menubar handle create holder menu passed fill requested menu menuiteminfo lpmii menuiteminfo h heap hheap get process heap getprocessheap cch byte count bytecount cch tchar sizeof psz text psztext heap alloc heapalloc h heap hheap heap memory byte count bytecount lpmii cb size cbsize menuiteminfo sizeof lpmii f mask fmask miim miim miim type miim submenu miim data lpmii dw type data dwtypedata psz text psztext lpmii cch cch loop file menus menubar item file menu count filemenucount newindex file menu items filemenuitems file menu items filemenuitems length menu item menuitem item file menu items filemenuitems item item get parent getparent index of indexof item lpmii cch updated get menu item info getmenuiteminfo lpmii cch cch call get menu item info getmenuiteminfo h menu hmenu lpmii insert menu item insertmenuitem hmenu shared hmenushared newindex lpmii track number items file menu count filemenucount newindex copy menu item count pointer move memory movememory lp menu widths lpmenuwidths file menu count filemenucount loop container menus menubar item container menu count containermenucount container menu items containermenuitems container menu items containermenuitems length menu item menuitem item container menu items containermenuitems item item get parent getparent index of indexof item lpmii cch updated get menu item info getmenuiteminfo lpmii cch cch call get menu item info getmenuiteminfo h menu hmenu lpmii insert menu item insertmenuitem hmenu shared hmenushared newindex lpmii track number items container menu count containermenucount newindex copy menu item count pointer move memory movememory lp menu widths lpmenuwidths container menu count containermenucount loop window menus menubar item window menu count windowmenucount window menu items windowmenuitems window menu items windowmenuitems length menu item menuitem item window menu items windowmenuitems item item get parent getparent index of indexof item lpmii cch updated get menu item info getmenuiteminfo lpmii cch cch call get menu item info getmenuiteminfo h menu hmenu lpmii insert menu item insertmenuitem hmenu shared hmenushared newindex lpmii track number items window menu count windowmenucount newindex copy menu item count pointer move memory movememory lp menu widths lpmenuwidths window menu count windowmenucount free resources querying psz text psztext heap free heapfree h heap hheap psz text psztext on dispose ondispose event release object interfaces releaseobjectinterfaces currentdoc release remove listener removelistener swt dispose listener remove listener removelistener swt resize listener remove listener removelistener swt move listener on resize onresize event obj iole in place active object objioleinplaceactiveobject rect lp rect lprect rect get client rect getclientrect handle lp rect lprect obj iole in place active object objioleinplaceactiveobject resize border resizeborder lp rect lprect i ole in place frame ioleinplaceframe get address getaddress query interface queryinterface riid ppv object ppvobject iunknown iole in place frame ioleinplaceframe iole container iolecontainer iole in place uiwindow ioleinplaceuiwindow riid ppv object ppvobject invalidarg guid guid guid move memory movememory guid riid guid sizeof is equal guid isequalguid guid iidiunknown is equal guid isequalguid guid iidiole in place frame iidioleinplaceframe move memory movememory ppv object ppvobject i ole in place frame ioleinplaceframe get address getaddress add ref addref move memory movememory ppv object ppvobject nointerface decrement count references instance current reference count release ref count refcount ref count refcount dispose cominterfaces disposecominterfaces co free unused libraries cofreeunusedlibraries ref count refcount release object interfaces releaseobjectinterfaces obj iole in place active object objioleinplaceactiveobject obj iole in place active object objioleinplaceactiveobject release obj iole in place active object objioleinplaceactiveobject remove menus removemenus hmenu shared hmenushared menu menubar get shell getshell get menu bar getmenubar menubar menubar is disposed isdisposed h menu hmenu menubar handle vector ids vector file menu items filemenuitems file menu items filemenuitems length menu item menuitem item file menu items filemenuitems item item is disposed isdisposed item get parent getparent index of indexof item original menubar get menu item id getmenuitemid h menu hmenu ids add element addelement integer container menu items containermenuitems container menu items containermenuitems length menu item menuitem item container menu items containermenuitems item item is disposed isdisposed item get parent getparent index of indexof item get menu item id getmenuitemid h menu hmenu ids add element addelement integer window menu items windowmenuitems window menu items windowmenuitems length menu item menuitem item window menu items windowmenuitems item item is disposed isdisposed item get parent getparent index of indexof item get menu item id getmenuitemid h menu hmenu ids add element addelement integer get menu item count getmenuitemcount hmenu shared hmenushared get menu item id getmenuitemid hmenu shared hmenushared ids integer remove menu removemenu hmenu shared hmenushared byposition request border space requestborderspace pborderwidths set active object setactiveobject p active object pactiveobject psz obj name pszobjname obj iole in place active object objioleinplaceactiveobject obj iole in place active object objioleinplaceactiveobject release obj iole in place active object objioleinplaceactiveobject p active object pactiveobject obj iole in place active object objioleinplaceactiveobject iole in place active object ioleinplaceactiveobject p active object pactiveobject obj iole in place active object objioleinplaceactiveobject add ref addref set border space setborderspace pborderwidths passing pborderwidths parameter obj iole in place active object objioleinplaceactiveobject rect borderwidth rect pborderwidths currentdoc move memory movememory borderwidth pborderwidths rect sizeof currentdoc set border space setborderspace borderwidth menu items container location ole document place activated ole document place active document menus application opportunity merge menus menubar application allowed insert menus locations file left container middle window ole document retains control edit object menu locations note application insert menu single location method called place activation ole document document activated menu bar modified subsequent activation param container menus containermenus array top level menu items menuitems inserted container location menubar set container menus setcontainermenus menu item menuitem container menus containermenus container menu items containermenuitems container menus containermenus ole client site oleclientsite get current document getcurrentdocument currentdoc set current document setcurrentdocument ole client site oleclientsite doc currentdoc doc currentdoc obj iole in place active object objioleinplaceactiveobject rect lp rect lprect rect get client rect getclientrect handle lp rect lprect obj iole in place active object objioleinplaceactiveobject resize border resizeborder lp rect lprect i ole in place frame ioleinplaceframe get address getaddress menu items file location ole document place activated ole document place active document menus application opportunity merge menus menubar application allowed insert menus locations file left container middle window ole document retains control edit object menu locations note application insert menu single location method called place activation ole document document activated menu bar modified subsequent activation param file menus filemenus array top level menu items menuitems inserted flie location menubar set file menus setfilemenus menu item menuitem file menus filemenus file menu items filemenuitems file menus filemenus set menu setmenu hmenu shared hmenushared holemenu hwnd active object hwndactiveobject in place active object inplaceactiveobject obj iole in place active object objioleinplaceactiveobject in place active object inplaceactiveobject obj iole in place active object objioleinplaceactiveobject get address getaddress menu menubar get shell getshell get menu bar getmenubar menubar menubar is disposed isdisposed ole set menu descriptor olesetmenudescriptor get shell getshell handle hwnd active object hwndactiveobject i ole in place frame ioleinplaceframe get address getaddress in place active object inplaceactiveobject handle menubar get shell getshell handle hmenu shared hmenushared holemenu instate original menu occurs deactivation hmenu shared hmenushared menubar handle hmenu shared hmenushared fail set menu setmenu handle hmenu shared hmenushared draw menu bar drawmenubar handle ole set menu descriptor olesetmenudescriptor holemenu handle hwnd active object hwndactiveobject i ole in place frame ioleinplaceframe get address getaddress in place active object inplaceactiveobject menu items window location ole document place activated ole document place active document menus application opportunity merge menus menubar application allowed insert menus locations file left container middle window ole document retains control edit object menu locations note application insert menu single location method called place activation ole document document activated menu bar modified subsequent activation param window menus windowmenus array top level menu items menuitems inserted window location menubar set window menus setwindowmenus menu item menuitem window menus windowmenus window menu items windowmenuitems window menus windowmenus translate ole accelerator translateoleaccelerator msg msg obj iole in place active object objioleinplaceactiveobject result obj iole in place active object objioleinplaceactiveobject translate accelerator translateaccelerator msg result result notimpl translate accelerator translateaccelerator lpmsg w id wid menu menubar get shell getshell get menu bar getmenubar menubar menubar is disposed isdisposed menubar is enabled isenabled w id wid shell shell menubar get shell getshell hwnd shell handle h accel haccel send message sendmessage hwnd app h accel haccel msg msg msg move memory movememory msg lpmsg msg sizeof result translate accelerator translateaccelerator hwnd h accel haccel msg result